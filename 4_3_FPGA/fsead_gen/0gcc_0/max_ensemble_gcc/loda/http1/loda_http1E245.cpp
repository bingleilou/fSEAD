
#include <iostream>
#include <cstring>
#include <string>
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "loda_http1E245.h"

#define SMAPLE_NUM 567498
using namespace std;

float bottom_loda = 0.8953576384868612;
float delta_loda = 0.07089864275670443;
float loda_min_X[245] = {-4.980293099142689,-12.967849603926615,-6.435339289007132,-8.364985138145116,-3.1038029153646853,-2.9496618180973484,-9.709886108128357,-5.744683435161983,-13.613223138471273,-4.904031265437211,-8.29914600810951,-17.29941171374788,-16.50561602112477,-3.8500511683036893,-8.955042702853593,-2.841844290600848,-3.6930489514765883,-5.766356262135202,-9.170748085275376,-9.549956121060408,-3.1281757197461286,-3.6885973845599187,-5.610185815758991,-11.101438743498084,-11.799680075348958,-3.844604261591659,-3.389570907423897,-6.264090515383587,-3.578235307268851,-2.6688324794378624,-3.3929669956790947,-17.03079393695422,-10.617714862126538,-14.089423830986746,-3.7830500776335407,-8.428723139808813,-4.742585964165546,-2.7263214861443554,-2.5453951056744906,-8.774925122627703,-13.48753393599033,-17.36072280361097,-13.639364425329028,-3.5645492220120154,-10.038687661452867,-13.806726855778413,-13.836781741028918,-3.4971402362065387,-8.541744669556511,-12.151801691391693,-5.52274249442532,-13.331713444757675,-8.553329984174026,-8.448887221388443,-3.640470057010767,-16.462189257513376,-3.6173395422292476,-15.375261891080783,-8.239708123187,-7.909553255083688,-4.018203229611776,-6.163590759307581,-3.8990813515997917,-4.2861877552826115,-3.7203500140470087,-12.92324619491848,-3.3331899470103905,-11.429993417553765,-16.721761756181362,-7.543568454722647,-9.285591187615026,-3.4259814173538943,-10.526887611000781,-8.683985396203614,-6.506869393718354,-10.134511071332575,-10.792403123919035,-9.934246285263333,-3.318805499853226,-11.218404436193477,-6.380991994952639,-2.810182937470143,-3.473517529284982,-3.941608005555731,-9.342499014173367,-10.948171865282061,-7.346023685583185,-10.716938614594035,-16.141936224011577,-3.9279592854981025,-12.830368211356904,-7.462147688525101,-12.581044472582862,-3.619056597636824,-6.8151834865317875,-3.4535587123133284,-12.545232524289364,-2.85427594038475,-10.30516372880559,-5.742012159299984,-8.341105340677684,-10.70341408817179,-4.903041597026094,-8.18889859269645,-4.762316373197815,-4.697047285394148,-11.133985068883577,-16.36871011137799,-9.972363556205224,-6.320224770013352,-13.090660248105268,-4.823727681533513,-9.025218350646602,-11.753945797063874,-4.386657624981923,-7.220793955614074,-3.5877924240692596,-4.398899050276963,-6.496455764573982,-5.990424943575859,-17.070455166303788,-11.939994185788896,-7.296870492459566,-6.873479056268813,-3.554848121252887,-10.608847692853065,-15.900354141184492,-12.809663271484231,-11.351241788972374,-2.873153049927673,-3.516237417638295,-5.868117848255879,-2.799991486184363,-3.8295484961864545,-8.925557383677527,-6.0178416196496665,-3.1152794305593368,-5.104256062176856,-3.693409048404393,-12.172448477745064,-8.543305279760313,-8.144892020024148,-13.539208064833337,-5.833433289867268,-3.659049649056357,-11.409881259806065,-7.017922429023402,-9.9298026885532,-3.883691084931866,-3.065893312049454,-9.845451779583778,-7.2395486655919425,-3.562697608347297,-11.266785706604814,-9.167789300370949,-9.919917015793441,-12.992386502292687,-3.8743479224370714,-3.529089813660876,-4.219916776472829,-6.625723740267586,-9.519630081108692,-8.419909165714543,-4.320552136136149,-3.6155048711509132,-13.426425293267284,-8.723853824923582,-3.5529720306130783,-16.645890432576778,-15.989163026366144,-2.7735461846535685,-5.133538705484939,-4.398926316359679,-9.538641437620818,-5.808495774854402,-13.918630105157606,-12.056039735507143,-5.380588482479905,-6.243267550631,-8.44864493079339,-4.749666873953545,-6.220639015270455,-3.646464904966262,-8.895865665817725,-12.276504247462379,-3.839029906582461,-4.237586345453126,-11.452137874924652,-5.197094030770127,-7.1449512141063085,-3.9728470105577394,-12.032467804510778,-5.890100619178142,-9.814982173931543,-3.397422343999523,-6.902321028687611,-12.006948010185415,-5.5125696525903605,-8.982002351247358,-17.197943464463297,-8.469827026534915,-12.621000723633063,-3.0164993493386985,-17.14458606531203,-8.09575365031284,-3.7635063869849583,-3.987902633517774,-4.991310758075575,-12.277667046562284,-3.4585456270226644,-3.0076927824027826,-3.0045391262750125,-14.218686436553684,-4.623994871047236,-3.0184939171330134,-3.9185011685740214,-8.163719135050968,-4.353076537072954,-9.714709787047271,-9.59576751823428,-10.881874141619873,-5.950818021443656,-3.1774339088750505,-14.294732634206376,-7.061213662254158,-3.2950535010886566,-17.12500849695201,-12.928944246570273,-11.5986324276622,-6.0742089820339675,-3.569059441812953,-8.926664072824682,-3.737962321991335,-3.6003089650330153,-3.206984257553398,-3.0442343944601435,-11.422080189400988,-10.59653160528384,-3.603666354150414,-3.498794657119802,-3.2681589177327726,-2.9307175458378922,-3.1411036171931803,-9.977617192202052,-7.396286275920272};

float loda_projections[245][3] = {{0.9620878509661543,0.10736122520546743,-0.2507200317998299},
{-0.8222576334475065,-0.1392418902327797,-0.5518188835494021},
{0.9194542698020428,-0.372669442677178,0.12538473686008858},
{-0.17645446821642002,-0.6546882110459308,0.7350150794126193},
{0.9161760296486187,0.39947098000830694,0.03231746940118313},
{0.09506041647596482,-0.040743374077033746,0.994637368435469},
{-0.9619099692439109,0.02255786621291024,-0.27243412734292055},
{0.9442322214947269,-0.3292700368121431,0.0025989899697858128},
{-0.012378002786039845,-0.9189487004467691,-0.39418278881024604},
{0.40887772540722517,-0.17577609898383673,0.895500847957074},
{0.8951488234337195,-0.38249338715705017,-0.22892660982584473},
{-0.10749671559227246,-0.24651971164217606,-0.963157561310055},
{0.13997798030707057,-0.31759422761838707,-0.9378379772714653},
{0.38933093531948315,0.7547857461120204,0.5279392960079567},
{-0.6322042015621706,-0.6774541736848064,0.37599692829087616},
{-0.5650157275415988,0.8243830282926229,-0.03390944254514575},
{-0.43161622467617183,0.7152472990647375,0.5496623834472267},
{-0.32315801069164174,-0.2616871932271848,0.9094441780707042},
{-0.5645447292291208,-0.8140208032219072,0.13659934341562469},
{-0.24592462356249795,-0.8284413943641902,0.5031957229841683},
{0.12198077564253829,0.9503759248196902,0.2861927530472484},
{-0.4788618570747593,0.7111938897787977,0.5146790970888717},
{-0.9202516133211326,0.26315928129138455,0.2896276244595027},
{0.288802936318219,-0.9565167540856262,0.04084804924929001},
{-0.07019665754542721,-0.9938358156003869,-0.08580676488112016},
{0.6805452788135697,0.6489326546507003,0.34021248244671376},
{0.22505473018633954,0.330400770149027,0.91661644077863},
{-0.7908218624446897,0.11092298035073109,0.6019110185979517},
{0.3902875859134044,0.2898385783142972,0.8738816846705474},
{0.03642976078457454,0.99891084779621,-0.029154599709749717},
{0.8960624486402241,0.41188434087094716,0.16560005399211428},
{0.011010040568642613,-0.24336139053901124,-0.9698731940834305},
{-0.07395793815627562,-0.9116332502780098,0.4042957338028984},
{0.4377010191329793,-0.3171950873510098,-0.8413115323174506},
{0.292219713292541,0.7097273299923273,0.641010730195047},
{-0.6118544639902339,0.5405434855915797,-0.5774485735368383},
{-0.9149151523497117,0.39876297620901124,0.06259674756595403},
{0.9925556831673886,0.1206425806878561,-0.016690821941791577},
{0.029771291328505044,0.07927134504711003,0.9964084122823609},
{0.7269964070428696,-0.5776970276385182,0.37113658995628446},
{0.33243962991168147,-0.8748093898885825,-0.35240945479222047},
{-0.21142591103784833,-0.299570585469079,-0.9303529160826708},
{-0.01573900486896766,-0.9171171220419515,-0.3983070024280554},
{0.8822109287834111,0.3363676807048553,0.3294854481040814},
{0.6865925227671578,0.17756191170586008,-0.7050265776490913},
{-0.37834239383961243,-0.8222256298504882,-0.42520823914957234},
{0.08426022387570982,-0.904003817860637,-0.4191387741140251},
{0.2776722676369853,0.34423132657342415,0.8968851128159252},
{-0.011803889529935664,0.7027206784386115,-0.7113679190733458},
{0.22203294230615314,-0.967564340073084,-0.12050153671140326},
{0.8081204651110339,0.5338057258995583,-0.24898345500368432},
{0.27241949993545234,-0.9126467228588533,-0.3047352544585436},
{-0.3808688398325158,-0.7600216009839387,0.5265986069887045},
{-0.3349985688753039,-0.7244373812256522,0.6024669613633741},
{-0.63914151961953,0.7260061259798152,-0.2537976023098299},
{-0.15648457664162913,-0.5906538382982394,-0.7916063545581525},
{-0.28064121539336345,0.7430745846377832,0.607520098340723},
{-0.3862966775838257,0.12798013970495856,-0.9134527687454875},
{0.3981915032662699,0.7086664779429992,-0.5824391382508672},
{-0.8879558971985098,-0.13511386845775766,0.4396345836951064},
{-0.4586539111681522,0.8273008641309016,-0.3243607096712245},
{0.7799401255047007,0.5376835208673655,-0.32029647518414095},
{0.23280758659110265,0.9655007033697595,-0.11665770192372968},
{0.9828835032042573,-0.17455013410832587,0.058925968907538324},
{0.8235227240365983,0.33279308320343326,0.4594116746092698},
{-0.7780074971983446,-0.0112582537758197,-0.6281541100916932},
{-0.1298419669213643,0.870037160296718,0.47558007036545863},
{-0.26033855933877237,0.5121152641448993,-0.8185119368410044},
{-0.02732002085947684,-0.5171986665594243,-0.8554292231209963},
{0.27393121454081626,-0.4593998797070609,0.8449339857203824},
{0.577363607141585,0.3728253132640904,-0.7263969651216821},
{-0.0023010446115965576,0.9931131674047556,-0.11713642439902776},
{-0.5976294099620055,-0.8014530280969299,-0.022630335895141095},
{-0.5324711202685518,-0.8118814837913879,0.2394221425780158},
{0.3290746375322806,-0.3444738500403361,0.8792312833216219},
{-0.23060652877242427,-0.9172233398299028,0.32484145942107145},
{0.787327721742508,-0.2420875904458547,-0.5670173340629652},
{0.6400347349295388,-0.7343138269820447,0.22613876621813153},
{-0.1335638631347885,0.8793102045207293,0.45713702397664624},
{0.17137265142671923,-0.9804503583452332,0.0966876887906618},
{0.07790768822282973,-0.377014495076358,0.9229249496129645},
{-0.7058700571769531,0.7071511630644436,-0.041045035724306754},
{-0.3228656112781881,0.9218558565352837,-0.21433519735582485},
{0.5503456240108303,0.6870613459929921,0.4744116366347138},
{-0.9538170157241196,-0.29890653026380004,0.02979910536896514},
{0.11959160380255664,0.5017101674211578,-0.8567291031628177},
{-0.9639099215929606,-0.008810364916718619,0.26608277006354},
{0.4950391070325676,-0.8611935294931056,0.11524750438775397},
{-0.5239168720236923,-0.21525121430519367,-0.824122579443768},
{0.7654221039923049,-0.06391241326915524,0.6403469420166742},
{0.30563565613077354,-0.9249858068993766,-0.22580545329159038},
{0.8069149074089786,0.3158833737738543,-0.4991052257534547},
{-0.4320705062950274,-0.8779110976855236,-0.2063666207276698},
{0.21179917832543407,0.5566263449071527,0.8033107868166433},
{0.8349404152274812,0.36058655400860296,-0.4157545430755536},
{0.11825722767375904,0.8165002961412019,0.5651039678716177},
{0.5072165168707558,0.02682271619178984,-0.8614011533017547},
{-0.09693525459230803,0.18564659078107745,0.9778235524615305},
{0.4342219220934539,0.3537135446879777,-0.8284552194764255},
{-0.6748336180999045,0.11292031702140397,0.7292795005249891},
{-0.8709837731029385,0.3456046705195334,-0.3492057827505918},
{0.7589278041277377,-0.5857878726686798,-0.284396125775568},
{0.6045764896559831,0.7767997558390881,-0.17626516242179552},
{-0.11098897718800432,0.7080647384154033,-0.6973706139173683},
{0.8418120948827723,0.5129134771654563,-0.16814327774585408},
{-0.8026149831831644,0.35943855803654456,0.4760389813518411},
{0.3611619784050826,-0.9183512712752513,0.16184241688029885},
{-0.3462767367866042,-0.008145764776356272,-0.9380970461933185},
{0.6206951247699659,-0.728253885587943,0.29048896745463443},
{0.598940376677508,0.7277247826577928,-0.3341961488274108},
{0.5401467223844552,-0.5877814595902342,-0.6022910210681413},
{-0.8037182420247921,0.5640572050725414,-0.18941081500888687},
{-0.3481405971101024,-0.8073947010848163,0.47635272782254734},
{0.19625873501249194,-0.978024753653231,-0.07035687722485472},
{-0.26787287821312705,-0.05748408396918186,0.9617378547234373},
{-0.04353986091645552,-0.49191172047220927,0.8695557140134534},
{-0.49544162632749805,0.7731783155433538,0.3958950457829773},
{-0.04758581592649849,0.9714346084063131,-0.23248740119215608},
{-0.744379427070977,0.5619446570032501,-0.36071799375548697},
{0.5184990330872693,0.7998163550249463,-0.3024112281681618},
{-0.3285613527210965,-0.1964080088897373,-0.9238351214053577},
{0.16773674589808513,-0.9813140752951658,-0.09427125597505837},
{0.9213522580413473,0.004556111289833592,-0.3887020175558974},
{0.715479278051994,-0.35521830646001984,0.6015890270224955},
{0.2916773671211582,0.9539312437352454,-0.07028154619099415},
{0.427714255105735,-0.8007877473984676,0.41928450912934345},
{-0.5523446903825612,-0.1949604348024898,-0.8104972374214588},
{0.5204713454606515,-0.7833105940126309,-0.33990306244863183},
{0.466913925240996,-0.8812296835191595,-0.07365888473746847},
{-0.07701876509969294,0.9739284909711389,0.2133808901874729},
{-0.3803458539371335,0.38961374268276316,0.8387718181398099},
{-0.4785379932263993,0.7197874166023266,-0.5028990593944269},
{0.9739164519335817,0.2263600211882016,0.015744378704170853},
{-0.5610843770972092,0.7599483238384341,-0.32812020186601015},
{-0.01939113358618518,0.6546013218161306,-0.755725541062903},
{0.23632700561513315,0.9078903009027894,-0.34624376953762953},
{0.256609167200549,0.14002052028014428,0.9563189787979315},
{0.980602235600774,-0.06340386356230909,-0.18547022839295868},
{0.6662171525084928,0.7101630569475145,0.2276469596775611},
{0.21810195294807794,-0.9681301054225097,-0.12310823325364764},
{-0.43969073213507026,-0.7946087364923856,0.4186514253702001},
{-0.47256910476063935,-0.6310498693120261,0.6151865600506912},
{0.261165169226594,-0.9022293533775687,-0.34318354897450853},
{0.3717444052247876,-0.2712764125568911,0.8878148484759265},
{-0.7353333906466651,0.46933276336239665,0.48888808722927113},
{0.7208503819191745,-0.429474139338757,-0.5439914434310655},
{-0.9679979422415325,0.04804952931382738,0.24631529905565833},
{-0.9667900900316924,-0.10333870286666594,-0.23374780064494177},
{0.6005691996962301,0.3857047377042787,0.7003916702022541},
{-0.008828696705378303,0.9099557585558102,0.4146113500443573},
{0.27862279943382323,0.5018813680547438,-0.818831135238004},
{-0.9933807774183966,0.11078505489928385,0.030352968002893808},
{0.23578904437303733,0.45027788558890897,0.8611929820331976},
{-0.37164745806018834,0.49843558671376825,-0.7832241906470344},
{0.5625933722236528,0.43465790874744853,-0.7032504531767564},
{0.6444702144787475,-0.7564544334413118,0.11151158135683045},
{0.5884911832301769,-0.42921141269897417,-0.6851683665124195},
{0.9812171762891683,0.14051047639172737,-0.1321728375245127},
{-0.24772424389917286,0.07552727181827558,0.9658821512981133},
{-0.8565179137334448,0.43292352067960893,0.2809880579243176},
{-0.813467108517762,0.49582849966509857,-0.30401539809622946},
{0.7710607840920286,-0.6292292098353257,-0.09765177277140209},
{-0.34405328758098147,-0.7248952568455521,0.5967865631090731},
{0.2710544639698623,-0.13903117163795345,0.9524703727019483},
{0.3048546169564038,0.40188612934490997,0.8634530685338554},
{-0.46048779180076366,-0.7986043426379473,-0.38753335020649343},
{-0.5355003932733515,-0.7851161588066328,0.3111783186290524},
{-0.3752326183523283,0.8241844602538568,0.42417031673670247},
{-0.18965633919605912,-0.5598193505588421,-0.8066181052658224},
{0.20940638875135187,-0.3977592473083266,-0.8932729401089182},
{-0.7767177253815657,0.6289112087292794,-0.03435500855426024},
{-0.1835321387711677,-0.31371485140738475,0.9316109413507997},
{0.05252195341493063,0.976795062541335,-0.20763634124196348},
{-0.136614217035191,0.6308584652001705,-0.7637762451066065},
{-0.06947635046771661,0.9160698224348922,-0.39495457605880724},
{0.4129294369551306,-0.527936029389493,-0.7421407069878159},
{0.3138411253115303,-0.9422285418851474,-0.11708596380515207},
{-0.2875519520262243,-0.22749662839484228,0.9303543190391964},
{0.8957868522181406,0.24673289779956897,-0.3697144743400544},
{-0.8199592345342515,-0.29969506893304876,0.4876983897443375},
{0.9572817174341068,-0.1887705660738224,0.21903740970568344},
{-0.6920988562611213,0.04358962001815321,0.7204853351656234},
{0.6131319373806764,0.7888194208610348,-0.04281528507764422},
{0.6256564462020513,0.40278363860684524,-0.668071367292784},
{0.674948972704067,-0.24541303557546415,-0.6958565414044482},
{0.5853913516181513,0.35108808629915755,0.7307900663730106},
{0.6235408988155539,-0.09384527680872715,0.7761377529311304},
{0.2626522996364271,-0.9641925125517752,-0.03669561601596666},
{-0.269247698544047,0.8816427518811242,-0.3875715867865091},
{0.04341404065460787,-0.46303208933281864,0.8852776430714404},
{-0.3794670480607667,0.1398591283903567,0.914573224866078},
{0.31141091631760787,0.31122311847923195,-0.897866032168658},
{-0.7177359899974557,0.12184749115441024,0.6855714678731518},
{0.795216589924558,-0.576443860290773,-0.1879974761581362},
{0.6933131274318637,-0.013129044590011756,0.7205168530428709},
{0.31083887480398387,0.8456570556698481,-0.43387018577726316},
{-0.3963605846363111,0.4406480185190415,-0.8054362859481836},
{0.3252543571034309,0.9049804280197492,-0.27426269904313516},
{-0.23470068502705246,-0.7486409325008745,0.6200422103631763},
{-0.30782698302899064,-0.25565846937585196,-0.916450378119659},
{-0.14394161929753838,0.6849887391302274,-0.7141927173381032},
{0.31613599461544073,-0.9282496612436579,-0.1959862222441676},
{0.17996794170738786,0.15941145108852106,0.9706696292866375},
{-0.3263832022409124,-0.24882697536471154,-0.9118986465752742},
{0.7699743710725505,-0.5004783751462643,0.39580407261975636},
{0.8131555899180274,0.43803660596140154,0.38327786059578295},
{-0.5065090347134149,0.7920014529518534,-0.3408552424062709},
{0.9645031213606777,-0.2277716230042035,0.13361817480994437},
{0.4253247663229898,-0.886964400112616,-0.1799805436294748},
{0.7858304374098096,0.6180090185792178,-0.023138206392443784},
{-0.4873643029768817,0.8716595690765367,0.0518230819342579},
{-0.27851707064703146,0.9487151940426403,-0.14955842320254709},
{0.33806910458254186,0.013012617160704993,-0.9410313237726932},
{0.9396351369642918,0.28863116420433355,-0.18378754155858212},
{0.9672104529081991,0.11971102737247068,0.22399377158872963},
{0.04875643834169813,-0.14146262168689874,0.9887421991528942},
{-0.8463495775325673,-0.21412485779353174,0.48769143716631386},
{0.9707656415352492,0.15982883872343379,-0.17907766897906202},
{-0.8161654001171688,-0.5748320476739663,0.0586698953342912},
{0.6817521768957995,-0.7315646412886898,-0.005210078117389851},
{0.02097496907369506,-0.9997257176533805,0.010418259681478163},
{-0.9658736334887404,0.24422286653092373,0.0862746520982675},
{0.9526787083098041,0.18990073523897533,0.23736256968793504},
{0.37784032777230653,-0.4709924605144928,-0.7971215646608866},
{0.32181949530276505,0.8327033638436425,-0.45059662702527625},
{-0.16812192163513812,0.39647010839905245,0.9025222837203256},
{-0.08597135324808694,-0.4386434171599921,-0.8945394787279641},
{0.5991167436574623,-0.41501544479905617,-0.6847052709359847},
{-0.402230274363506,0.4667054950395771,-0.7876527072798786},
{-0.4435215748741094,0.726842262892123,-0.5243938762943822},
{-0.2152463529200158,0.6830291769847366,0.6979542613539839},
{-0.7004949431384085,-0.5551353482875656,0.4484769556166304},
{0.9572486865476132,0.2741191218190785,-0.09237780662045753},
{-0.13665178983676937,0.9757979538846164,-0.17071801758749158},
{-0.06994507891232092,0.44510116948995165,0.8927444398340582},
{-0.3272274440775774,0.9296002550962498,-0.16960414372132301},
{0.5099088922697771,-0.8539838863493647,-0.10346228027568481},
{0.2300532035035236,0.47746070490509845,-0.848001650251515},
{0.18916146687218313,0.5939242179138797,0.7819667274418717},
{-0.15621157233985522,0.7023817009034518,0.6944479036638272},
{0.810478482483972,-0.004922913731895088,0.5857477224461622},
{0.9632116465403984,0.04455854923760305,0.2650242623964357},
{-0.2089976831496526,0.9437321938189727,0.25629965818882083},
{0.4245185465122651,-0.7137408844770555,0.5570977952685006},
{-0.1223611476183611,0.7910615987334532,-0.5993740873301002}};

float loda_delta[245] = {1.5603996209825808,1.2156285576806014,1.6178573043534517,1.1454313711061086,1.5332766935937339,1.0407915571110984,1.5629912949521572,1.7453711728704528,1.2000968572631796,1.009839825601443,1.5452503492880245,0.98365572865068,1.0178388414348993,1.1187227667897646,1.2784006555889083,1.5226950063821132,1.1461960429078983,1.0982124872830539,1.4620162052273102,1.1805989987382672,1.2195488226019229,1.1632373859532423,1.5136069710129896,1.4564432838020083,1.384343362448878,1.2545761152195585,0.9647836471562077,1.192151900619537,0.9749408696057004,1.486672883887574,1.4383177330411454,1.0078471412527343,1.1878221058196492,1.1397002551045803,1.0619868487108852,1.1756510661107604,1.7001846426254281,1.75525474868399,1.0378070886427389,1.3160456793451722,1.1824204861485874,0.9671389177467724,1.1972835453863988,1.3087041843049407,1.1497619070555376,1.1395871760455394,1.1739984950528228,0.9638811316615653,1.123272737827466,1.3281389256929028,1.3680032335540204,1.2028301032746405,1.2250565396411928,1.1922435477114592,1.4763940469899384,0.9997360683941788,1.120360481217138,1.0125640058297762,1.2250061443924087,1.3250062911870575,1.3544265859930542,1.3114184072249602,1.421346410456671,1.738054530638534,1.2057755660628338,1.2355612285851763,1.1485082542904674,1.0282029612375103,1.0027444641706933,1.0141099871273773,1.1763835924636656,1.3851291908077894,1.4492226178798675,1.4165419184053787,0.9992736983032466,1.2537969105591378,1.2319334531434012,1.5146667732828356,1.1532194371879587,1.4259110683115843,1.017125505766861,1.6425581815154713,1.362575607861113,1.1645927129317437,1.597677394174189,1.1067908092810381,1.529399448851585,1.5004070074505969,1.0130918821084962,1.210461179084816,1.2474395883563651,1.2550897991012502,1.2443564321195737,0.9870754530719897,1.2874107836087179,1.1253487530563633,1.099315136133204,1.0282981077783175,1.1655989345169027,1.1297663196853347,1.343403046142189,1.4205102946833903,1.4545620274275497,1.1295476036464203,1.4500424873106506,1.3348512077823709,1.4287408438374627,1.0338670896398439,1.4369799728836874,1.3137823808985412,1.1899347238169413,1.5140743457942074,1.223958089938925,1.3771424207438878,1.0569103866784129,1.0717496720861952,1.195122439786049,1.286382029613047,1.3230056247703241,1.3645760134439078,0.9800822408507078,1.3587014294299482,1.369223997010805,1.1661871618129687,1.4187848057281773,1.2849544777731932,1.0263080395961963,1.224205921341804,1.389441850095703,1.2821521942422685,1.1077716785468452,1.2570156661621414,1.6525252198585327,1.4190435459169568,1.1243382137028597,1.2431975758741105,0.9901382529072049,1.6686789115685603,1.3109131806317302,1.326303137837789,1.292317628601177,1.1978113217692332,1.1848945408165796,1.000248047341007,1.3437514382533886,1.3060515871038252,1.5602068531251732,1.5465404880057243,1.0449447100082678,1.1938131988686904,1.2109508492772914,1.8166704256797666,0.967923547077017,1.0354465573132978,1.1719310492875967,1.5910467262997932,1.2031882490046175,1.667396569159919,1.0586270575698542,1.4869849301651235,1.3736268590281706,1.5888606942073404,1.1967077779436233,1.0039386781902688,0.9657614908605316,1.1615804532163274,1.3508729280523983,1.1604568838304015,0.9886830978317452,1.034097198132601,1.7480612437474812,1.10545131094556,1.3056756412692092,1.0850071368805476,1.1916861663037628,1.1370235280318228,1.3277817091192412,1.083775717300849,1.364580238329895,1.2664563367009096,1.5477482919696908,1.1296607671206504,1.4830314160314653,1.1781343914162625,1.1615870239325272,1.0329516880751037,1.0940786809594265,1.4053115979864166,1.2313537325501227,1.038537971872239,1.084785494747021,1.113487843370002,1.1483513430823593,1.5369063512094678,1.1647549987627612,1.2247904530398206,1.0236086021387059,1.3174964118522587,1.1557535650071429,0.970608911645134,1.120308077186274,1.2673215385770868,0.9899975638103093,0.9723473800171585,1.2896413484713374,1.235515528842458,1.3790640472703293,1.6446575885123933,1.2900305703144685,1.4971113649860437,1.4179812547057387,1.4036807711799215,1.063755224869165,1.5217961373962543,1.5481678977933917,1.029903225427823,1.293505567506357,1.6165335164687924,1.4824841428363171,1.5967988895706204,1.5108788271286726,1.7215870261033803,1.4810514520020244,1.117448440155117,1.2223904576835578,1.0228139960885003,0.9807415741404413,1.2088594270809216,1.0317405844810157,1.2374753516614054,1.1199436002095113,1.2345698314689644,1.5808792832279,1.345992625596425,1.0069870178352582,1.404535354720638,1.374689115546749,1.1640101835777927,0.9987143155927674,1.1103543195767003,1.264459412782368,1.5493887219778781,1.232388308980142,1.2051840390518864,1.1356190623427738};

float log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};

int    windows_value[ENSEMBLE][BATCH_SIZE] = {0};
int    windows_num[ENSEMBLE][BATCH_SIZE] = {0};
int    V_c[ENSEMBLE][BATCH_SIZE] = {0};
int    N_c[ENSEMBLE] = {0};
int    win_idx = 0;


float loda_ensemble(float X[DIM_MAX]) {

    win_idx += 1;
    if (win_idx >= BATCH_SIZE){
        win_idx = 0;
    }
    float score = 0;

    for(int r = 0; r < ENSEMBLE; r++) {
        // ****************************************
        // Random Projection
        // ****************************************
        float projected_X_temp = 0;
        for(int dim = 0; dim < DIM_MAX; dim++) {
            projected_X_temp += X[dim] * loda_projections[r][dim];
        }

        int idx_temp = 0;
        int VC_table = 0;
        int value = 0;

        idx_temp = (int)((projected_X_temp - loda_min_X[r])*(loda_delta[r]));
        if (idx_temp >= N_BINS){
            idx_temp = N_BINS - 1;
        }
        if (idx_temp <= 0){
            idx_temp = 0;
        }
        value = idx_temp;

        int VC_value = 0;
        // ****************************************
        // Slide Windows
        // ****************************************
        int valueFromWin;
        int nFromWin;

        VC_value = V_c[r][value];

        V_c[r][value] += 1;
        N_c[r] += 1;

        valueFromWin = windows_value[r][win_idx];
        nFromWin = windows_num[r][win_idx];

        V_c[r][valueFromWin] -= nFromWin;
        N_c[r] -= nFromWin;

        windows_value[r][win_idx] = value;
        windows_num[r][win_idx] = 1;

        VC_table = VC_value;
        if(VC_table > BATCH_SIZE-1){
            VC_table = BATCH_SIZE - 1;
        }
        float c;
        if(VC_table > 0){
            c= (float)log_LUT_loda[VC_table];
        }
        else{
            c = 15.0;
        }
        score += c;

    }
    return score;
}

float data_window [DIM_MAX] = {0};
int count = 0;

void loda_cardio(float data){
    float anomalyscore;
    bool flag;

    flag = 0;
    count += 1;
    if (count == DIM_MAX){
        count = 0;
        flag = 1;
    }

    for (int i = 0; i < DIM_MAX-1; i++) {
        data_window[i] = data_window[i+1];
    }
    data_window[DIM_MAX-1] = (float)data;


    float score_out_fixed;
    if(flag == 1){
        score_out_fixed = loda_ensemble(data_window);
        anomalyscore = (float)(((double)score_out_fixed/(double)ENSEMBLE - (double)bottom_loda)*(double)delta_loda);
        cout << setprecision(26) << anomalyscore << endl;;
    }
}


int main(int argc, char **argv)
{
    // Load data from file

    stringstream ss;
    string line;
    while (getline(cin, line)) {
        ss.clear();
        ss.str(line);
        string field;
        while (ss >> field) {
            loda_cardio(std::stof(field));
        }
    }
}
    