#ifndef LODA_GENERATOR_1_H_
#define LODA_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void loda_smtp1_c5(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_loda
);
    
#define ENSEMBLE 35
#define DIM_MAX 3
#define BATCH_SIZE 128
#define N_BINS 20
const static param_t bottom_loda = 0.9718000593034282;
const static param_t delta_loda = 0.07128498340681227;
static param_t loda_min_X[35] = {-6.861135780643239,-3.8162001285821807,-9.579304835132904,-2.1246245623511277,-0.8645578668367594,-4.206715074130362,-14.94635584731487,-14.140030764675165,-0.26898946658646017,-1.8122274428405682,-5.274913749650581,-3.9632726461996977,-15.52078269431993,-3.4422625443649553,-5.633167190369434,-13.98423711166664,-6.835642870013617,-9.268738470973807,-11.975465146965213,-6.670895947447109,0.9995501828871823,-6.152882605525733,-4.849466004951293,-10.034213985353029,-3.2584871481742224,-5.53144742243004,-1.974737496304324,0.2835808647526232,-5.660614979048202,-8.300955865210017,-2.128093223969623,-1.2587406417786915,-15.42569227821406,-13.810793844135851,-1.7264825748864072};

static param_t loda_projections[35][3] = {{0.790860493998653,-0.5069497732897575,0.3428434138111305},
{-0.3278765047684152,0.917793015904668,-0.22394860476783768},
{-0.9465322224744434,-0.0942542149293604,-0.30853345812997496},
{-0.30865598866977767,-0.07782096707156773,0.9479849037523371},
{-0.2548134788528414,0.115534313021957,0.9600634945197412},
{0.8166267928466552,0.5201358769920881,-0.2501586510010347},
{0.4885062527623683,-0.7554186175693742,-0.4366970955269161},
{-0.37748894122011645,-0.6818626526652213,-0.6265504146969049},
{-0.5450237699483933,0.06108123706012849,0.8361926648030616},
{0.9690730140003989,0.16547358703813175,0.18307371610615386},
{0.47187170403786827,-0.26894173125986387,0.8396472116998578},
{0.32055520106661467,0.9141042067225605,-0.24831001252720444},
{0.4330256350760672,-0.7289133527500622,-0.5302585440609441},
{0.3249945560039381,-0.06214198225243333,0.9436720365728454},
{-0.7398212513875208,-0.4499965339438725,0.5001676073416833},
{-0.11971624209068829,-0.34152574378078804,-0.9322168136837392},
{0.24368750728732638,-0.5242480194447682,0.8159536830607038},
{-0.11966645081335507,-0.9123694689533539,0.3914867720262205},
{0.5886307724721574,-0.8033376407636224,-0.09034627070980024},
{-0.8668206507077152,0.2518400511430974,-0.43034700899029776},
{-0.3883427950658423,0.5999453776209622,0.6994679530841212},
{0.6104829065484626,0.27827364474584093,-0.7415351640023597},
{0.023367001515491342,0.7809842575254982,-0.6241134293840516},
{-0.16923655810747365,-0.9303870184819208,0.3251753115478754},
{0.9690431831884692,0.21762407687137095,-0.11659789998899145},
{-0.09053612903794259,0.5633003627166598,-0.8212769999836257},
{0.737615873867269,0.18542141287402267,0.6492624448301522},
{0.5278419765259306,0.5604260108136437,0.6382049312099559},
{-0.193739260499181,0.5323085429754879,-0.8240829533587888},
{-0.3886059440981774,0.1065200555791478,-0.9152261458082256},
{-0.004363522933746319,0.9991523607900503,0.04093311123376481},
{0.5923746638032663,0.7026172183125267,0.3942350849616693},
{0.009369678453733512,-0.9124274946001983,-0.4091311235084403},
{0.597538950475271,-0.4108141222609923,-0.6886065346886001},
{-0.8606616031029227,0.4661336388741896,0.2048927418290205}};

static param_t loda_delta[35] = {1.7924601867220065,1.3617319215442742,1.687803330285319,1.6343101800990674,1.5032745313830376,1.5576999954581636,1.2784292185591652,1.4450025537679232,1.7585004681595113,1.769582089181171,1.657204900451044,1.3575218525312303,1.2783754353366987,1.6343592846256674,1.8815455986235214,1.412254737824492,1.5964589670334617,1.4912618625829308,1.3801296584991956,1.6993262901724682,1.359030469152848,2.2758519389104133,1.564803986339465,1.4251746139112949,1.8083744645341648,1.6188891024801657,1.485538192204988,1.513227940914557,1.6041641288763817,1.6398426105192545,1.3508864786236863,1.3549208983294896,1.2706357054077861,1.5622661031460543,1.734179365337549};

const static score_t log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};
#endif