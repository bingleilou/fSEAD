#ifndef LODA_GENERATOR_1_H_
#define LODA_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void loda_http1_c7(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_loda
);
    
#define ENSEMBLE 35
#define DIM_MAX 3
#define BATCH_SIZE 128
#define N_BINS 20
const static param_t bottom_loda = 0.8953576384868612;
const static param_t delta_loda = 0.07089864275670443;
static param_t loda_min_X[35] = {-3.0076927824027826,-3.0045391262750125,-14.218686436553684,-4.623994871047236,-3.0184939171330134,-3.9185011685740214,-8.163719135050968,-4.353076537072954,-9.714709787047271,-9.59576751823428,-10.881874141619873,-5.950818021443656,-3.1774339088750505,-14.294732634206376,-7.061213662254158,-3.2950535010886566,-17.12500849695201,-12.928944246570273,-11.5986324276622,-6.0742089820339675,-3.569059441812953,-8.926664072824682,-3.737962321991335,-3.6003089650330153,-3.206984257553398,-3.0442343944601435,-11.422080189400988,-10.59653160528384,-3.603666354150414,-3.498794657119802,-3.2681589177327726,-2.9307175458378922,-3.1411036171931803,-9.977617192202052,-7.396286275920272};

static param_t loda_projections[35][3] = {{-0.4873643029768817,0.8716595690765367,0.0518230819342579},
{-0.27851707064703146,0.9487151940426403,-0.14955842320254709},
{0.33806910458254186,0.013012617160704993,-0.9410313237726932},
{0.9396351369642918,0.28863116420433355,-0.18378754155858212},
{0.9672104529081991,0.11971102737247068,0.22399377158872963},
{0.04875643834169813,-0.14146262168689874,0.9887421991528942},
{-0.8463495775325673,-0.21412485779353174,0.48769143716631386},
{0.9707656415352492,0.15982883872343379,-0.17907766897906202},
{-0.8161654001171688,-0.5748320476739663,0.0586698953342912},
{0.6817521768957995,-0.7315646412886898,-0.005210078117389851},
{0.02097496907369506,-0.9997257176533805,0.010418259681478163},
{-0.9658736334887404,0.24422286653092373,0.0862746520982675},
{0.9526787083098041,0.18990073523897533,0.23736256968793504},
{0.37784032777230653,-0.4709924605144928,-0.7971215646608866},
{0.32181949530276505,0.8327033638436425,-0.45059662702527625},
{-0.16812192163513812,0.39647010839905245,0.9025222837203256},
{-0.08597135324808694,-0.4386434171599921,-0.8945394787279641},
{0.5991167436574623,-0.41501544479905617,-0.6847052709359847},
{-0.402230274363506,0.4667054950395771,-0.7876527072798786},
{-0.4435215748741094,0.726842262892123,-0.5243938762943822},
{-0.2152463529200158,0.6830291769847366,0.6979542613539839},
{-0.7004949431384085,-0.5551353482875656,0.4484769556166304},
{0.9572486865476132,0.2741191218190785,-0.09237780662045753},
{-0.13665178983676937,0.9757979538846164,-0.17071801758749158},
{-0.06994507891232092,0.44510116948995165,0.8927444398340582},
{-0.3272274440775774,0.9296002550962498,-0.16960414372132301},
{0.5099088922697771,-0.8539838863493647,-0.10346228027568481},
{0.2300532035035236,0.47746070490509845,-0.848001650251515},
{0.18916146687218313,0.5939242179138797,0.7819667274418717},
{-0.15621157233985522,0.7023817009034518,0.6944479036638272},
{0.810478482483972,-0.004922913731895088,0.5857477224461622},
{0.9632116465403984,0.04455854923760305,0.2650242623964357},
{-0.2089976831496526,0.9437321938189727,0.25629965818882083},
{0.4245185465122651,-0.7137408844770555,0.5570977952685006},
{-0.1223611476183611,0.7910615987334532,-0.5993740873301002}};

static param_t loda_delta[35] = {1.4179812547057387,1.4036807711799215,1.063755224869165,1.5217961373962543,1.5481678977933917,1.029903225427823,1.293505567506357,1.6165335164687924,1.4824841428363171,1.5967988895706204,1.5108788271286726,1.7215870261033803,1.4810514520020244,1.117448440155117,1.2223904576835578,1.0228139960885003,0.9807415741404413,1.2088594270809216,1.0317405844810157,1.2374753516614054,1.1199436002095113,1.2345698314689644,1.5808792832279,1.345992625596425,1.0069870178352582,1.404535354720638,1.374689115546749,1.1640101835777927,0.9987143155927674,1.1103543195767003,1.264459412782368,1.5493887219778781,1.232388308980142,1.2051840390518864,1.1356190623427738};

const static score_t log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};
#endif