#ifndef LODA_GENERATOR_1_H_
#define LODA_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void loda_cardio_c5(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_loda
);
    
#define ENSEMBLE 35
#define DIM_MAX 21
#define BATCH_SIZE 128
#define N_BINS 20
const static param_t bottom_loda = 2.580379516762855;
const static param_t delta_loda = 0.0805177582801107;
static param_t loda_min_X[35] = {-3.071886959929127,-5.720224468896144,-4.997360724048652,-2.080744381178353,-2.7622988131931163,-2.648134928382193,-3.704119219645517,-4.578356307529174,-4.068569554181136,-3.5062083994362485,-5.279634159739767,-3.689401624178229,-6.370802105506193,-6.904412048841337,-4.766865766784731,-2.0740065958285556,-3.4808281446930502,-4.050379052292737,-4.830702514035399,-2.9386182571061505,-2.4676761796707365,-4.0723755501657095,-3.4423719451033232,-3.910386131371654,-4.281823739581647,-2.8473100297271623,-3.671018583429529,-3.4991810980651823,-6.7664230122821865,-4.992946293442587,-5.748011046223009,-4.172486834371773,-6.2646846055792675,-2.8387477000000283,-4.852886208984679};

static param_t loda_projections[35][21] = {{0.12190306380877529,0.379186665059539,-0.11971786612506034,-0.1712570387933061,-0.10560493061464066,-0.030705821004792327,0.14180441951601344,0.012537292734778379,0.19869633067808906,-0.24351471425836219,-0.24322187656945854,0.18335590273326988,0.26167020287608006,0.05746404649138678,-0.3066601160590108,-0.1321332210235486,0.337776283516789,0.1163428190270535,-0.2847571966340511,-0.13948645346914834,-0.40290731636964533},
{0.26651364814172007,-0.11807490976126672,-0.5640645074219445,0.17378257180850426,0.030865702332454344,-0.013171185317394982,0.1273071288267667,0.11741840395181442,0.15917968503066596,-0.33293000811465306,-0.19431581052563374,0.15835331500482921,-0.02737249501801176,0.304103830125022,-0.1285410247879309,-0.38402652024450734,0.07003648930321497,-0.09503284972313356,0.25382638237424926,-0.03038157024578062,0.0030873991746779433},
{0.05628266370880085,0.036623619505432185,0.04222739434215449,-0.017842212335430176,0.08780290537825174,-0.09148521827593446,0.06356745847883762,0.24747002370933735,-0.06442334571231832,0.12658055010073965,0.10723205263352174,-0.004484461273081837,0.13176009910380948,0.016720503929795006,0.2301841559149278,-0.4194815258268658,0.35226896010957387,-0.27947174562259386,0.38830561703900124,0.4023962372616246,-0.3447388323361977},
{0.11037596138110262,0.08170494394410048,0.1682082051525387,-0.20722112401561096,0.05625883895985621,0.3797389160346012,0.012091686465510287,-0.02188932400084499,0.5539141324172537,0.17307663472876453,-0.14777374251790978,-0.13352294784168342,0.12288629054871314,-0.2889914660473141,-0.21356984251361708,0.11477381257899846,0.13752367987702796,-0.29855439652723215,-0.20440192839286755,0.25110323678426394,-0.12324881460897531},
{0.17314073443663228,0.010052889294219412,-0.10353545351779929,-0.1363358298053273,-0.0034412728255651384,0.07066776290761682,-0.13325227602714435,0.24657299302047675,0.43752055331793743,0.025859590377358133,-0.1453952702513849,-0.057434019118706894,-0.17344019746913367,0.29291817309064466,-0.5081554881658098,-0.19824268883842808,0.020745732444021944,-0.15004137235653495,-0.17616210508930527,0.03954530847610223,0.41421992722519846},
{0.308479801256706,-0.35836427897844364,0.07533232153799703,-0.029413493749129598,-0.3510659655887831,-0.16293133703980608,0.25908934339176315,-0.2951516832880147,0.05898520983278839,-0.23922322768426788,-0.39802831664244304,-0.006759877984750798,-0.12045362399496404,-0.09082276693635175,0.20887409716844738,0.22314802184777782,-0.046613722968705286,-0.2754191261416956,0.04871021105042193,-0.07410396010902211,-0.21115460644844894},
{-0.31943675435893826,0.3166972063584801,0.09692866755201941,-0.3478371201591403,-0.016556732915243046,-0.03596691434408075,-0.2957989188163877,-0.37936286716695183,-0.187061941339561,0.07820566975503253,0.019762689557085593,0.4576210934615671,0.07226220090752894,-0.09060699983637248,0.02496127440702457,0.1463898524391658,-0.14681132956711732,-0.13493516425165475,0.24235577283455711,-0.1870391235325258,-0.12006176589778592},
{-0.43687835153347865,0.23618191543597308,-0.27249585701186313,0.020795997508324057,-0.17028180895157655,-0.07395834727763397,-0.15772948739386503,0.3707420159689852,-0.1366164945508829,0.03716648428427956,-0.013775311525127249,-0.41755288414117564,0.14421190816849266,0.089422803822499,0.27914731434542284,0.16318624837329776,-0.04171131153954488,0.10688632230768597,0.16731806043972566,-0.15171623598357603,-0.29960847369352017},
{0.3628379356150776,-0.009986515448097668,-0.1938472919166034,-0.008564820060292066,0.13919802993558048,-0.020435290698857696,0.0038682234841332305,0.3121070226713799,-0.33796503900328173,-0.09565915483767685,-0.343995407346874,-0.2374528961694215,-0.2839758751606559,0.031100065481294355,0.0035180988002034013,-0.07035702056207974,0.019705455048789403,-0.4286610236843757,-0.08184682340966475,0.09989566284520603,-0.35763520652514963},
{-0.349798325884155,-0.09020237346221906,-0.051259861853213726,-0.2329766846955773,0.06281673427972667,-0.11307578716200217,-0.0902120757607988,0.03160819785261874,-0.23198926936967199,0.1647358794362046,0.14216566856122284,-0.1485451743391765,0.40549488788696164,0.39671227575938084,0.24228155272271756,-0.18842087735180635,-0.06581525609076924,-0.05735831839406574,-0.3479282308193036,-0.19243654149286074,0.28597008874591906},
{-0.11741486531190602,-0.24938021675549682,-0.27208685723193426,0.09650267584524513,-0.04926040338070737,0.5304241192048827,-0.08936699183662933,-0.33894828358273427,-0.044055255470456564,-0.1453922089323103,-0.2837272522972595,-0.35936053179716587,0.07072788409638443,-0.09624536131565707,0.15110390296307702,-0.28814678504290764,0.12008190015275202,0.14187353097682115,0.15531254924703275,0.08189401948478182,-0.1257245125568098},
{0.20974765796926623,-0.5401414834197044,0.020857747455456058,0.1716455209839823,0.07477424207236197,0.24706538881020115,0.33997679791444574,0.015030613785376196,0.009457606918134513,0.1510443450964253,0.020863693212300766,-0.033536200100974106,-0.23569093391820253,-0.34562803431175765,0.03801016029982514,-0.24285574427866796,0.0765530856921207,0.13815922413075826,0.07333031649126437,0.12421754012840194,0.3824409789212857},
{0.29139785865268086,0.08758342152306899,-0.061530249467645605,0.10592702257525122,-0.15695133426658275,-0.3459603500891156,-0.10924853574383815,0.11460007876695998,-0.16278614750530743,0.5036474886055285,-0.05088930504341111,0.1862718436011322,0.03573932837620075,0.22085563455792528,-0.2551869419128649,0.496603497031354,-0.010133177844649259,-0.12145056097508912,-0.020084214140719297,0.04795709768095203,0.16194467773990903},
{-0.15906497408362755,-0.17165203066245932,0.12643443643697913,0.4021153802820576,-0.339686211786793,-0.35447653042706845,0.14079547080446198,0.2661105979839,-0.20109966808559313,0.10534947837890253,0.03889180168044443,0.032797348522422345,-0.10781864618469558,-0.1610194576279272,0.5420786947917472,0.058718028184499706,-0.05907918184204368,0.08356139917350933,-0.01790685880487679,-0.1784482753170664,-0.0652575593321961},
{0.05075409996480661,-0.12623565220945676,-0.08743186766180172,-0.08317055669117192,0.0496517849173872,0.30007760659046684,0.14601362321083927,-0.07690696910421004,0.2632449897129705,0.09356978712145864,0.03018450732996504,0.034485798375215496,-0.1268124479630662,0.036811768403849046,0.5066629193984767,0.1454337309363234,0.5900790850095561,-0.027361526832390123,-0.014291490876946358,-0.3454947307787603,-0.05673756759469503},
{0.2694629984478125,-0.06479980316139711,0.07239942687186225,0.23605317656027341,-0.14684499092017075,-0.043247424852409504,-0.039360056288643135,0.2156058517922434,0.33956219802758875,-0.07321754738244327,-0.439954059147094,0.2896220842061763,-0.1502007135344195,0.01755264157533425,-0.01587599950588235,0.2856544964399496,-0.15030930096370143,-0.03636528058724209,0.33016626820379297,0.26805910842888064,-0.2883670071393909},
{0.10658050898768841,-0.31272528171244923,-0.05701792816356866,-0.22545898102306805,0.1878443021542974,-0.10022800179883128,-0.0156980263999212,0.21650960458121477,-0.1378065484345876,-0.24830066931468353,0.14561505886224618,-0.21944615385317653,-0.2577052907255442,0.09090480115671351,-0.3273300436756686,0.19298375941019755,-0.029415753276875865,0.011459312668489596,0.19449468777005657,-0.39726183798761155,-0.4226078045052698},
{0.0844660791972347,-0.28159813592721733,0.0029907571936433237,0.18635027862421102,0.12727818651495287,0.13484673782773646,-0.4064803935116719,0.29845956864373385,-0.03591728987282587,0.23246162625091416,0.10617536763255417,-0.11346510880551317,-0.1103169839825231,0.13171109828695976,-0.1956996621351816,0.14005094919802066,0.39982735169868283,-0.2297857757567791,-0.25785377263653625,0.19202158275230752,0.32743587270849167},
{-0.18391997256001819,-0.08814555801361937,0.2893608486732268,-0.05280254992273848,-0.4178796640408206,-0.03960542361932951,0.254777257350679,0.08613326902474748,-0.23436455008214188,-0.26480260511959175,0.23581587498279444,0.028848240701274685,0.06758467708071327,-0.2595227686011591,-0.39875554431574445,-0.024148090953161862,0.11391411508915936,-0.16410799835605536,-0.16487792079672595,-0.07122645679778593,0.3717531737673156},
{0.23027802481296208,-0.13921328619878487,-0.15871000392825596,-0.027452461597302462,-0.3098160367481607,-0.1411876457008452,-0.11079960981888322,0.17991733861943718,-0.009654715916425359,-0.04260318008286509,0.4925245520113499,-0.1370576446072298,0.25558376752978695,0.08010579891425444,0.04326261967695069,-0.12432472833499053,-0.09074750258454427,-0.050035400409224114,-0.30169094199231744,0.4424873867887563,0.30197603584152477},
{0.24787245133174893,0.09114330555902189,-0.1341237047347574,-0.005659443119237492,0.24306940369715077,-0.12315328704986489,0.08432685916306554,0.4903488955614938,-0.036767581558603664,-0.34747582052197085,0.12867594929914894,-0.170944283533448,-0.1242764821257778,-0.19744465774518588,0.15161543560272497,-0.22037574794000983,0.3868806658572984,-0.06002954782877877,-0.06203173927154384,0.37221915827934227,-0.030011522856702832},
{0.28899256360563264,0.49490045969583063,0.013164806978087987,-0.04118958863214276,0.23903807629591128,-0.07396191890114055,-0.12871771209089394,-0.31401173161506607,0.0017121782478821033,-0.08700971036567892,0.026107408977377292,-0.1770695806041284,0.3505773291583099,0.05870171231452879,0.1669010253064413,-0.03244768502178157,-0.003898510353327924,0.3100691668804699,-0.1270033607803232,0.08110991055178833,0.42210304771602614},
{0.14869318914357418,0.2837290183704026,-0.32243838370046124,-0.25666445341675137,-0.008088018457696293,0.19239392979082895,0.3652525758808011,-0.15138738496924947,-0.07381686447224955,0.3550257919646397,0.2954590263400237,0.21393200463028392,0.22679776283849334,0.056757701694937074,0.09973231338337742,-0.2527499767114973,0.009353978351336511,0.20001148664846902,0.08231245900755778,0.2346048364955372,-0.1979565905139812},
{0.20107100000257105,-0.4289704580229379,0.03166023797587359,0.07877209957357582,0.26233474934639206,-0.03270400408882729,0.38041558051628604,-0.036638587642062535,-0.15709918091976122,-0.010982906453380969,0.01566594936192688,-0.281951759650644,0.08807418831881313,-0.021908974836722658,-0.11815895021535903,0.12014980787139559,-0.5975344587336735,0.057021275820554204,0.188040564293189,-0.01404853582471028,-0.12396317363425309},
{-0.00400028888496697,-0.5041419085037472,-0.23243359083082799,-0.09964609753479543,-0.3562470589900379,0.30465965737377043,0.10474142542395641,0.17351834100645053,0.14072855857260383,-0.08625492574555078,-0.16111789879339847,0.051684541315098344,-0.10738953511796444,0.3408937204607867,-0.04697523298944889,0.08510701299921,0.11856098124315723,0.2800700971199626,-0.0602404993754688,-0.3476239064770952,-0.10501652648558953},
{0.24386158941013214,-0.011052360125052242,0.5179824481648753,-0.04246446367758881,0.12367781819957295,0.13885185171111364,0.18262496643456322,-0.02680537485216911,0.38460049261218465,-0.1389783646174751,-0.12793375843766597,0.12280575828185393,-0.3304056429502636,-0.17352233418614588,0.050108691536153514,0.16571160023282286,-0.12348798600871251,-0.10569866196939433,-0.20961069836747445,0.21152564691534606,0.3444164818896389},
{0.22615380253796466,-0.5544154088409898,0.16080355887399986,0.15096873937392571,-0.07263842003019039,-0.1172929915076974,-0.007824966069609736,-0.01743608384417066,-0.04938457054459492,-0.15037918354544857,-0.2480199150515293,-0.13557029843648355,0.07852267479275442,-0.1561903958454668,-0.220142512770354,0.005395192705191844,0.26086149558836397,-0.09563249665328735,0.3928727293424904,0.004651613148391356,-0.3973229391171676},
{-0.056331446295402876,-0.10446869332683689,0.5950575381340417,0.01520541926778565,0.03731775519268991,0.21945036570121382,0.2262239943270281,-0.2636964926422305,-0.013085574189150677,-0.2890847235332511,0.07298187679923222,0.29908590743903035,-0.06870209238961755,0.015514970646742914,0.028642393930194358,0.28626178773026767,-0.15271622035938529,-0.12164990530246862,0.012648700924868429,0.12538536928967892,0.37559940170366674},
{-0.013458082318852836,0.0038923438130933053,-0.17420556643818808,0.20950487846961943,-0.12845012128679706,-0.06796129628993011,-0.31353593340106267,0.06849944904476293,0.24938277347351426,-0.09677452722961265,-0.3314136646224454,-0.32062595548772777,0.008468028178975807,0.04446934674500559,-0.01208756370008909,-0.3769392505180944,0.2512276745517188,-0.4895265074215634,0.15385103934657313,0.06564145009266217,0.20553978970416528},
{-0.32092093732988475,0.09566394139616807,-0.059055628734738096,0.10920781182591535,-0.0878093107144107,-0.1739442165656519,-0.010806796672148962,-0.040983511521986364,0.17455961696482475,-0.017542914477851147,0.17552049206628118,-0.25984844974502175,-0.06488776454488529,-0.2318522484910505,0.5499779653438809,0.3096658540032022,-0.1009594669169642,0.41144465090295895,0.0667097729471156,-0.12498875655093249,0.21837304356704723},
{-0.29114728144191937,0.3496328010663362,0.2480320276216017,-0.25788362401001075,0.045575611655180544,0.018466952049274565,-0.3652177149467505,-0.1257912817632345,-0.21040598884367565,0.04995329550671738,0.2444974061800315,-0.14344512791873304,-0.1082448486518541,0.13590763601467254,-0.3250679702695439,0.3591337705114249,0.06077394238889259,0.2448086308460765,0.11782016622375262,-0.13951000206093422,0.15625547225934933},
{-0.042144050854194585,0.11540848818183835,-0.34838356288873173,-0.04213247344742051,-0.18520499388177245,0.299661803222933,-0.15200466755209732,0.17672796927990556,0.022310828591450393,-0.26974541061720597,-0.1793114122858001,0.2889989214632578,-0.23958628002219698,-0.15694154362670815,-0.09521545729121751,0.18177872244990861,0.3959806248185932,-0.26130494600679893,0.18478093245229435,-0.07569918316513204,-0.32448713127543016},
{0.09812139655000507,0.27467194719668203,0.11976056166976135,-0.1486036042231244,-0.0009972507197707732,-0.10156760932164471,0.12126717701338063,0.3966932275125336,-0.15600782559802534,0.3297272778506179,-0.037821521715158346,-0.4191848218625359,-0.2887047890064282,-0.13798597856468753,0.20440405682905496,-0.40608349775876496,-0.04634902638055141,0.13926205586672463,-0.11899905205635206,0.09268931733622861,-0.18038603504378162},
{-0.044710325645614,-0.21527241243697437,-0.08896238160384731,0.2505256843616991,0.12432340487906049,-0.0033937567756240432,0.2997496931329594,-0.14362633958105786,-0.09554041514367478,0.1406986134648123,-0.09611584421060217,0.04704162281570912,0.22434093447824255,-0.0981838938555441,0.15844631909228535,0.3259273294526236,0.23076294490960414,0.2848361301813719,-0.5045750358085793,-0.3178997388178769,-0.18253142129779906},
{-0.08856899216442757,0.06509505394525614,-0.39042954231519444,0.02033896762258494,0.00022987204092952908,-0.009379321520869309,-0.16192265673904885,-0.0252614086798808,-0.011174883570596787,0.017635895321482003,0.25482692182752925,0.4651468533463543,-0.2313169649168778,0.09547061166340076,-0.00877543370508023,-0.3682019600917634,-0.39981005112508605,-0.053397541928463244,0.0050282881163704685,-0.3965699409269094,0.0901424124803788}};

static param_t loda_delta[35] = {3.1872965178658994,2.429962071238291,2.429363957169639,1.6719708609912756,3.7158931556348964,2.6623153995797537,3.2774295754681813,2.748236873581158,2.571733639202027,3.4894579102342926,1.4381404861129732,2.1979369153814705,1.4617156460408334,2.0620039151091416,2.229251032151574,2.3656197131895604,3.1335270724482047,2.670548184858378,1.936462529480233,3.135600971094307,3.7528484067354273,2.6544508609291406,3.0366315264083257,2.206681317183692,2.1702151812339876,1.9477682374185252,2.9062364131280534,1.860437051950927,2.2155670878228264,1.9353518775993963,1.787348490100631,1.9036774981500604,1.9768428966766785,3.323607228378276,2.553111805845464};

const static score_t log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};
#endif