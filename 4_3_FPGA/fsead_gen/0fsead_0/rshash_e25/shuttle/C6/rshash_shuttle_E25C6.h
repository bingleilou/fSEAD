#ifndef RSHASH_GENERATOR_1_H_
#define RSHASH_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void rshash_shuttle_c6(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_rshash
);
    
#define ENSEMBLE 25
#define DIM_MAX 9
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -6.133982010631548;
const static param_t delta_rshash = 0.1630262361817786;
static param_t rshash_f[25] = {1.5899244776024966,1.2548289786473177,2.088620590403149,1.6897885032971987,1.295047451057879,3.4086285790408666,1.7948732951980748,1.3248360748128023,1.249733021613869,1.1483776232833511,1.9958754412308484,1.3973104692933658,5.746655977869625,2.8973897104355233,1.4037876686550146,1.4967345012728002,10.752859156885634,1.9532027996353485,10.295304338180626,2.956887545010188,1.6206581011322363,3.232664844483501,2.656102354421636,1.7005740467461024,1.9003069287069296};

static param_t rshash_alpha[25][9] = {{0.037158368004332254,0.12610163121616377,0.44105961185697085,0.1107544143171749,0.41232070843473034,0.5516948490643979,0.2689181341263679,0.15426813604457082,0.5818083975990463},
{0.6503828473711033,0.7491863868999893,0.6986481835139855,0.7486691794075461,0.7920618704647341,0.7939482322010049,0.5607742934578388,0.7540788481817337,0.026645965479573635},
{0.12773308843130235,0.36051726152496805,0.1041583573803429,0.23004240191380237,0.020632389976266985,0.10283280344964965,0.17989645957142203,0.02459431416110007,0.04063184117970765},
{0.5167376092705103,0.1433687873339296,0.20215320401051118,0.09673219666016465,0.5465364005039415,0.036069309017152565,0.5023850521707593,0.2057883478210046,0.21498694531398616},
{0.21094563912619665,0.4070954704007563,0.023440590190436695,0.25855006675822184,0.37449855747858757,0.3902488984925919,0.08727690449266706,0.22154570484851802,0.5955575979352776},
{0.161880210329204,0.014208473251980405,0.2909990953889538,0.21979659702392854,0.2774618952269228,0.18915759202084517,0.24776877200292796,0.21577631404971548,0.23586183999656893},
{0.11728237213816808,0.24925149229408475,0.3694628134092572,0.15985306472024238,0.19043532913501168,0.09783529030449374,0.3681462323119035,0.0630238650177874,0.016473830941588382},
{0.024984531915434864,0.09183254423262187,0.303098727046289,0.5981473027397867,0.6840765184307938,0.5447411967252787,0.12134234290284407,0.3581563429684101,0.12801847769366273},
{0.1782568903289226,0.6683554066055446,0.37428161171891006,0.12309235125566759,0.5528775177466008,0.1981686768552563,0.600060083957662,0.14627880798038495,0.5789985623339768},
{0.7505965530259341,0.09120331677561026,0.6343074129793959,0.8167829333341542,0.557572529778042,0.6725592781796654,0.014525797911227715,0.7083261566657958,0.4899885315678892},
{0.008269114225097057,0.3889044888602035,0.22999826027678805,0.06752080453993387,0.01237571196622229,0.1587650317206012,0.1596590453618498,0.4892853498971335,0.35411266865995084},
{0.09405166921332134,0.1703920602197384,0.6922346508000035,0.16655212096936417,0.4044426565270434,0.3027288347859897,0.21540995051495465,0.46330923983218725,0.21522790899195365},
{0.02546879815691089,0.16336922717990687,0.15445786301634057,0.15314991282106033,0.11759616940214954,0.06803515532804003,0.03588478680900402,0.15234149867433594,0.10464355817150629},
{0.22735499958763591,0.24684013448438613,0.21189001932715654,0.14702164768226306,0.11289641369272319,0.026218605783245946,0.030200788366188676,0.3373667888907643,0.07907614124034343},
{0.26052403755457954,0.5626898911035145,0.4731196948441432,0.6529337886660362,0.39919284216001677,0.6596222035941001,0.2672186679060251,0.5458257518079239,0.17697510500240074},
{0.05196106584803675,0.07412918401468015,0.5112024913402475,0.03724480959274442,0.1204377097875598,0.35384979432522823,0.6418538973802398,0.5316983644325527,0.5531999066150652},
{0.0526363408598382,0.031518164977867406,0.08799726976116415,0.07299244958395895,0.023589490258064682,0.08720062891068218,0.08568252138139648,0.060055595195984086,0.0893466447349245},
{0.19334406540293628,0.5041184115032259,0.15702047852733672,0.09209342514984675,0.1355875039184007,0.20172848125571335,0.3022162849139448,0.11203556072404916,0.09990354505951701},
{0.056271530346165104,0.039880592739506095,0.006612237129249128,0.0431266465321981,0.09689643219370189,0.024955688128411715,0.0039716426532286995,0.05044875578610268,0.06813490602704766},
{0.1277743939738008,0.06849766888489496,0.12185684520487496,0.038765776679203445,0.280449394269078,0.03913518519323314,0.1659454940224694,0.24419154923049644,0.09019712203400276},
{0.06357044245611705,0.6055892997176976,0.4306510535763023,0.5932807071154786,0.33734130365841775,0.40722232105546297,0.04759233134752962,0.03190430305503525,0.4900927248770202},
{0.21387916551750755,0.16475750703723605,0.012506164337448165,0.2840536129558453,0.0905726522169315,0.16228830144111364,0.08776378968259882,0.04242393671736906,0.0713814902766563},
{0.20608826034579247,0.2859441020703692,0.060246708259220315,0.2626187413393582,0.23184718284567352,0.32542626701382044,0.2958517361155919,0.05100230343083152,0.21485332627334855},
{0.1562381212226493,0.34650994579790934,0.2653391331891502,0.5823713992012232,0.4329326111363915,0.16729089593881427,0.15814851248915962,0.36079789259279105,0.5789955162336704},
{0.16506662826290397,0.3752982176927273,0.3066089408861878,0.33962084472230736,0.3956331592529857,0.11609728466476416,0.07218755722602545,0.05364677557803448,0.38152859462967587}};
static param_t rshash_min_X[9] = {27,-4821,21,-3939,-188,-26739,-48,-353,-356};
static param_t rshash_delta_X[9] = {0.010101010101010102,0.00010105092966855295,0.0078125,0.00012871669455528383,0.0016025641025641025,-4.231371387466678e-05,0.006535947712418301,0.0016051364365971107,0.001607717041800643};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
#endif