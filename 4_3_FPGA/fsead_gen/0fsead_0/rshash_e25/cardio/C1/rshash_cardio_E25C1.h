#ifndef RSHASH_GENERATOR_1_H_
#define RSHASH_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void rshash_cardio_c1(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_rshash
);
    
#define ENSEMBLE 25
#define DIM_MAX 21
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -1.3833949602465134;
const static param_t delta_rshash = 0.7228593631870723;
static param_t rshash_f[25] = {1.9128116443939291,1.492743902476011,2.227248595909667,2.4226400774588375,10.676474945222989,1.5156078000141986,1.1965417012136197,3.556527681753883,3.8110364443687463,6.249799954613242,2.6771203765998135,3.8778228379752617,6.438784782107653,1.5350028372082738,1.9796946169859895,1.1130048260182872,1.2480862984446035,2.231197338680224,1.1709466629369483,4.574283996298034,4.002929667651895,1.8495008537105835,2.3208469051804164,7.341826763136276,3.0557020141188063};

static param_t rshash_alpha[25][21] = {{0.2822289952321951,0.3425092890818479,0.2989883369327736,0.234647054678809,0.4067829336976465,0.10839545566357088,0.3036846926561832,0.35305996503256465,0.5189260457075766,0.07909531325661864,0.3713546198685618,0.4789516303618374,0.4163098198240477,0.2719801014417883,0.4180870718774588,0.003299098987941752,0.017658061646634124,0.41118801744820904,0.13414467085445356,0.48729917299136377,0.378409467253142},
{0.33974322830524756,0.19735025463373904,0.28818251665416267,0.5945822035247433,0.20215520648760818,0.07507924375529325,0.08551699199569342,0.006043455812626275,0.19234115200988103,0.13892530679318593,0.6353916288519421,0.5004230546800279,0.16126730453363103,0.08823951926970401,0.39757815946144826,0.2959178944478,0.24356280872010933,0.31351855489347963,0.5536397851908927,0.2946330846585474,0.49182421050103686},
{0.20573525919080596,0.41017908581738755,0.3479620177525957,0.09005965524097882,0.15054120018913367,0.12456534649199373,0.3052415145996976,0.3723781362547361,0.19575436497231694,0.21112043928776023,0.30558367323232566,0.33652695628454565,0.4031217470457767,0.09014791807240204,0.22343499554889001,0.23266636357638912,0.14931223033386246,0.2669948420863083,0.08120061337006045,0.06580780154848322,0.004185292684754301},
{0.26461408971439043,0.16623807121230924,0.32821831997731576,0.2506333982339253,0.1767993937259229,0.18204239262220934,0.22327034476383611,0.06488853743475047,0.3283898046559498,0.330239973063793,0.11215293934322962,0.0909043623207656,0.08886059585764229,0.2931279524926153,0.23327116894568975,0.296701658637318,0.3834302586967592,0.035164370841670956,0.05836361171196884,0.3377186300208567,0.19409724364253134},
{0.04013439192120214,0.06131233091418598,0.00893188525678977,0.0802823842881892,0.07232608304120504,0.08960918757664264,0.050763885282153656,0.006854796132165221,0.024207489755561987,0.023141889647262926,0.04434847647021485,0.058061023375758886,0.010401617810104518,0.0815550061206746,0.05109831871456221,0.05284874905021421,0.07339790077588643,0.0019640098504343523,0.005866956272538169,0.08441533522402625,0.003953445918082348},
{0.3885690475390974,0.38438917246359144,0.6050207714650608,0.5345673274225087,0.6106432396881939,0.15378966789594803,0.5787170837701789,0.27116920578591996,0.3091512134640261,0.34647624153959244,0.08396624027496946,0.18325239242721367,0.27105244318675537,0.32294924188377117,0.6351521488019505,0.06136443218540055,0.4364280152607903,0.0933505341607181,0.5226343314392287,0.17084602629066445,0.447316119709264},
{0.15730811695171884,0.6091035906918992,0.17160863751820735,0.43817383662825965,0.05349123682430748,0.23474171988952922,0.5647126963233103,0.32647108113416007,0.2816598494153135,0.036322929902255524,0.7455777828244097,0.636247641744377,0.16138257979564036,0.6201517673140203,0.2174675336191755,0.21921274427230508,0.600170561149925,0.35635426724468133,0.43689797995493823,0.4162580193051198,0.3777478854605117},
{0.1478110490019892,0.22608623116919196,0.0197418888854065,0.15921642438188088,0.20772836517009935,0.18888402274328403,0.2047384554900442,0.0067130983717880255,0.07625651934630184,0.22100669998882821,0.23635921192936424,0.19376196005606391,0.20914099343077358,0.09415493838894447,0.00811475015821757,0.26893531227238826,0.20484939204945704,0.14833225819171056,0.013174422160241894,0.2102081793868652,0.27193442270821444},
{0.05051684571536048,0.01188196809461893,0.07349765612126911,0.10180905834983545,0.2479628972361352,0.2459543484391567,0.1761415148964905,0.15579166028320166,0.08566382669025026,0.18615011914562832,0.030633109461355165,0.1394661358515592,0.23844561022136787,0.05790335526208965,0.23422646046993495,0.032630220566983316,0.12619170476338,0.09564752833377393,0.10221661206479855,0.26139200813244784,0.053453678269177476},
{0.11392566139210616,0.0649595319421495,0.019475967464693825,0.0511338102424441,0.09870154180235427,0.02806294719941154,0.04767065235514897,0.07580341750199183,0.02177938367589993,0.032873103303509975,0.08164143419485334,0.004091669491366494,0.08470815977350155,0.15861118244616354,0.04465467475237722,0.11708266734403676,0.01867384022991359,0.09287275359685095,0.15476743464277468,0.12408163782326373,0.07152077955614351},
{0.014703099498950682,0.06200731878459296,0.2100886537752337,0.08418714545595075,0.13845834683011884,0.3530018020936581,0.10939715168301753,0.2900724160179868,0.2570652948520876,0.07480739468862677,0.37181630043628194,0.24692698771253785,0.28437780105695026,0.09439565016887175,0.2816650371279323,0.26488251052267575,0.31711575466253056,0.09147129177462485,0.21943368017767223,0.3492073254467458,0.075458017880037},
{0.23145482648087937,0.13296993010900982,0.21884633927329708,0.07812648223260905,0.1808400371669592,0.23569136012331782,0.22433232505891504,0.09293749919279676,0.09381858691154345,0.010836592216148121,0.09113554408288677,0.07080739179808443,0.04918635002238617,0.0007721672713400718,0.1501804693518214,0.012127157603797704,0.22116242399224514,0.166715905823366,0.22436274795563377,0.21272577995908537,0.05616441396110913},
{0.1481639504123735,0.14494357308987776,0.01275992496230145,0.10244276936443193,0.09535068909470347,0.0064674037955511285,0.15158995903675965,0.08167748667974277,0.05000709789030818,0.08646262399687883,0.074877215334109,0.06465398183842257,0.13182358979036496,0.08644827921878,0.08353746514863467,0.023215234345457053,0.08859016320078336,0.13194751912625555,0.06533830127540118,0.050465598231786764,0.12840605718255804},
{0.5759671837948327,0.3037887968486736,0.40469627743867526,0.6237930562572029,0.4858765551593936,0.6026548351891171,0.07617785632350442,0.17988051551251905,0.5074171441140652,0.5104321911008993,0.3414912449159063,0.3390319337384078,0.4363054031870652,0.11668841891314892,0.2432097203651151,0.15317414015047331,0.030801045089028648,0.1686506670548522,0.21855125763300737,0.3627467356238426,0.5553256758139244},
{0.10439858838174446,0.028736362896567908,0.34158410316212634,0.07207106632182228,0.3612443134981267,0.12304843280427555,0.4089888527651012,0.4326158055524953,0.1090114083980006,0.3773472964620807,0.393682276865718,0.40759282603653235,0.13786327685819888,0.10080636080885823,0.26476018326741907,0.37322493273276586,0.3464030958078499,0.2249413012609768,0.3872823591202345,0.23286131581165861,0.06677182858876188},
{0.36939070373217175,0.3851809642402616,0.7163649422450921,0.11616393487959281,0.35240523524072936,0.3662261805040393,0.7722476445751859,0.13121665917800585,0.7434236517495674,0.7437705292749255,0.1888498024010333,0.2779392781232333,0.3554500574744057,0.6329575921414505,0.8444290497789991,0.009258852958600345,0.2924242227521294,0.32617925325126973,0.31493612490025363,0.37822598271783114,0.5255397497798655},
{0.20369922788276823,0.08056084771439422,0.6648297663982898,0.15597945584741904,0.4550470377966214,0.41085110370406097,0.7126543654931773,0.6098503071766117,0.4561427591015342,0.3283581127027009,0.5576860072401209,0.05433882883008766,0.29957749157990404,0.05561365295456633,0.26140571294818826,0.3321215807919739,0.5515887600254538,0.07228372470512963,0.06738978459393268,0.5560846223755573,0.333727196919893},
{0.41157633761733103,0.32135997223393625,0.3564766690300922,0.017992704880746967,0.08642346239466421,0.1783869942838918,0.1584676229434521,0.4148671704744854,0.4405768602808836,0.34487066525647064,0.025265278444559367,0.39104670050939166,0.2643931974376956,0.3498318167445692,0.012532611384520284,0.41285198684842084,0.171243537469414,0.22449682176149074,0.08675259137692475,0.4047740204838144,0.40387479025995293},
{0.27581016242581924,0.09967920433881464,0.5317870755453026,0.3014043505043842,0.09329258839885479,0.11254202515214053,0.7610200787948898,0.17204169018358167,0.03777041973371379,0.7689581930178455,0.4280665557753559,0.013779231021835802,0.11281955760518278,0.7896558783789389,0.24262273440200327,0.37636032188586455,0.3275191236255453,0.4517016846277418,0.6829128939530561,0.04467540921424201,0.2383224831620559},
{0.025322445587233296,0.006973403309321948,0.1423201164629594,0.14118082689052436,0.2028494678388613,0.17297397388303887,0.002090369116370951,0.014362740616756318,0.0514847144937354,0.020946050913241712,0.09505303805849143,0.13120957503086597,0.19440503565205172,0.1565063034547809,0.04466708508459628,0.13388793722005918,0.12783346129344234,0.12551694800328037,0.04120646505256517,0.1677653034707894,0.07257163187854201},
{0.16437751418571042,0.007627341203131736,0.012304816354589477,0.02047878358191558,0.1543763156551018,0.23504061483986718,0.06249271645199989,0.10738448893184033,0.15259413612752834,0.2070990253950289,0.1085295758842684,0.05159712737120083,0.05443996239430559,0.12397259117448524,0.23590035439779655,0.11177911541294393,0.2228841714293125,0.15350096314168898,0.14073461572840903,0.22191183586749016,0.1120294835583425},
{0.492350186920874,0.3936624419426189,0.25146808119422037,0.13468599878295173,0.2655616913684453,0.2127703139472774,0.38555275627052055,0.5139877568431797,0.4576067182053379,0.23534301485769005,0.5186433362242517,0.1141864042593354,0.3018127098639174,0.4237690908429334,0.5353496119673956,0.15022593959332994,0.026566985261166787,0.5328127948954678,0.33185105617561933,0.28292603315197207,0.21777915420301944},
{0.1876493904863575,0.42337201804268815,0.20098509525155045,0.2965441145761501,0.23146423223134266,0.22940777348419922,0.20750477104994713,0.4252488932754388,0.25837821052688387,0.13197514855683756,0.06625866914229801,0.28170372899553214,0.35656370833292655,0.08461595183515924,0.17653324141696217,0.3841391709287098,0.05013254614555904,0.3363385542192546,0.05826194370431753,0.0484642326398407,0.1104464053307784},
{0.04598477753907764,0.055025505336608604,0.011431074533686063,0.0239110461266972,0.0889935369900238,0.11422035571244761,0.10890298429870493,0.01158789826400041,0.08679611299005945,0.04930336095796507,0.08563404049038022,0.08032623866282174,0.11986127933220192,0.011117030367471574,0.123372691448008,0.12560082302690412,0.056813364342813935,0.10832089376154537,0.025212831648342933,0.0723805867926119,0.08330926422100124},
{0.19588554681523143,0.16472444579533696,0.21478763639733975,0.13115307227962403,0.24621857638149422,0.04141733793767634,0.01621970256533532,0.22845502644694382,0.03179291392132977,0.08629481490885534,0.2409245183514593,0.2719962713291341,0.00032651776748023514,0.03806601135074795,0.14551800873964188,0.043191711025540654,0.08497726507626252,0.2745523900476529,0.2976020700855626,0.23982990975418372,0.12159807286744508}};
static param_t rshash_min_X[21] = {-2.746330647550977,-0.9199884374438398,-0.20364048566636067,-1.635871141309735,-0.6835984744007735,-0.06140064449540183,-0.27829494600614724,-1.9495717445965985,-1.441358488528391,-0.42048734791506204,-1.398087924648133,-1.8765244994087826,-1.4398413651943174,-2.325378561577513,-1.441407750185039,-0.48827888518542284,-4.567897329062897,-3.8293160555105947,-4.113439081421025,-0.6905897475230182,-2.1266054668088588};
static param_t rshash_delta_X[21] = {0.1750050751949002,0.20507768944038135,0.09868759942952245,0.19157113079326857,0.19997965696857142,0.05009571399865908,0.11279531203908376,0.22287053286338301,0.126980473929281,0.17655784941397185,0.11587612044978589,0.21338726397232247,0.257438263588967,0.15673583076011613,0.16149567346856478,0.06890082523104071,0.130981290338828,0.14368969105603885,0.1330241720960372,0.1113004489272115,0.30612654157244695};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
#endif