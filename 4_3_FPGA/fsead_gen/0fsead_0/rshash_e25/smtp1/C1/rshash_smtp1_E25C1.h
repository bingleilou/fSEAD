#ifndef RSHASH_GENERATOR_1_H_
#define RSHASH_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void rshash_smtp1_c1(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_rshash
);
    
#define ENSEMBLE 25
#define DIM_MAX 3
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -6.439949408369456;
const static param_t delta_rshash = 0.15528072296660977;
static param_t rshash_f[25] = {2.518092730223976,2.8721125555790517,6.28480209659655,1.5754152519865798,1.263385755482475,2.561122140218769,8.493575053767488,1.188873085265698,1.6667839742623867,1.3545335935151335,1.1982862354210675,1.8672728579454934,1.9118436654258932,1.3394972986503737,2.2728436793187856,1.2645860402389812,1.1381210949909526,1.1104381665993592,2.031451471148482,2.5069447943262335,2.8871366403462395,2.691080350611917,1.4072711401147082,1.2374480316871703,1.3816058434945695};

static param_t rshash_alpha[25][3] = {{0.11782821569073922,0.28310532029526897,0.31340713546354765},
{0.2613497403509642,0.17993808317813267,0.23113489456821473},
{0.020344220010510294,0.06607586766412132,0.09037310035632072},
{0.5530059959804585,0.3657119880947784,0.16534087490402052},
{0.38833169714096744,0.5360126357434569,0.3130275407250441},
{0.007436587097409637,0.21006287511370628,0.2819200787921715},
{0.07218923296819967,0.04581472136739709,0.0007620165751346027},
{0.3968427121456478,0.03643105254828551,0.3401533821546183},
{0.06371456183563434,0.18008896596703353,0.055993434277398856},
{0.2588955530913667,0.2093795718786473,0.11880583987432244},
{0.40640350425720284,0.30845770247774784,0.2991510280074893},
{0.3467930044111217,0.18334514279722156,0.17414908684484953},
{0.4041356848330705,0.21084307896066037,0.12581003474667438},
{0.6481879070760158,0.3166666611441344,0.6796629540900371},
{0.38733064656143973,0.15384107100959699,0.2452243930561075},
{0.7494567277745681,0.058556507442595045,0.7660182299417102},
{0.029732552822010858,0.4521469040144569,0.4388886177269122},
{0.19734747660802776,0.2916647634460552,0.8474445162294322},
{0.11244174599491037,0.09194291708615655,0.32038892971406135},
{0.16947951667172065,0.16105694127105308,0.33647889190725067},
{0.3205577413070036,0.31613814207791024,0.24138240265071959},
{0.025196018838575984,0.3644088504830362,0.31087495841028384},
{0.4320492412648655,0.3208827120389984,0.352969700794913},
{0.58779980393859,0.12098586247297763,0.6816558648105837},
{0.00044245595617280854,0.22202566273689553,0.4578248409645482}};
static param_t rshash_min_X[3] = {-2.3025850929940455,-2.3025850929940455,-2.3025850929940455};
static param_t rshash_delta_X[3] = {0.10966914793430914,0.06786606421333176,0.0757271223762866};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
#endif