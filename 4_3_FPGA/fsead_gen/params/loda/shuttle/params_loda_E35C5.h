#define ENSEMBLE 35
#define DIM_MAX 9
#define BATCH_SIZE 128
#define N_BINS 20
const static param_t bottom_loda = 0.0327397510472687;
const static param_t delta_loda = 0.06681249496346338;
static param_t loda_min_X[35] = {-17188.024747502513,-9577.067693088913,-8403.641798990655,-1955.1756222966324,-4054.7081238792844,-4052.6078679466686,-4428.54465306763,-4813.584443109883,-6462.681783533121,-8030.521024456874,-7615.292561494458,-1054.8785828004804,-4295.298469064969,-9763.647377757938,-7114.848579766187,-20585.11488710738,-2468.897392603938,-12229.0060783152,-9326.76733976761,-12744.020087715171,-24917.690160644946,-3427.386121409125,-3153.0024634113847,-5463.036227478671,-2687.572649420487,-3519.449237132188,-1511.079307803039,-7760.364907401948,-5708.459976890757,-4791.915698810289,-3348.384300535068,-316.51627991321897,-2509.0532355504065,-1038.9501701632332,-1417.8271776341444};

static param_t loda_projections[35][9] = {{0.2500416351050031,-0.480256149369496,-0.1311402317996102,-0.1814286352694248,0.23083867468564218,0.6413331890695981,0.2791396531767978,-0.0604263969426965,-0.33249669631242246},
{0.33671481701586004,-0.473934378003933,-0.1510874268272965,-0.24548169512784296,-0.1529931542441882,-0.5953156360020196,0.0477188656584793,0.4437708248501755,-0.04362817114957002},
{0.25246034130137984,0.651513057295495,0.2168016463705597,-0.2621933340500342,-0.05143941671779527,-0.5298359845898362,-0.08345944113747823,-0.3209717436888534,-0.05182365515880529},
{0.4055443836607404,-0.39552842691859413,-0.18729590769944604,-0.3718780399346145,0.5843694127315605,-0.0873784824710623,-0.2036172211035057,-0.3197444128833493,0.11357337152148012},
{-0.33339791301946253,-0.3394590300238535,0.41948154030658646,-0.0655248081074178,0.6746659062963677,-0.27422913851805675,0.21001562132113813,0.025704678601599733,0.1349523551556673},
{0.2862624004001727,-0.5545970700659304,0.4318637630621977,-0.05892773438089986,-0.5199492904261205,-0.24931860277301596,0.0318258484931523,-0.02057613488399735,0.29420035350678947},
{-0.340873671889142,-0.21280562670694383,0.021944758803670302,-0.012406766163204908,-0.5434662888279006,0.1626325720921402,0.23358953686735004,-0.6773809030696616,0.05166705520976778},
{0.2583010526980606,0.3460690178780852,0.32214092284865714,0.6080416296028144,0.07736558743537936,0.18396204526869708,0.27283849364457713,0.12590112857855854,0.4581571755695641},
{0.6417791822696517,-0.4421154484267492,-0.34498775750822747,-0.25770122677705065,0.0901493151458487,0.24404763136503754,-0.25185508353134034,0.11766920857745707,0.2495270831208201},
{0.35097575509719814,-0.29663719707136954,-0.5067471325691771,-0.15667489233004903,-0.4157863501102123,-0.4992495173799241,0.08338090337320422,0.2557496399468953,-0.11399162895370839},
{-0.04992046580871137,-0.605013563935132,-0.07384740351825589,0.035225961438104914,0.03286536994091203,0.28337643031759413,-0.7054476862766514,-0.0038344807868036846,-0.21381943799721226},
{-0.05609517137842849,-0.22147659008755682,0.5117516193562038,0.17819510922258672,-0.6005000737086941,-0.026410361391179908,0.16765310789263102,0.06701105399360802,0.5101591352414601},
{-0.46039587450826663,-0.19638659767160282,-0.2566206337651544,0.4246435712299744,-0.29748905999218633,-0.3220225778938307,0.3806482026587009,-0.37624210277535586,0.1569782633144496},
{0.21054716530251424,0.44770025114599343,0.10094037956050791,-0.10026329977093967,-0.003932496271230856,-0.6351951420284987,0.2708749554082899,-0.41883298951209563,0.2875935312998247},
{0.36147612964753234,0.3018919860651712,-0.02185377703239472,-0.14937026472002918,-0.635389698442824,-0.4323887213380906,0.023174183429761123,0.368252287495065,0.16905711354721953},
{-0.27361771659091944,0.22996538466546815,0.029470551282993668,-0.3223185263303949,0.09290173373352652,0.7709786878112952,-0.2460306931315005,0.28500495998750613,0.15064435882018637},
{0.46244723564643064,-0.45706890939135614,0.5098412335014993,-0.4081900096988372,-0.08731427973931633,-0.12388803727468431,-0.23272184610327834,-0.18700539695616591,-0.1963947390942113},
{-0.032817213146637124,0.07037941469374415,0.2915317165788867,-0.18690082278308165,0.3113481765827855,-0.7966194455470191,-0.11647186053660534,0.15072196478961192,-0.32592035243025874},
{-0.1693510607784219,0.04318985099344817,-0.07889914753473154,0.2929312208558409,0.24476079609042198,-0.6478140842258555,0.4869511903452578,0.026841978626938517,0.400010238282863},
{0.5156449593987571,-0.3342973779114091,0.11392762020363605,-0.06017231824916059,-0.34295381268226466,0.4766657242404149,0.2840022916031682,-0.4048593313282127,-0.12790394185148807},
{0.27350922440774916,0.16337186839980908,-0.06492558500379819,0.04937233918831265,-0.07582185348142029,0.9319573994020198,-0.07636604577530577,-0.037491056542201966,-0.10157990589125031},
{-0.3924617795258499,0.591793915256287,0.4115921431632225,0.058881670187346344,-0.13434482943503512,-0.23890828351019666,-0.23931955493813778,-0.029133553446779453,-0.4354655619464643},
{-0.03012453541626959,0.5194165124021677,-0.4453226574744695,-0.20216331425169454,0.12426707937381003,-0.18361463751568316,-0.5434395267339325,0.2198181906737742,-0.311951159360828},
{0.17167724586182026,0.46352905517320864,-0.12350376677250394,-0.7297112794227157,0.11531112029625666,0.2050375719020804,0.10310700420264028,0.31111585229699323,-0.212543685670011},
{-0.560008174406686,0.3870928988690903,-0.39012710845664655,0.043214917710680964,-0.17020255848061216,0.09476767728254903,0.01965524316548866,-0.5715873248335984,-0.1320417370081534},
{0.13714233649242108,0.5568720456077701,0.3790791136800357,0.5125416890468383,0.08436053572884847,-0.2709709253998525,0.21769107174264402,-0.26158484693619605,-0.2613954277698537},
{-0.11907697883509644,0.018333776091886023,0.15128477381093874,-0.21216100579373134,-0.12246402220012774,-0.069489189874506,0.30141111626985195,0.8465589705109078,-0.30041343976744644},
{-0.02768857218868679,0.5124669662702349,0.29393906306269163,-0.2686980555141958,-0.13454810490244573,0.2918677086772329,0.4006673720441272,-0.3226074842144442,0.4583800277361497},
{-0.2662190147808237,0.11658288063301978,0.06660708402889869,0.45872668163229186,-0.34187854429131476,0.21221287018906504,-0.018591774549041977,-0.6066922280800744,0.4127139942065823},
{-0.023909461136286,-0.6563673593307959,0.16494897919791562,0.21137899625010428,0.18214136155728847,-0.35810042965441163,0.13142717398863943,-0.32518848278198753,-0.46074823577941765},
{-0.3690151323289053,-0.045223353052065055,-0.34419366566430776,0.20573302248450426,0.08511455286432557,-0.23419188096773946,0.4745524272699801,-0.043314098789986696,0.641732719147657},
{-0.4403922227372302,-0.04606939367974571,0.35960228436943703,0.08286781949794329,0.463423859039173,-0.02302600287836765,-0.01589752847422318,0.6528217950066214,0.16133978214907704},
{-0.09303252752311804,-0.3680922770059188,-0.16086865670908954,-0.588051999365256,0.06058535478927946,-0.09831140665333268,-0.24765184773470844,-0.5725269222267692,0.28585820524942873},
{-0.6051168643828898,0.008085699027377876,0.19299244894514406,-0.2712036974463647,-0.010658323058877935,-0.03991074540477397,0.1819671338191503,-0.07244498246548291,-0.6949128652775554},
{0.3106846783818734,-0.29617806377395967,0.05739866646889845,-0.38329589780438544,0.5173930123917058,0.006383254363490005,-0.10248506549044299,0.1463081942198969,0.6048947688807385}};

static param_t loda_delta[35] = {0.0007467547504266925,0.0007823402970236498,0.0008861795506827934,0.004686045000126394,0.001755284060128221,0.0018473958652232923,0.0029305970017971905,0.002321154495029269,0.002066694001493459,0.000934654619520178,0.0016695878477187428,0.009231120260367685,0.0015589992154053881,0.0007474368657817668,0.0010645732760097676,0.0006325179915140446,0.0034347051810362777,0.0005965889609340453,0.0007499674123152276,0.0010035638488404138,0.0005109093422154759,0.0020473568464514655,0.0024970457615405765,0.0023985572064940484,0.00444317587577219,0.0018622241219738692,0.005805634597074382,0.001712718839121447,0.0020778900594072675,0.00140030978507683,0.0020797177682221925,0.01987994465447748,0.003932788632450033,0.009696907183713143,0.006741333435320567};

const static score_t log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};
