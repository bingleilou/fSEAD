#define ENSEMBLE 140
#define DIM_MAX 3
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.964051379979506;
const static param_t delta_xstream = 0.1435945752604345;

static param_t xstream_fs[20][2] = {{1,14},
{5,14},
{1,10},
{12,17},
{4,10},
{16,19},
{16,3},
{11,5},
{16,2},
{17,8},
{11,2},
{7,18},
{14,19},
{10,18},
{8,7},
{4,3},
{6,5},
{3,1},
{7,19},
{2,4}};

static param_t xstream_R_T[3][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.2779276393653878,1.0,0.2774557911045441,0.4964907665775345,1.0,1.0,0.2774557911045441,0.2779276393653878,1.0,1.0,0.2779276393653878,0.20501063765127978,1.0,0.2981485530810293,0.4964907665775345,0.20501063765127978,0.2774557911045441,0.39093570056855725,1.0,0.20501063765127978};

static param_t xstream_shift_deltamax[20][20] = {{-0.44171822665685034,-0.14739108606157436,-0.12714786889642338,-0.4310687992544133,-0.015439139057555229,-0.34926058361114687,-0.7498388963302821,-0.34290374390263506,-0.7597130042385833,-0.6398995504346667,-0.386489620635887,-0.42295723627051673,-0.5607049485415059,-0.8138628144180247,-0.23748956450063285,-0.26375002735677167,-0.011358198880564108,-0.6996682712117983,-0.7165430204236911,-0.5646087913012905},
{-0.231079530045313,-0.4441011197839503,-0.8364290886814223,-0.019946942203688756,-0.33079777594470194,-0.2776538973641527,-0.08191428210178664,-0.38505212094093194,-0.15090536511404473,-0.13195528641389798,-0.7942125647886069,-0.5794650033132075,-0.5502407872500239,-0.4939821599405448,-0.6948643249722486,-0.7086096277639412,-0.3094476104496474,-0.8833829264957115,-0.4497191580380583,-0.40754125347313486},
{-0.8866640035352394,-0.42442494879740256,-0.7289206904772044,-0.676475065333604,-0.6898121473126566,-0.14693673800056728,-0.5374359707460643,-0.13721544154728194,-0.7920344946472928,-0.9162877585004949,-0.041203337803112805,-0.8695330709539408,-0.7103286631558613,-0.7865324639943128,-0.0933017107757651,-0.9767509486375041,-0.9194667924549156,-0.8225848982132095,-0.6015655562032757,-0.6343963801272532},
{-0.5080601431407197,-0.3095575875681019,-0.8151505101902362,-0.10129508363671902,-0.591790595024912,-0.3610247217545338,-0.07482418826712645,-0.8742255909108878,-0.993283237268966,-0.6155588807585715,-0.3463249613073641,-0.21206773648844945,-0.8070900453786738,-0.7957294309769449,-0.3107237192059533,-0.7749520638680301,-0.24144734485691266,-0.06662210383670775,-0.4032509317026777,-0.06903148055859609},
{-0.7158636298226538,-0.322237511249427,-0.7565064072672396,-0.41288288964507414,-0.17935054057052868,-0.47920400192138535,-0.40185656480827414,-0.29670445247740374,-0.49662604044923286,-0.3640484722108741,-0.30360757597299315,-0.8369498586796325,-0.42691893989422025,-0.3219295552995197,-0.9883992673682104,-0.9745535963788349,-0.9725306585806653,-0.9863569904502495,-0.5870109990453307,-0.3783108675419047},
{-0.6440020137399193,-0.43863006227094825,-0.49260666167926237,-0.2037258352235618,-0.6993676099006677,-0.9314837256399822,-0.7397873257980389,-0.7354452785621902,-0.2872605835633164,-0.18069400014786097,-0.28906515861748616,-0.48984251467248363,-0.2531261720361778,-0.43065893880678274,-0.627409060928728,-0.9199053411318142,-0.47122024223910586,-0.5282765971687494,-0.06097694843782464,-0.8579809769953166},
{-0.4038804038589002,-0.6183691685617629,-0.2669757757194652,-0.6745039792064141,-0.5073707880899571,-0.9083370088272675,-0.42567805379160584,-0.02078918265580676,-0.9519557527197989,-0.3657097256822194,-0.7399238532055542,-0.06914475855434066,-0.9696859910373418,-0.45330018118846505,-0.7583802508161155,-0.6897685934708412,-0.5306057667659098,-0.3471651384155692,-0.23336777130356012,-0.5539666349383291},
{-0.10632887219466125,-0.3290860500127625,-0.4692454637525941,-0.8922097773542549,-0.9170865430712531,-0.48035230969024234,-0.5968276273982177,-0.051960872701379834,-0.04174014912746837,-0.765694077080555,-0.608920451584163,-0.08252760239284684,-0.012230391944299424,-0.7964649777238755,-0.8790785804494743,-0.5211757634539596,-0.7363960702495339,-0.4828468305596145,-0.8329832145805985,-0.11474418297206646},
{-0.5582939277909357,-0.4029282460876211,-0.44474051351000116,-0.4602177451700553,-0.8571168675427594,-0.13879924059374182,-0.7022482507029999,-0.2754486571146513,-0.4441690113962915,-0.9639060841242864,-0.11395752569695305,-0.8869092762328493,-0.33501026723538085,-0.08568710802382351,-0.6559836757925898,-0.36115352022238045,-0.3259649602149782,-0.862388263935553,-0.23789476264602794,-0.7198857312214326},
{-0.6183632112919659,-0.36976588131538535,-0.64868325406433,-0.9791058203049641,-0.6821384195239358,-0.2241206819529611,-0.9176706436272397,-0.5848808960018751,-0.08645260043998293,-0.10487438264786464,-0.8247277715327832,-0.7323775080148405,-0.5427741105902024,-0.9460853671513987,-0.49846620413250026,-0.5195413097771762,-0.4588864110775278,-0.3076244121293371,-0.5581823727813731,-0.49045167484835506},
{-0.2498000710889795,-0.11595701631596833,-0.6352296363298148,-0.9535766517733759,-0.6813731358285894,-0.7810308933723713,-0.08186429367801074,-0.1701330424603742,-0.41489809445561643,-0.7767217239256808,-0.6551215781888866,-0.766419400548334,-0.8156317149292206,-0.928527574747873,-0.9073994732180256,-0.742109451093907,-0.41413750342600364,-0.29399649079703494,-0.9456647620438349,-0.3296974738365339},
{-0.17435034468710864,-0.307395991994348,-0.4656925082464598,-0.10861331568722421,-0.18586154043128078,-0.18671827702857902,-0.09438603156967784,-0.5561936939795756,-0.4481387611161396,-0.9331661784645304,-0.8049230210094274,-0.15589827333303652,-0.27547554156814447,-0.8852878659811533,-0.8757935681210264,-0.5574374432754661,-0.9047361692187545,-0.7475743461524885,-0.14547192916924234,-0.43004688136650926},
{-0.15056498875650248,-0.4959348266539422,-0.7927166872506863,-0.34916307507485056,-0.0576393800169277,-0.3276581899311224,-0.672201190669017,-0.9633868988167331,-0.9014026739987342,-0.5792656304994455,-0.7843387540490954,-0.9183789865116155,-0.19418749982643868,-0.8175503774621109,-0.21584655583714207,-0.31838281757149933,-0.2724563655130844,-0.26071492285417786,-0.38439839652949326,-0.3460069271668421},
{-0.7442681731190259,-0.6883624776286905,-0.8069197662541896,-0.443524039813015,-0.922978872394074,-0.20905319940652267,-0.8474849627718178,-0.8182110490596375,-0.16410810245220797,-0.29015611463188606,-0.545267461285568,-0.9803994573885452,-0.4320652732481336,-0.5138550541531965,-0.07262781315719147,-0.22477627576741985,-0.5799592354078158,-0.7550984485494758,-0.9575477703850078,-0.08023105322158308},
{-0.5121019330600804,-0.829837977437284,-0.6515381781494549,-0.8770101724616183,-0.9692391688042026,-0.9773585461575365,-0.5508999756692083,-0.05562963745882732,-0.05505320395600288,-0.3691254081441291,-0.9355819580135506,-0.5927223968981159,-0.7177926724824427,-0.012820505828129325,-0.2496550473516088,-0.7336038337677669,-0.4764051010160768,-0.22975519927884858,-0.06749464733049615,-0.665990299626176},
{-0.3020620497553642,-0.24078754070128638,-0.7563336289897499,-0.2564639107394453,-0.4943858119247263,-0.6499034006034536,-0.8582032214694034,-0.2819352636824236,-0.469343497447933,-0.16329570639734925,-0.25169370675715774,-0.11041519511945952,-0.8953779255538158,-0.9577264818167478,-0.27903273313991983,-0.3158438613832213,-0.7225140425492654,-0.6654804342509602,-0.5262279118648316,-0.10330250592309709},
{-0.5885276534745746,-0.9713260494722825,-0.2510937603138973,-0.5701735483630284,-0.5630234300874064,-0.6836549896789622,-0.05404418370857145,-0.27582355508336687,-0.1991112094752766,-0.38446840743193356,-0.03956320097941479,-0.48904113606700794,-0.8050785815386984,-0.38685711959498836,-0.1864783498365835,-0.5025518087893451,-0.48720183952491614,-0.7729803792611237,-0.916113804753467,-0.9691136680152954},
{-0.9702265438231047,-0.06384899566643876,-0.690466858330652,-0.19412370326534323,-0.37261142337375297,-0.6341574929307433,-0.4869764518054057,-0.8060451619530586,-0.8038688619065485,-0.4709826539348092,-0.30552167308187356,-0.5120615199490621,-0.30668073427693165,-0.44633548074188945,-0.7604238809870202,-0.9063213501743755,-0.7977344559073881,-0.4212703185281056,-0.022397069462690822,-0.1454663326982636},
{-0.020721359360428404,-0.7007302515452395,-0.6632453728340412,-0.08493938080866159,-0.9313393826649394,-0.07261213315773651,-0.5124539981295161,-0.8482910345230166,-0.9565471676886589,-0.14403449344807728,-0.961411078876793,-0.7082912407343239,-0.6994718991588886,-0.9167779045584838,-0.009652654177985442,-0.7091882233314855,-0.5696058153139574,-0.45267971794701806,-0.7369940652477959,-0.2819344685010434},
{-0.3725080983973198,-0.6665580441203421,-0.008387404983057567,-0.38242087854217754,-0.7119302229637122,-0.2924664311788606,-0.1619893320699888,-0.6554330598720953,-0.541233117655873,-0.22368531871739206,-0.9266962335322159,-0.29580117431611175,-0.8836965168033135,-0.34522729993709417,-0.19443787048177597,-0.691628752042716,-0.688397926685457,-0.7198839346950112,-0.08994882977678931,-0.16657691723422785}};

static param_t xstream_shift[20][20] = {{1.5893281706902467,0.14739108606157436,0.45826352511962753,0.8682312507559905,0.015439139057555229,0.34926058361114687,2.702552696215831,1.2337878473893849,0.7597130042385833,0.6398995504346667,1.390612396515822,2.063098974356448,0.5607049485415059,2.7297225024494325,0.4783363165799082,1.2865187405807046,0.040936968139491416,1.7897272369707753,0.7165430204236911,2.7540463156925648},
{0.8314377460728756,0.4441011197839503,3.014639144317804,0.0401758573300149,0.33079777594470194,0.2776538973641527,0.2952336362333187,1.3854401880293346,0.15090536511404473,0.13195528641389798,2.8576235404369634,2.8265118822705646,0.5502407872500239,1.656832323470283,1.3995513547254157,3.456452971817376,1.115304204744636,2.2596629706904836,0.4497191580380583,1.987902960266661},
{3.190269256990141,0.42442494879740256,2.627159763273964,1.362512882156414,0.6898121473126566,0.14693673800056728,1.93701478929867,0.4937092325923246,0.7920344946472928,0.9162877585004949,0.14825203386462518,4.241404645709187,0.7103286631558613,2.6380556131042265,0.1879223483226543,4.764391544886289,3.3139217919890687,2.1041437172836437,0.6015655562032757,3.0944559140699446},
{1.828030289829432,0.3095575875681019,2.93794736431755,0.20402208954453993,0.591790595024912,0.3610247217545338,0.2696796775055707,3.145515116478052,0.993283237268966,0.6155588807585715,1.2460975889197379,1.0344230861286998,0.8070900453786738,2.668902541213023,0.6258398748235918,3.780057819176255,0.8702191577826407,0.17041703722585558,0.4032509317026777,0.33672145674712584},
{2.575719462293268,0.322237511249427,2.726583591049254,0.831602352831664,0.17935054057052868,0.47920400192138535,1.4483625056391645,1.067560078425055,0.49662604044923286,0.3640484722108741,1.0923979229494492,4.082470394064489,0.42691893989422025,1.0797622593594387,1.9907706928399784,4.75367330956034,3.5051733997299053,2.523067064521714,0.5870109990453307,1.845323110430036},
{2.3171571392122625,0.43863006227094825,1.7754419892200064,0.4103315689592929,0.6993676099006677,0.9314837256399822,2.6663250489491146,2.646175386663541,0.2872605835633164,0.18069400014786097,1.0400734496127464,2.3893516955237164,0.2531261720361778,1.4444441683731415,1.2636872690576988,4.487110286913795,1.6983615312666231,1.3513132630262483,0.06097694843782464,4.185055891854403},
{1.4531854578447452,0.6183691685617629,0.9622281613104622,1.3585428463372646,0.5073707880899571,0.9083370088272675,1.5342193871571137,0.07480070245361778,0.9519557527197989,0.3657097256822194,2.6622895617545477,0.3372740036639217,0.9696859910373418,1.5203836359563665,1.5274810769269018,3.364550256382929,1.912397519812372,0.8880364159903269,0.23336777130356012,2.702136051499038},
{0.3825775386624002,0.3290860500127625,1.6912440785054095,1.7970319639668926,0.9170865430712531,0.48035230969024234,2.151072879114409,0.1869582774135953,0.04174014912746837,0.765694077080555,2.190931614338736,0.40255278134993727,0.012230391944299424,2.6713695890632625,1.7705839456174315,2.542188880659316,2.6541023610210503,1.2351054914078872,0.8329832145805985,0.5596986785009893},
{2.0087744028112082,0.4029282460876211,1.60292388109652,0.926941196394204,0.8571168675427594,0.13879924059374182,2.5310275482352282,0.9910804759958494,0.4441690113962915,0.9639060841242864,0.4100258828418811,4.326162224525488,0.33501026723538085,0.28739736328868215,1.3212404337637325,1.761633076019682,1.174835669918153,2.2059593500448766,0.23789476264602794,3.5114555004016337},
{2.2249072193896198,0.36976588131538535,2.337969777029844,1.972052425172467,0.6821384195239358,0.2241206819529611,3.307448152276863,2.1044358788401754,0.08645260043998293,0.10487438264786464,2.9674190498503266,3.5723878351161678,0.5427741105902024,3.1732012695506073,1.0039788001871275,2.5342163495969836,1.6539082109287149,0.7868926058222455,0.5581823727813731,2.392323054390019},
{0.8987953542848995,0.11595701631596833,2.289480546796239,1.9206332040103722,0.6813731358285894,0.7810308933723713,0.2950534690665895,0.6121486975849226,0.41489809445561643,0.7767217239256808,2.357165986386863,3.7384372310084837,0.8156317149292206,3.114311859482754,1.8276260794798114,3.619858264897575,1.4926251918452784,0.7520328544296702,0.9456647620438349,1.6081969092615802},
{0.6273227991473441,0.307395991994348,1.6784385951814174,0.2187620052552631,0.18586154043128078,0.18671827702857902,0.3401840386676723,2.0012176379779025,0.4481387611161396,0.9331661784645304,2.89616039213432,0.7604399221381736,0.27547554156814447,2.9692844618318652,1.7639674835408203,2.7190659453665003,3.2608300068887512,1.9122693196483564,0.14547192916924234,2.097680814485407},
{0.5417416889529173,0.4959348266539422,2.8570918779345074,0.7032619709762991,0.0576393800169277,0.3276581899311224,2.4227326018065867,3.466322748671215,0.9014026739987342,0.5792656304994455,2.822096988410482,4.479665040961266,0.19418749982643868,2.7420907095260034,0.4347443504841784,1.5530063279597424,0.9819811813206092,0.6668997548062435,0.38439839652949326,1.6877510900453616},
{2.6779206804277083,0.6883624776286905,2.9082822998282483,0.8933178009942951,0.922978872394074,0.20905319940652267,3.05448648016321,2.9439714989409396,0.16410810245220797,0.29015611463188606,1.9619044098334968,4.782188225062696,0.4320652732481336,1.7234866607370174,0.1462823038136995,1.0964127439560534,2.090276195349946,1.9315157133290681,0.9575477703850078,0.39135068375356685},
{1.8425728877825889,0.829837977437284,2.348259431009527,1.7664178903207457,0.9692391688042026,0.9773585461575365,1.985541456806831,0.20015870888498347,0.05505320395600288,0.3691254081441291,3.366278935588531,2.8911787392531716,0.7177926724824427,0.043000395928955035,0.5028392553451876,3.5783696015599773,1.7170486841147585,0.5877058527648004,0.06749464733049615,3.248564597701589},
{1.0868370286779836,0.24078754070128638,2.725960867418935,0.5165532332198862,0.4943858119247263,0.6499034006034536,3.093116990108295,1.0144196681056505,0.469343497447933,0.16329570639734925,0.9056087668425786,0.538582760311561,0.8953779255538158,3.2122459489396276,0.5620099142293811,1.5406218184661582,2.604069065103872,1.7022759325462444,0.5262279118648316,0.5038885157696704},
{2.1175571268061075,0.9713260494722825,0.904986554125613,1.1484071542627312,0.5630234300874064,0.6836549896789622,0.1947848465999682,0.9924293809466906,0.1991112094752766,0.38446840743193356,0.14235072506553254,2.385442734434396,0.8050785815386984,1.2975314339018453,0.3755927851831704,2.4513450352960646,1.7559620492525263,1.9772570735723034,0.916113804753467,4.727138450560522},
{3.4909321938562603,0.06384899566643876,2.488565315511786,0.39099156788654577,0.37261142337375297,0.6341574929307433,1.7551497118397328,2.900197921277494,0.8038688619065485,0.4709826539348092,1.099284956974748,2.4977314631842256,0.30668073427693165,1.4970238028308884,1.5315972263268032,4.420850354682646,2.875176808282244,1.0775949034980208,0.022397069462690822,0.7095550473127145},
{0.0745566702460503,0.7007302515452395,2.3904542420746706,0.1710794772562946,0.9313393826649394,0.07261213315773651,1.846975318444248,3.0522010565771027,0.9565471676886589,0.14403449344807728,3.459213632267925,3.4548999449439175,0.6994718991588886,3.074903081315061,0.0194417597018454,3.45927524276962,2.052960628597341,1.1579390607935356,0.7369940652477959,1.3752187287988928},
{1.3403060568135448,0.6665580441203421,0.030229698755493736,0.7702477151354169,0.7119302229637122,0.2924664311788606,0.5838383528601568,2.3582867158109675,0.541233117655873,0.22368531871739206,3.3343075760590355,1.442857686337552,0.8836965168033135,1.1579036569842756,0.3916243434336086,3.3736237298045326,2.4811085180271895,1.8414382049223137,0.08994882977678931,0.8125281650875739}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
