#define ENSEMBLE 140
#define DIM_MAX 9
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.977841397161868;
const static param_t delta_xstream = 0.14331079528501967;

static param_t xstream_fs[20][2] = {{3,3},
{4,12},
{6,9},
{9,5},
{8,2},
{8,4},
{17,6},
{9,8},
{11,9},
{4,18},
{1,16},
{10,9},
{10,13},
{19,16},
{13,1},
{5,19},
{1,16},
{13,13},
{2,4},
{18,5}};

static param_t xstream_R_T[9][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0},
{0.38729833462074165,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0},
{-0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0},
{-0.38729833462074165,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0,0.0,-0.38729833462074165},
{0.0,-0.38729833462074165,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.00012799231138014235,0.00012234015150303773,0.0005171735398040283,0.00827560544061414,0.00012223879263683805,0.0006619635681250126,0.000521772031417927,0.000684514553942633,0.00828888891644177,1.0,0.04034357652299393,0.0005218247569667769,1.0,0.00012424757699204138,0.026481937409965246,0.0005172253400383838,0.000521772031417927,0.0005172253400383838,0.007836081631173329,0.0005265067082935586};

static param_t xstream_shift_deltamax[20][20] = {{-0.6037135974082879,-0.20927377343151354,-0.7570206520339184,-0.798595977858774,-0.012172773155046723,-0.4030326890874141,-0.2605524885064906,-0.6061075361669581,-0.22825200029290138,-0.8468937290343305,-0.7450896952750931,-0.5825436016799979,-0.2829752155340667,-0.15409564437366297,-0.23156957415046345,-0.1885888836848729,-0.6628629724230994,-0.10348766426518063,-0.2867088282023511,-0.5183787104843055},
{-0.07000843880748409,-0.3137128435058272,-0.5740783367839429,-0.2814051919182352,-0.4492538161980266,-0.4490829814091057,-0.702957964596451,-0.01633909868615291,-0.5078289421898663,-0.6236444946132754,-0.09454040626241167,-0.6379057806425605,-0.5483941216441903,-0.01529910979846083,-0.036123780163638375,-0.08107402469694835,-0.24039662940226936,-0.44140369161282844,-0.9317951181298887,-0.09114872677637886},
{-0.7864206494567613,-0.8961918746379792,-0.923260890796588,-0.38125840453876914,-0.520575023751495,-0.501062860393885,-0.3358813542451763,-0.8089813115778904,-0.39656590716907897,-0.15458553535972464,-0.22103343434058376,-0.757019166562734,-0.799269018657152,-0.7556467692246117,-0.06377211824661988,-0.20358319303565786,-0.7858331071192289,-0.5940420111503577,-0.06380081396656356,-0.8318712876065296},
{-0.03858566600306412,-0.19949705939398688,-0.5486598952651934,-0.4518490061361946,-0.5139323067601791,-0.03377621124698438,-0.3234598818897907,-0.4640795357829145,-0.6171876881290624,-0.3422629940239119,-0.9865739147842965,-0.09326176971602373,-0.6744742289199708,-0.667657311259579,-0.32743746804356,-0.15293460179353802,-0.14357093682002486,-0.3043837135416477,-0.9261742600848784,-0.8673526124655483},
{-0.22395743401087076,-0.5449235098742956,-0.28060372521465804,-0.8708984064924644,-0.8551049173145029,-0.5680759044067141,-0.4321524172838536,-0.8292168423617753,-0.9401456355055655,-0.41897920672159605,-0.7095254977313098,-0.967444048006952,-0.3236884182394384,-0.04578301898880055,-0.03173807519353167,-0.7729872377074714,-0.9435501073937675,-0.4400461250422244,-0.5104108986903149,-0.23955269089721287},
{-0.23563421797763096,-0.6000748074612231,-0.8303877625081253,-0.10642144671508158,-0.2532006393928643,-0.05652398724134233,-0.4799966743597073,-0.9041426973634497,-0.47523000603552223,-0.3553488975545802,-0.532630825600712,-0.07929452933517611,-0.9087532465657886,-0.1450296060416626,-0.4840739053988055,-0.7728061218866591,-0.3335927346009721,-0.8080564507276616,-0.5424725964978817,-0.08962650265929939},
{-0.5982368212627591,-0.15017786447195802,-0.16574666869259977,-0.655562314638067,-0.9016806399689801,-0.7785529086109627,-0.8877202074986131,-0.23948491983501727,-0.3386249749452678,-0.6193820387253796,-0.6596966033268648,-0.1253745783843273,-0.6732813193556534,-0.602421823984853,-0.3298145157968013,-0.3637309320640306,-0.9874091329536213,-0.6805903677324499,-0.2673559369758972,-0.2903968234603196},
{-0.9781050859440278,-0.12786888501244276,-0.7144478065875305,-0.47938987461753424,-0.2742820975121695,-0.2666262342752267,-0.24691671280023497,-0.339394266245615,-0.1597043973692579,-0.5724827233086894,-0.3198801337586472,-0.09519939558676171,-0.5716594656942692,-0.35075914492616855,-0.47574655466642163,-0.579212773993852,-0.9989567229188706,-0.8153376106620602,-0.3275352113189187,-0.09997012172683095},
{-0.25653858307930333,-0.5388578606534826,-0.5266646939050174,-0.8345047731758831,-0.43708521522482047,-0.26057953840809056,-0.017392161825375507,-0.275076155848776,-0.3900583596438746,-0.30432661295859886,-0.874471694354325,-0.5855953889321122,-0.22757136036539183,-0.512622861186044,-0.3770978943785198,-0.10193894507073531,-0.9053269019994914,-0.23048249429710488,-0.9754816492829181,-0.5928311483864575},
{-0.3523667279144196,-0.3231058915861855,-0.9490444499109288,-0.9411034869148737,-0.6617931740463696,-0.2879083652796366,-0.4447333636023657,-0.3194163069692446,-0.19180711590815736,-0.9606885219641784,-0.4886111403957987,-0.8852561319632406,-0.5163484270186561,-0.01920919001623045,-0.8620432303469969,-0.953321489458079,-0.09302300478885828,-0.1209233281990657,-0.13535405092679076,-0.606826736460939},
{-0.5723681434616036,-0.40109931224718964,-0.48093126672536235,-0.8344553589040381,-0.6784880741364221,-0.5367587345747243,-0.8155854263676544,-0.23725573000083777,-0.738826357963047,-0.7405612210610072,-0.6969431309457789,-0.5326881515417078,-0.7797735807459231,-0.7299017193532297,-0.13470633290198641,-0.21730083445864634,-0.785862170829064,-0.38166658048974,-0.48465486682486036,-0.3426322400926157},
{-0.37603968575890934,-0.7886151659783255,-0.30973195792622277,-0.12103784759635372,-0.3567858294822923,-0.17203613208938284,-0.7345168086718373,-0.24967858044366087,-0.9857383557427095,-0.41993915321049624,-0.9384481841295932,-0.7465012456284282,-0.45756820812906795,-0.23523954194092012,-0.9050355551836364,-0.6529170053928448,-0.8122130333844021,-0.3698189331123146,-0.48812965715299295,-0.24712841342512193},
{-0.28276032480457725,-0.6109578863603428,-0.22929170787308528,-0.3622897866995657,-0.4949146406673598,-0.7691223953655334,-0.6631034730924783,-0.21371558605905386,-0.21467118159992227,-0.4990316571997696,-0.2798951815658156,-0.5405391346899077,-0.5235312841947031,-0.4145521898705894,-0.26964245938316955,-0.6505336444644946,-0.0858754246793626,-0.9538734107615713,-0.08896481145690138,-0.8683189659288678},
{-0.8753398062927892,-0.6391149884786468,-0.7252908595663259,-0.25003776624810015,-0.570235053662785,-0.813407331463068,-0.0905355052403739,-0.36568104480665564,-0.5758469289409893,-0.487561007857526,-0.6302573274457522,-0.7250210860444377,-0.3125555939491521,-0.0010491507267441635,-0.1506593237022934,-0.8682218254949164,-0.21248188694409897,-0.7887462861348299,-0.22612619553453106,-0.5705155054026594},
{-0.44265112216983493,-0.1801071938542932,-0.664131548701101,-0.3601367973728873,-0.7785462447990833,-0.22631534024018166,-0.7688457303112731,-0.7281313344873334,-0.26215545154899145,-0.46900010286007576,-0.019899056607495358,-0.0748666690620905,-0.7436858842288865,-0.22708485939980483,-0.9601159222639918,-0.6826360360781822,-0.6033003994429724,-0.11797916003250719,-0.8373489498120978,-0.30573952940686555},
{-0.11219582055769195,-0.3218165306366957,-0.3627368537568253,-0.4668853327300092,-0.6196990751658515,-0.5541126695929919,-0.32354454853320835,-0.4217618690970111,-0.5690195574021296,-0.024723852233909716,-0.4445382798891354,-0.9358724896640741,-0.006938191988820841,-0.32176986147609066,-0.5339014098616275,-0.3674514920284111,-0.8166280842982697,-0.9362458067675077,-0.556110949240218,-0.5098105918918745},
{-0.028322550104384447,-0.5478278998542563,-0.945762687653947,-0.52344639250241,-0.3308016669045434,-0.11059937262919417,-0.5783539818436869,-0.6539784222660585,-0.3808370635698688,-0.011448163761066277,-0.8897337811894156,-0.09153977033023275,-0.21659971354689123,-0.6421394013785319,-0.6912829135865091,-0.924783068097587,-0.4534897739425785,-0.5202318054494497,-0.35345860599312584,-0.8453468054154376},
{-0.3435674643043185,-0.09334957395226529,-0.6732351392392429,-0.22223754893721903,-0.5983613056435865,-0.3430610937848968,-0.10543043816429143,-0.7748826901743707,-0.7032206747067133,-0.04063277873229487,-0.8651574311146243,-0.5107880404507118,-0.5011250543942534,-0.5032939072109094,-0.5027229340220494,-0.8414598844016143,-0.9946675825424716,-0.736535359087371,-0.7293569981882291,-0.41635868591046543},
{-0.3020237989998329,-0.9759140336209491,-0.8454752661694588,-0.6957303586450633,-0.5624174598709,-0.7045980478318747,-0.2538775804058361,-0.6436391301755099,-0.36948019488064376,-0.9226535065411668,-0.1254286183173714,-0.9239389905217452,-0.03080304710413717,-0.0296826172619874,-0.8415782662087888,-0.8302584103301707,-0.2601245351619994,-0.7830850454395154,-0.29915431138159687,-0.7900986635946102},
{-0.23655787084995095,-0.1275466720336813,-0.48219340856866605,-0.1017033696969818,-0.036950139438303053,-0.46138945632748896,-0.4163167847794833,-0.2377640617871366,-0.597174784645866,-0.9270192591041876,-0.11531600007440514,-0.04095958426037771,-0.8456866057586957,-0.9521443461387988,-0.5123384876779555,-0.89505373852954,-0.9997709717883178,-0.740254554624305,-0.7420541879663841,-0.10356319793387525}};

static param_t xstream_shift[20][20] = {{4716.79580514203,1710.5894578389273,1463.765242747676,96.50000638497205,99.58191579338555,608.8442151416116,499.3607798379562,885.4560252604273,27.537104501442002,0.8468937290343305,18.46860787987964,1116.3586892008784,0.2829752155340667,1240.2305791728518,8.744434765687611,364.61648161104705,1270.407251653092,200.08235531828493,36.5882901298236,984.5624040848473},
{546.9737834451336,2564.2672471109177,1110.0303720129948,34.00418180127156,3675.2147702630277,678.4104186898331,1347.2511408596342,23.869614739443858,61.266226065901435,0.6236444946132754,2.343381881587224,1222.452120421673,0.5483941216441903,123.13406964419765,1.3640912900143352,156.74797505267583,460.73115254757187,853.4069339682226,118.9108488128865,173.1197824084666},
{6144.2803944766665,7325.410861664059,1785.20519658921,46.0701524830642,4258.672819994901,756.934194752027,643.732001756421,1181.8321566990212,47.84307175144478,0.15458553535972464,5.4787763849991125,1450.7153147793856,0.799269018657152,6081.782739900146,2.4081364312349067,393.6063786444604,1506.0851479212295,1148.5168362135414,8.141928194411932,1579.982314570458},
{301.468624068075,1630.6752684463802,1060.8816055691793,54.60011468389465,4204.330684834495,51.024275161628985,619.9256809737029,677.9688366155726,74.45964041149281,0.3422629940239119,24.454299787278305,178.722393813066,0.6744742289199708,5373.604278032283,12.364558641406052,295.6827323699736,275.16027723806445,588.4934282590624,118.1935441305757,1647.3723863399437},
{1749.7725573976716,4454.167361896433,542.5716971540862,105.2368207670174,6995.364555464427,858.1679291139361,828.2399041387288,1211.3940274690922,113.42239532740034,0.41897920672159605,17.587074793106503,1853.963490790351,0.3236884182394384,368.4821877189055,1.198480107485962,1494.4883358771774,1808.3570037850618,850.7822238747393,65.13598539604403,454.98506880115207},
{1841.0029121029606,4904.97028235512,1605.626929062888,12.8596569131725,2071.3607679773454,85.38836570937649,919.9356145159904,1320.8524086972488,57.33337855365151,0.3553488975545802,13.20237003026089,151.9562425441317,0.9087532465657886,1167.263052952352,18.279399195945793,1494.1381677651534,639.3457573692222,1562.2909168906826,69.2275325897358,170.22860534822914},
{4674.005921230468,1227.5435548093878,320.4855932022467,79.2162361222259,7376.386992366681,1176.1265213071847,1701.3564431313307,349.8609612544305,40.85287887904664,0.6193820387253796,16.3519613327011,240.26184405871257,0.6732813193556534,4848.559936291079,12.454319738430126,703.2349421183383,1892.4148354029544,1315.848847780626,34.11857476220101,551.5538907405643},
{7641.905012864531,1045.1914881703228,1381.4469449814756,57.92807282290615,2243.822043686576,402.78082830213094,473.22719105743056,495.8174582129609,19.267286481843133,0.5724827233086894,7.928898757310985,182.43556733515194,0.5716594656942692,2823.066279583354,17.96494521157642,1119.8460886523233,1914.5463205534106,1576.3682626252482,41.798340897308336,189.87435516413532},
{2004.3280749682954,4404.58716155916,1018.3519715733822,100.83912037183273,3575.66698587548,393.6463439312415,33.33287485362511,401.8558177680898,47.05797888908345,0.30432661295859886,21.67561157737013,1122.206988292423,0.22757136036539183,4125.817771230098,14.239815181974432,197.0880720251841,1735.1004796850564,445.6133071129125,124.48589680361144,1125.9707408246716},
{2753.0304290534777,2641.045377307406,1835.0599496458162,113.72019771462588,5413.937423388218,434.93083176031337,852.3518640771009,466.63187090688785,23.140268598326898,0.9606885219641784,12.11124998095579,1696.4625003784604,0.5163484270186561,154.60414183739684,32.552120979736436,1843.1453675245923,178.2828499566491,233.79235091245118,17.27318030842459,1152.5527156675794},
{4471.894735627104,3278.55824371143,929.9224142588594,100.8331492954928,5550.513544028183,810.8584224583138,1563.1068306809836,346.6043616374612,89.13454691104826,0.7405612210610072,17.2751944922026,1020.8180896553795,0.7797735807459231,5874.57507843379,5.086724993591139,420.1279744772757,1506.140849852504,737.9116043723152,61.84913450835134,650.7651938625975},
{2937.986522034564,6446.086229987576,598.8936673821112,14.625860121645843,2918.7610723731154,259.8876137196928,1407.735111205121,364.75277115084634,118.92285753611769,0.41993915321049624,23.261402805840035,1430.5592742813387,0.45756820812906795,1893.3129131040382,34.17557942128012,1262.3453548203793,1556.6434850430662,715.0054424728495,62.29256918548759,469.3737221812058},
{2209.1977381732536,4993.927822176782,443.3554507834457,43.778040084119795,4048.7526912811772,1161.8802490053104,1270.8681822030208,312.21481680426723,25.898667935349252,0.4990316571997696,6.937788012083872,1035.8633381672275,0.5235312841947031,3336.501201123169,10.182127357558898,1257.7373808023751,164.58418525422732,1844.2124484674,11.353226732986487,1649.207792134585},
{6839.003037401165,5224.08204196786,1402.4129305632284,30.213833663575993,4664.927077256964,1228.7796045438183,173.51544312243354,534.2195322223963,69.47214937321023,0.487561007857526,15.622247251344595,1389.3957240717843,0.3125555939491521,8.444033695814982,5.689135253586082,1678.614248541042,407.2312698836593,1524.9567743071063,28.857049502261535,1083.5863938974985},
{3458.419630028738,1472.1838385971025,1284.1560860842942,43.51787913974802,6369.060328598661,341.8848878363676,1473.5280620962337,1063.7192887915658,31.627333191663613,0.46900010286007576,0.4932397750148363,143.47090294693905,0.7436858842288865,1827.6803853836977,36.25550152923089,1319.803929226521,1156.252852042472,228.10011594511562,106.85811981347598,580.6944614206087},
{876.5825020884718,2630.5062294181066,701.3832414826878,56.41706048945722,5069.577846755485,837.0742685469769,620.0879484742962,616.1474093834353,68.64847184445037,0.024723852233909716,11.018811870478801,1793.461266774774,0.006938191988820841,2589.7475771032664,20.16096487187975,710.4282477752196,1565.1051323679903,1810.1313572494882,70.9679882644292,968.288881910361},
{221.28321458517402,4477.907646212565,1828.7143770199905,63.251733816778554,2706.1921978183263,167.07773351101906,1108.4418999462223,955.3900914148663,45.94549009028745,0.011448163761066277,22.053914349470464,175.42243657109745,0.21659971354689123,5168.224740669702,26.10394031542333,1787.9693752609994,869.1339256153882,1005.812680041629,45.1065497565779,1605.5765142200369},
{2684.282052567277,763.0330092402035,1301.7586698158432,26.854536569197116,4895.01976202654,518.2476956497843,202.06226439117847,1132.0178449256337,84.83895511156034,0.04063277873229487,21.444738064348993,978.8497644684044,0.5011250543942534,4050.734182471403,18.98361612443329,1626.8728912995036,1906.3259865413647,1424.012518475433,93.0767483695827,790.7946458268502},
{2359.7026707550426,7977.054316437698,1634.7999290331697,84.07002528547719,4600.973616794454,1064.406081784263,486.56801269304947,940.2855300421433,44.57535848354126,0.9226535065411668,3.1090108792383098,1770.592479920553,0.03080304710413717,238.89896270483172,31.77933144317832,1605.2160365316913,498.54058764917943,1514.0113695539394,38.176517992297036,1500.643108908089},
{1848.219383642229,1042.5577414011482,932.3628752379379,12.289538261195098,302.27834095252433,697.0012830681264,797.8901890316606,347.3469781141613,72.0452150663179,0.9270192591041876,2.8583484661723153,78.49298775792943,0.8456866057586957,7663.28301275274,19.3467146963787,1730.4908890641693,1916.1068658115273,1431.2031861574494,94.69709771965115,196.69872444651293}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
