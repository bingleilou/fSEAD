#define ENSEMBLE 140
#define DIM_MAX 9
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.977841397161868;
const static param_t delta_xstream = 0.14331079528501967;

static param_t xstream_fs[20][2] = {{12,3},
{9,5},
{5,11},
{11,15},
{19,12},
{4,8},
{19,6},
{14,16},
{15,3},
{10,17},
{7,5},
{6,0},
{10,0},
{4,19},
{2,12},
{16,2},
{6,14},
{3,17},
{11,15},
{18,8}};

static param_t xstream_R_T[9][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0},
{0.38729833462074165,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0},
{-0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0},
{-0.38729833462074165,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0,0.0,-0.38729833462074165},
{0.0,-0.38729833462074165,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.00012799231138014235,0.00012234015150303773,0.0005171735398040283,0.00827560544061414,0.00012223879263683805,0.0006619635681250126,0.000521772031417927,0.000684514553942633,0.00828888891644177,1.0,0.04034357652299393,0.0005218247569667769,1.0,0.00012424757699204138,0.026481937409965246,0.0005172253400383838,0.000521772031417927,0.0005172253400383838,0.007836081631173329,0.0005265067082935586};

static param_t xstream_shift_deltamax[20][20] = {{-0.5718204965355845,-0.5691925380646468,-0.707897112204857,-0.8374613774724503,-0.8873815788743111,-0.9562273178413668,-0.3753588463771592,-0.8832271554323718,-0.781487450398421,-0.9627422863760281,-0.5049971405405841,-0.20855419560067523,-0.6796549594989884,-0.17431278038640352,-0.7495957283907261,-0.17625523671219878,-0.5438722563466007,-0.9663652761455618,-0.6067777234144468,-0.05552456144743245},
{-0.3316655001849419,-0.16246725240901738,-0.8483415109714284,-0.34486012642754404,-0.823197710571789,-0.7938372980595025,-0.895344445452962,-0.35080149908772856,-0.47238875489969323,-0.7818926842043938,-0.6241854233850046,-0.44046532821765105,-0.9680010148838326,-0.6067873431199797,-0.5532639060616322,-0.012584714084603155,-0.8659826630742511,-0.9920284596319268,-0.34145274051763186,-0.07782392708558639},
{-0.05785646586337301,-0.7368591401641473,-0.12922757991734002,-0.581658452292161,-0.4007240117962536,-0.4327421518127733,-0.13412619988156535,-0.4718188388834283,-0.6331722212293293,-0.015121139686548046,-0.5829986578369027,-0.6144662474750309,-0.7379732148155349,-0.8073809151993375,-0.8687005074715967,-0.7779771197768666,-0.6538354748854217,-0.8475868886191006,-0.5040700416787417,-0.214465897627948},
{-0.9836497866000296,-0.31265337457602826,-0.5007089895770842,-0.24395944977780049,-0.4725261090534312,-0.9058915259127747,-0.39929824623647725,-0.711600592859771,-0.08774347914906933,-0.5558337773713613,-0.8171445956652255,-0.8391750322682967,-0.7781646867391766,-0.4366798565814757,-0.5671220157386861,-0.12688087728257602,-0.6836070048515537,-0.06142276249747858,-0.7508069048567085,-0.1630491759056456},
{-0.9597501362869285,-0.6666204642974056,-0.6744639496545981,-0.6608387738294054,-0.7182915805416671,-0.9633254467742763,-0.28178151369727994,-0.6872586458623365,-0.3479183088326061,-0.04560666980285644,-0.29345100784482925,-0.8041098758069324,-0.4989676914132555,-0.985312320499848,-0.5898579046189392,-0.4504921422010363,-0.3661923766891515,-0.7238848329086337,-0.010209506504601729,-0.8667224175125242},
{-0.666984146743848,-0.8756941895615998,-0.060767668913440875,-0.46783092699099216,-0.394612583575201,-0.018395730655593745,-0.02921382313522214,-0.919621084094517,-0.18760505665241856,-0.8354003028991542,-0.7918293864260136,-0.2785843804884014,-0.7461892565528243,-0.07591147545869681,-0.5283317684071702,-0.0730190812318312,-0.4755875933384377,-0.2666974308760143,-0.037841335805928966,-0.5979491918884321},
{-0.5791838229407683,-0.35271862672654464,-0.9032794972795836,-0.6187624338025606,-0.2631023485812405,-0.25474283166459233,-0.7544863586143337,-0.5718942261860211,-0.5134440128590404,-0.8102526101200563,-0.3666313364026308,-0.4624007665211357,-0.5382402361591653,-0.45859801021054913,-0.2864343369136927,-0.885927835722907,-0.22747077389492576,-0.34245135794285475,-0.11131766114429087,-0.7236469858336928},
{-0.860221070813002,-0.8318947695392901,-0.5749646737509281,-0.8056115974911742,-0.31187377149829365,-0.7028470903012699,-0.9103885519003991,-0.8847236192333184,-0.10783972413289711,-0.6325085986725932,-0.47950477879602793,-0.3061811036714218,-0.6606653434676396,-0.026379540167836057,-0.2619684430234088,-0.23646711053359448,-0.810733249756817,-0.21760355899715134,-0.6217329556915552,-0.3008049143899131},
{-0.639826929684127,-0.2080483116736409,-0.6291693592621161,-0.07684222831775245,-0.27814594533696846,-0.1944559627639657,-0.16944473306096608,-0.9098961878936275,-0.15072917926383567,-0.520389162320562,-0.7134805971882133,-0.060331061412114084,-0.6519904923317374,-0.9531287299960719,-0.0614674109037996,-0.8999928594494288,-0.10888883257700332,-0.048630079294217254,-0.4200801215698864,-0.7134049288129691},
{-0.3089054897551814,-0.2921248716374497,-0.2726815938408178,-0.9782823500209882,-0.24849308954046812,-0.04750710759231069,-0.21341124849717452,-0.9430929397593493,-0.20950130916703635,-0.7792247880477536,-0.8960437332028626,-0.4266279446114031,-0.04988722313692173,-0.25015351086548543,-0.8730557799232038,-0.8706116418166664,-0.6209385278587842,-0.7389078886148868,-0.2665356117083021,-0.5554331519128912},
{-0.4594914836709,-0.7255315580994564,-0.04976545021304157,-0.1025200247132797,-0.9002938825275897,-0.8424878377715816,-0.18687992012661916,-0.7478122711011745,-0.14614551989242985,-0.561372772019305,-0.6052142382143182,-0.7211237303266153,-0.26053962599136404,-0.9640516728633409,-0.262995666901522,-0.9647072917280334,-0.5815080977263709,-0.47566543168704556,-0.6302657963596205,-0.3967116083071261},
{-0.42624336833852217,-0.3419547348773605,-0.6188026232675025,-0.2297367164949088,-0.19347793178516814,-0.2833622896614968,-0.22581520819212286,-0.38119888139049884,-0.6546144373228407,-0.7065274170142024,-0.9735369092542447,-0.595251672507653,-0.4968369465732143,-0.7534517233231643,-0.26295685015413794,-0.11296142029746759,-0.6545730415773092,-0.04047656672537103,-0.09507799881173418,-0.2979817825539569},
{-0.2569748402542752,-0.7182307694364229,-0.06535154010734667,-0.4533072098678871,-0.63820809243434,-0.2371885629443523,-0.8815746455073488,-0.6490055777456383,-0.37159068777953996,-0.2188842792786977,-0.9239836597388554,-0.975674913752823,-0.3854830252041296,-0.8717580248154847,-0.23327908095727945,-0.671228375341975,-0.9011398505169655,-0.21229083039603724,-0.5045773683517667,-0.0007624733352270541},
{-0.7967515870860842,-0.780585172260883,-0.234562910390396,-0.9087528152546311,-0.8496623364285092,-0.7646060002659456,-0.9721728974690146,-0.32209188583284554,-0.818802758137514,-0.2643992501066199,-0.8485670671058391,-0.4732424682102916,-0.8869770434847648,-0.17634880928632657,-0.6883088643967701,-0.8666551510665256,-0.5354775954049583,-0.03690395563262372,-0.7191239536025895,-0.8755110279078239},
{-0.791066656430323,-0.6091342080123113,-0.8095625030916418,-0.521796665017604,-0.8813081564778036,-0.9292940543411159,-0.08337676253762549,-0.4072422348475514,-0.9019079155693295,-0.08747729020558892,-0.7642238399672866,-0.4548965832013534,-0.8427915415948685,-0.09830358737066858,-0.011017610691909985,-0.7047211757523377,-0.7979181583788929,-0.4611558397224196,-0.5691133628683326,-0.4714475331014729},
{-0.7925699571723356,-0.7127909847210915,-0.27182944870906267,-0.617269789178659,-0.4065475578402762,-0.6428439719763659,-0.35262661421004926,-0.6586284289387777,-0.008534994787342876,-0.9334040366784396,-0.6876068947725015,-0.43366172117913493,-0.8723211885113162,-0.7081313308282507,-0.44924989422908346,-0.3090984971281714,-0.10010502507124963,-0.9767585908858011,-0.9402227538788723,-0.6453966815247573},
{-0.09273186260444677,-0.3926316691967795,-0.7691163152202996,-0.9077467726444767,-0.16274114336393786,-0.18129760091852606,-0.4852701968804697,-0.6916374252875818,-0.652657087890205,-0.5566656836968461,-0.021865819317521854,-0.8752553634203716,-0.09451798828403868,-0.34243803833055053,-0.9483850143626762,-0.31105847979755075,-0.38003756724728766,-0.5831214518847798,-0.11818699795864385,-0.6855176616650295},
{-0.7439890427216115,-0.67718185093994,-0.7772825605801775,-0.3556636272500816,-0.9089254346388728,-0.45792712134522756,-0.9202070983349606,-0.1069946938470141,-0.4027985810274485,-0.3424197302087907,-0.14199062239327886,-0.13431005726927603,-0.1182553112972411,-0.3656273578176563,-0.885754766512702,-0.5447401546962454,-0.9722404144962856,-0.89358565628757,-0.6008336375351864,-0.9817106421380317},
{-0.6003059904384654,-0.17740564706529394,-0.24675430486009875,-0.9623247228027428,-0.5854292447203254,-0.19776017345314734,-0.44349899111523006,-0.3268759586929655,-0.4448684792488459,-0.9121356246588429,-0.5770386817087505,-0.849914390376714,-0.6036921530068636,-0.3442115484169994,-0.12247696705935118,-0.5377338966673091,-0.12969698005891228,-0.8245818494835655,-0.253119678139357,-0.329238840790522},
{-0.7176784998289172,-0.32095027007987387,-0.562425293597122,-0.19679157985631301,-0.1742282398548416,-0.9522647811682666,-0.791880743692652,-0.17712423423427723,-0.29402953674761734,-0.298875497388164,-0.8445411700042494,-0.20911860839402674,-0.5493594675436725,-0.2504131433447908,-0.18029572708273633,-0.20775939382180375,-0.5384215600754917,-0.30026119739208035,-0.004621749532889297,-0.2880314611943956}};

static param_t xstream_shift[20][20] = {{4467.61598700452,4652.540732308261,1368.7806079040686,101.19638780293295,7259.41053353376,1444.5316387272571,719.3924238467005,1290.297116905994,94.28132748265804,0.9627422863760281,12.517411297254709,399.6632831545655,0.6796549594989884,1402.9471206313267,28.305924781343624,340.77069135692136,1042.3560934621505,1868.364137135754,77.43381858103379,105.45841215849092},
{2591.292372241657,1327.9961681671064,1640.3420625364727,41.6718908244557,6734.340979769372,1199.21599357502,1715.9686444285712,512.4821628221043,56.99060026762657,0.7818926842043938,15.471742398179508,844.0866830043756,0.9680010148838326,4883.6955843319765,20.89212346878507,24.331201722771805,1659.6954434696781,1917.9811637966295,43.57442361999804,147.8118433434944},
{452.0307918460584,6023.036027921307,249.87276024660503,70.2859091659396,3278.2065590812363,653.7250275547633,257.05900624277325,689.2751018453437,76.38806933138821,0.015121139686548046,14.450842193047041,1177.5337204136374,0.7379732148155349,6498.162255921127,32.803510333224395,1504.1357403702073,1253.105639082665,1638.7188001195,64.32679818870969,407.3374455627459},
{7685.225588891429,2555.6072208089836,968.1643607807487,29.47934764754759,3865.5986275753685,1368.4915145386005,765.2733803139572,1039.5697049261103,10.585674392984336,0.5558337773713613,20.254639426910792,1608.1548854565456,0.7781646867391766,3514.5945470586285,21.41542769167924,245.31063631406784,1310.1641400629248,118.75435664640936,95.81407394607338,309.68109871590855},
{7498.498354611565,5448.909913119188,1304.1346815812958,79.8538280457658,5876.134450015844,1455.2544779811071,540.047179093775,1004.0088145736249,41.9740585668217,0.04560666980285644,7.273797544389156,1540.9576971414715,0.4989676914132555,7930.233686271095,22.273970951875054,870.9784833194848,701.8244647840086,1399.5540760916965,1.302884143522254,1646.1754501127366},
{5211.126664967227,7157.864190971319,117.49957071753411,56.53132333919898,3228.2107427841206,27.789642121391925,55.989630290901054,1343.4646185354704,22.633317751464464,0.8354003028991542,19.62714897065976,533.86577920859,0.7461892565528243,610.9694635216854,19.950646368054517,141.1746014346714,911.4854087637046,515.6310223629462,4.829114548193244,1135.691497315244},
{4525.145430185794,2883.097841494716,1746.5694351297664,74.76944596293389,2152.3637701731654,384.8290811322774,1446.0076684524474,835.4741661693724,61.94364745805402,0.8102526101200563,9.087725184545011,886.1227075712998,0.5382402361591653,3691.0016381238925,10.816215312324786,1712.8469298452421,435.95815834890374,662.0931563744366,14.205781203382235,1374.4307041767393},
{6720.880821177693,6799.850738444066,1111.7441815928912,97.34775337855994,2551.3485921351203,1061.760985263975,1744.8013635886123,1292.483284887854,13.010154342759636,0.6325085986725932,11.88552974530488,586.7508192811089,0.6606653434676396,212.31432279380218,9.892344316350101,457.18392396638194,1553.8074119335827,420.7132600676579,79.34232757583723,571.3220926754014},
{4998.9481616893,1700.5726175553657,1216.5536533453087,9.285390521475842,2275.4310586437027,293.75629132393954,324.7485929832159,1329.2576215550898,18.184485373528236,0.520389162320562,17.685110212813264,115.61555983430507,0.6519904923317374,7671.2057737522255,2.321107022957814,1740.0401522915322,208.69043570828342,94.02106882583976,53.60844122638193,1354.9778522768672},
{2413.4691093882943,2387.808647026207,527.253567427569,118.21278298502217,2032.8496721881227,71.76695195911283,409.01243387313184,1377.754401754308,25.27495678600196,0.7792247880477536,22.210319719476534,817.5693830458974,0.04988722313692173,2013.3471969558725,32.96797233553878,1683.2347033733063,1190.0571331341202,1428.599551135781,34.01388911621032,1054.9403135110756},
{3589.992857509946,5930.4451497384425,96.22582437589345,12.388220469059917,7365.042333183811,1272.7102794461896,358.1639276807706,1092.4709588626897,17.631496979352303,0.561372772019305,15.00150185914664,1381.9270180248027,0.26053962599136404,7759.118497136511,9.9311339208345,1865.1586011939044,1114.4869075218728,919.648352209012,80.43124434185461,753.4787345690113},
{3330.2263529921115,2795.1145284372947,1196.508668061371,27.760714082311278,1582.7866719853496,428.06327010428987,432.7851908398867,556.8893739291422,78.97493185417808,0.7065274170142024,24.131150313343557,1140.7118281771193,0.4968369465732143,6064.116029976395,9.92966813882682,218.39885162835336,1254.5192194347646,78.25712236443641,12.133359922323546,565.9600872318125},
{2007.7365388851329,5870.769004390101,126.36288417251627,54.7763197654632,5220.994732256614,358.31059950350465,1689.5781920538177,948.1253159739675,44.82997558845985,0.2188842792786977,22.90286928855275,1869.7367281386798,0.3854830252041296,7016.297990835868,8.80898845676962,1297.7484345453038,1727.0758037146954,410.4416662576566,64.39154058126041,1.4481740179498912},
{6224.995693059248,6380.449612582839,453.5477791057882,109.81103700216909,6950.840384629698,1155.0575244369775,1863.2138921419637,470.5405954886959,98.78317424586832,0.2643992501066199,21.03351116186231,906.8992260181739,0.8869770434847648,1419.3339906952272,25.991635496342386,1675.5852507191746,1026.2673412175548,71.34986006270506,91.77086041852682,1662.867754801093},
{6180.579504348688,4979.021200551532,1565.3594795248184,63.05238556405621,7209.725631830328,1403.844711534967,159.79538479869706,594.9358308043821,108.8092655917143,0.08747729020558892,18.94288771179509,871.7420496596244,0.8427915415948685,791.1911825609716,0.41604247156645036,1362.50319000233,1529.2467022629266,891.5956045158127,72.6272886954493,895.4255010908864},
{6192.324746901169,5826.304577556393,525.6058707335771,74.58907914450437,3325.84729504076,971.1168452928575,675.8250595605492,962.1832364925514,1.02969105671243,0.9334040366784396,17.04377633402428,831.0485759623417,0.8723211885113162,5699.357266931732,16.964389246688164,597.6089591922022,191.85586624720383,1888.4585020782526,119.98633987406394,1225.8090378687264},
{724.5111960594992,3209.3443107026915,1487.1532590622085,109.68946975039835,1331.3379480720916,273.8785178647291,930.0425620011431,1010.4057266626734,78.73879050250028,0.5566656836968461,0.5419901060348323,1677.2975059826392,0.09451798828403868,2756.094296732123,35.81252382258843,601.398376526693,728.3594067212211,1127.4031002454478,15.082410255716955,1302.0112581031215},
{5812.763553522633,5535.237962518997,1502.943404402924,42.97735432196819,7435.654549854887,691.7708819569772,1763.6190576069737,156.30740534405203,48.59500291148318,0.3424197302087907,3.5195348214194873,257.3853683178684,0.1182553112972411,2942.7322984421376,33.44750623039345,1053.1969579367858,1863.3432916176073,1727.6525087136222,76.67526524289426,1864.573853806759},
{4690.172276485674,1450.1015805991453,477.120900179079,116.28450990183117,4789.226333898685,298.7478208404969,849.9861326602958,477.5295964274851,53.670459784592914,0.9121356246588429,14.303111708003026,1628.7352775614397,0.6036921530068636,2770.368298120194,4.624924723719899,1039.651105700667,248.57020355510028,1594.2410119008719,32.30181742012511,625.3269627990227},
{5607.200089522433,2623.4254750935515,1087.4981999470444,23.77971995746923,1425.31054255796,1438.5456043533052,1517.675720449597,258.7589017853395,35.4727321974822,0.298875497388164,20.9337208743231,400.7448968300689,0.5493594675436725,2015.4368351250096,6.808252896742004,401.68061720716497,1031.909584368329,580.522983212303,0.5898036481017699,547.0613320919}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
