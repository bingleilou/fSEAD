#define ENSEMBLE 140
#define DIM_MAX 9
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.977841397161868;
const static param_t delta_xstream = 0.14331079528501967;

static param_t xstream_fs[20][2] = {{2,11},
{8,10},
{19,15},
{10,12},
{14,6},
{12,9},
{19,2},
{7,4},
{19,4},
{15,5},
{8,19},
{9,18},
{1,15},
{18,17},
{9,14},
{12,15},
{5,14},
{13,17},
{8,16},
{7,16}};

static param_t xstream_R_T[9][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0},
{0.38729833462074165,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0},
{-0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0},
{-0.38729833462074165,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0,0.0,-0.38729833462074165},
{0.0,-0.38729833462074165,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.00012799231138014235,0.00012234015150303773,0.0005171735398040283,0.00827560544061414,0.00012223879263683805,0.0006619635681250126,0.000521772031417927,0.000684514553942633,0.00828888891644177,1.0,0.04034357652299393,0.0005218247569667769,1.0,0.00012424757699204138,0.026481937409965246,0.0005172253400383838,0.000521772031417927,0.0005172253400383838,0.007836081631173329,0.0005265067082935586};

static param_t xstream_shift_deltamax[20][20] = {{-0.67298750311442,-0.2849660547382209,-0.04688705225001066,-0.26386851214842755,-0.21882717141235586,-0.9046947166598437,-0.3133987655390721,-0.10140769780980341,-0.27112639893084334,-0.8571317114350174,-0.6740880330429914,-0.16059107910863912,-0.9063583956097752,-0.12856886774211518,-0.16548574665836424,-0.5274658898397324,-0.3453119950050746,-0.9682421086236483,-0.7551787805213446,-0.5448621298739702},
{-0.05070760288863574,-0.7851653225721243,-0.07128457278998367,-0.24399064764306744,-0.9744030103731561,-0.20300723055322134,-0.7577305227023072,-0.12468550800897692,-0.6921691292613968,-0.2825498365600656,-0.3539718107724728,-0.3630431806929535,-0.02026807964482913,-0.9142664738323437,-0.6793417407199565,-0.6345046579851741,-0.42919299583096937,-0.180964787240934,-0.37142270205206296,-0.7460591354711432},
{-0.9103236455407474,-0.6838009224302545,-0.020705377017309234,-0.356470656334718,-0.17800017344265717,-0.26426508302476626,-0.36294137697310525,-0.9280109324918386,-0.18585216463010168,-0.630276878745143,-0.37090640528178664,-0.7399743527575728,-0.7874953838080708,-0.5653621276369398,-0.545805780730817,-0.8348065242501514,-0.5177920280666747,-0.7696744871447352,-0.2453444020846658,-0.5456579241898739},
{-0.6011387983204276,-0.8406022279205004,-0.7931393948073686,-0.998026594035993,-0.7548894448272757,-0.5526871506639746,-0.6764429266914911,-0.8654063230325197,-0.08876015039264884,-0.9231865693666076,-0.6886023386156396,-0.052883053630297654,-0.20581772015827715,-0.15325612015971957,-0.47247457723661346,-0.20790740493939752,-0.5849137937175705,-0.2753354188572821,-0.5152323829720119,-0.0897537879602468},
{-0.4934069635089037,-0.9364408818263045,-0.12747626399598733,-0.6161024331608271,-0.5561997992053852,-0.8150913514696115,-0.7274212631905974,-0.8935313535228434,-0.9003218693511664,-0.55625134049456,-0.522603772676019,-0.013279676655706618,-0.2660170761877879,-0.7502684434121315,-0.883863214178745,-0.5923243932353673,-0.7676545932313584,-0.8119677082303249,-0.41423889502308886,-0.20027297270731337},
{-0.5344141680453248,-0.011960096731783554,-0.21263848187202372,-0.6262486229567812,-0.027872107601273344,-0.20830048793475775,-0.2503797482892275,-0.8937867850369711,-0.7701600092389848,-0.7439220751759181,-0.10945185365249697,-0.19421495108258335,-0.25619890722248095,-0.4320617462519763,-0.9393323777514296,-0.87406084228601,-0.762815776353225,-0.5734102260302898,-0.9092752126924802,-0.6850582422182628},
{-0.017273928358102375,-0.95298685922843,-0.8025581083257306,-0.3828097656889866,-0.7317807719226581,-0.24611682217662934,-0.6214130233958238,-0.7578982532682754,-0.31199939262611076,-0.7073525193583915,-0.7619665181435943,-0.08220835492506795,-0.0584406457370541,-0.4468852741270837,-0.6832994295536534,-0.7086022159276585,-0.3254179888634321,-0.3156638274663415,-0.12610057885628068,-0.5875011940701279},
{-0.28823245231557026,-0.4726254428821305,-0.33258124059532124,-0.4266002520845551,-0.3705095798464858,-0.8946217701290619,-0.3392148038169629,-0.12473259889982181,-0.6047671472493914,-0.5136977845123981,-0.8817974322863897,-0.33298461651285205,-0.6088465793549075,-0.07232779397738975,-0.4014898355406443,-0.13834067018071805,-0.23289451914038906,-0.20122184587108838,-0.37881787308435355,-0.6326581240907101},
{-0.5324606506304113,-0.792454852863289,-0.2944653881784032,-0.6136736231738615,-0.910479229809986,-0.24737282077437184,-0.2930916127025319,-0.5481702848760912,-0.9636096262006317,-0.8762554963495961,-0.7073181089732506,-0.19549858974226242,-0.1493886200904765,-0.0592248159551646,-0.3860033757348744,-0.8420934756346491,-0.12490021086755487,-0.7783306384566309,-0.7817213564522717,-0.055143045159325554},
{-0.6012492132616655,-0.13841960469245185,-0.9767575353943,-0.5635443034830051,-0.26126889384529073,-0.2347958781959988,-0.7550505976888562,-0.2088002594001196,-0.7330056548495242,-0.9977532685895145,-0.1663685692308161,-0.6612694404382635,-0.6091919133351371,-0.1810346695611169,-0.6871714464205878,-0.798825023653553,-0.9297104977228418,-0.9033143029023252,-0.3496443111639935,-0.09248579627380071},
{-0.5008374329928091,-0.29898251365590955,-0.24328696932003602,-0.5964419179294342,-0.5810944672604533,-0.27542900323129405,-0.32569925172263037,-0.6934440142820726,-0.5565722879627371,-0.4338098263953666,-0.6335020416038284,-0.3990722129761489,-0.3783638599371756,-0.08388959594689327,-0.8036622399643539,-0.21645114393706177,-0.11963809922006552,-0.493384335365299,-0.24338818077491953,-0.06068845743208873},
{-0.06680452478586385,-0.8950963431886424,-0.8793046613298953,-0.2841517571734903,-0.33269123921152843,-0.828337262147317,-0.4414187571792447,-0.0031264444157073075,-0.44691411146255466,-0.6531390481277477,-0.6511117390444535,-0.6094063559325346,-0.6754719374670786,-0.8894977465349378,-0.6359908328656568,-0.05401782192415172,-0.17792022658334106,-0.5202809718843953,-0.4571753601281836,-0.7877321234344566},
{-0.43490187485797716,-0.6390880168033349,-0.9744483556942569,-0.5365270350342607,-0.31600824861541554,-0.9017837964487063,-0.8177913918175355,-0.10928973873103776,-0.7449790503197278,-0.830456490169468,-0.4827082846047326,-0.4780534059542748,-0.7948052287827917,-0.11095891045578488,-0.7303803900652184,-0.02400697472829949,-0.221454721424722,-0.23624769089396846,-0.6230291693119429,-0.5406756126325364},
{-0.5531922559834304,-0.38770712665436513,-0.36013227184700203,-0.36360262224530493,-0.9108465874906024,-0.05727246468596048,-0.23750407014908104,-0.5565927442158081,-0.36348696386561596,-0.2751413176312343,-0.3591188012394714,-0.7074341914950517,-0.7519064760853019,-0.9311986466412178,-0.17860231348599087,-0.5457898007327334,-0.12049606658848089,-0.592812581439304,-0.6371085566663033,-0.5507083462940884},
{-0.7807664905117035,-0.045588071031235966,-0.9908272312679915,-0.42504273602075293,-0.7019038094909488,-0.6541632160362845,-0.28636842772384596,-0.670859056543191,-0.37874182084822217,-0.9458781582113778,-0.9359441571791177,-0.2912885187939973,-0.6885771882204,-0.27624723690176345,-0.5808574308154274,-0.39903887102843516,-0.20988410024694526,-0.007678105620239961,-0.9094823420335774,-0.2503259223521932},
{-0.669951876689163,-0.6552116702167254,-0.17080145701463875,-0.11618066805672045,-0.5059167546223805,-0.5993355211646646,-0.06798223577987594,-0.2635823166038035,-0.6992914264449436,-0.17869710775568526,-0.5870665233146366,-0.24117889996516828,-0.1660288402909469,-0.8639587613542112,-0.3552337329920242,-0.08695454185141183,-0.09267681800450667,-0.32498332312539036,-0.2036284870888182,-0.9981080773929899},
{-0.9656161235771533,-0.1695501234745046,-0.6413886786421764,-0.5158659428934387,-0.5929383098925911,-0.9926413007867976,-0.6527575252215521,-0.9733206469814735,-0.8911447673496445,-0.5307900664525331,-0.6011799186427572,-0.6534014198616068,-0.712395544526225,-0.8299941928895542,-0.784677814184537,-0.8144223546483531,-0.07315289746997522,-0.2548281197020741,-0.5556346449870402,-0.38093757197977973},
{-0.9734898865140167,-0.04089821021086637,-0.8539013481248496,-0.027488375886434935,-0.2941162595881891,-0.42685459017364125,-0.35948549705663446,-0.1168041442858273,-0.8919040385141029,-0.41489483311196185,-0.5267287803535575,-0.875228087824318,-0.6537461722873327,-0.2601027441555458,-0.1775537927594275,-0.15779179177970903,-0.19653336809636945,-0.1247288118937685,-0.7244026434546684,-0.819898834256156},
{-0.9712423671120483,-0.5426460420606638,-0.1567287506969367,-0.20570893428844106,-0.9770815031361508,-0.8599785870297982,-0.2623511338318646,-0.12373153135835104,-0.5849710644899793,-0.8821620073941152,-0.8251178431015198,-0.8172744035261313,-0.9703275170816763,-0.04327568535536053,-0.1074861196397704,-0.25956542684570305,-0.23537310938781186,-0.8003054142879705,-0.5455996838316357,-0.6268585204116923},
{-0.8982795240919402,-0.7795083640221954,-0.016339515651129233,-0.8454691958142563,-0.7212949960264017,-0.2696270582699615,-0.8388367803250163,-0.7830571365355417,-0.3979806372026289,-0.4810071928272802,-0.17395184244322107,-0.08839824244823624,-0.8598229191079497,-0.9539974228619594,-0.5405615919700083,-0.0536294555334873,-0.9240327079768487,-0.8416266026105641,-0.8986841510810871,-0.7504090127652643}};

static param_t xstream_shift[20][20] = {{5258.030704013306,2329.2929691291506,90.66019167913635,31.885100617948943,1790.16142659781,1366.6835460784619,600.6430905991723,148.14542251252422,32.709619065233134,0.8571317114350174,16.70868304546061,307.7490612789449,0.9063583956097752,1034.779678241537,6.249004523214807,1019.7990102352462,661.8062567797697,1871.9927924486342,96.37198999013856,1034.862654722677},
{396.1769448637591,6417.887446809549,137.83491865611572,29.483117506501213,7971.307547744125,306.6743251871577,1452.225257538542,182.15172678333795,83.50565874859488,0.2825498365600656,8.77393234015149,695.7185833865439,0.02026807964482913,7358.424976697185,25.653022669871493,1226.7470459550318,822.5680373565214,349.87610473126557,47.399034304910415,1416.9983472559502},
{7112.330699592176,5589.341798495938,40.03564649721849,43.074873360354886,1456.1676338826567,399.2139382735025,695.5937749035802,1355.7212584403462,22.421842843308816,0.630276878745143,9.193691716211317,1418.0514490321223,0.7874953838080708,4550.286945822323,20.610492815583363,1614.0093294504861,992.372141257866,1488.083486179577,31.309577111683225,1036.374115646856},
{4696.678978903827,6871.024905503963,1533.6039719045013,120.59861978653353,6175.530930430519,834.9207981784263,1296.4338560908345,1264.2628532118058,10.708329100247074,0.9231865693666076,17.068450493554256,101.34255403613321,0.20581772015827715,1233.473713290492,17.841390149151987,401.96678090823724,1121.0140799000942,532.3316503341642,65.75127815441914,170.47035972465474},
{3854.9734604250175,7654.403483414457,246.4864386609796,74.44801925152024,4550.108743775077,1231.3235814144994,1394.136173251399,1305.350409828872,108.61791953385882,0.55625134049456,12.953828532732084,25.448537039326595,0.2660170761877879,6038.495571307517,33.376078211186474,1145.1960052680529,1471.2451933179327,1569.852915887818,52.86301426151213,380.38066667072616},
{4175.3614907234005,97.76100965092054,411.1549905522979,75.67405520366455,228.01360353811094,314.6706223195352,479.8642572098298,1305.72356699939,92.91474611407831,0.7439220751759181,2.712993321008974,372.18424095380453,0.25619890722248095,3477.425932255016,35.47068189195083,1689.9033644042752,1461.971379110253,1108.627481375403,116.03697555615315,1301.138677679112},
{134.96067202660407,7789.649166853999,1551.8158733137093,46.25761443510506,5986.485600334109,371.7981381871908,1190.9665255669613,1107.2054624740565,37.6406772694506,0.7073525193583915,18.886935264881867,157.54015850632004,0.0584406457370541,3596.7323061415414,25.802471283559694,1370.0067670216476,623.678482687356,610.3023247911941,16.092300309204298,1115.8474997863868},
{2251.9513024458806,3863.2079254078335,643.0747418387755,51.549128960514665,3031.0310814934255,1351.466777337981,650.1207105623106,182.22052136275727,72.96118374198264,0.5136977845123981,21.857195327831356,638.1157890024223,0.6088465793549075,582.1263941591608,15.160893605524581,267.46692296717646,446.353014567479,389.04096588955895,48.342767586461655,1201.6145551899897},
{4160.098719125257,6477.471566999098,569.3744275663918,74.1545289438449,7448.365696108837,373.6955214545209,561.7235019402037,800.8161137243426,116.25317167530426,0.8762554963495961,17.532360041755663,374.64414467155933,0.1493886200904765,476.66777404406224,14.576100296559872,1628.0978723357919,239.37697566528396,1504.81923101229,99.75921554242683,104.73379406322786},
{4697.5416474504555,1131.432346550714,1888.6456096814638,68.09704830987978,2137.3648103797973,354.6960731706874,1447.0890584859246,305.0340685928184,88.43231731523635,0.9977532685895145,4.123793266965161,1267.2251203297446,0.6091919133351371,1457.0478873218833,25.948684787767935,1544.4429377614629,1781.8327578738422,1746.4618087646081,44.61978928002054,175.6592932567811},
{3913.02749041934,2443.8625421228594,470.41650547749276,72.07229999176613,4753.764780603158,416.07879420227994,624.2175358413434,1013.0449532270836,67.14679054978346,0.4338098263953666,15.702674284288161,764.7628972144701,0.3783638599371756,675.180940971322,30.347562095737487,418.48518852730365,229.29189764147833,953.9059616233894,31.0599343180242,115.2662567753103},
{521.9417015405849,7316.456062803036,1700.2120055544385,34.33606872784925,2721.6502391342187,1251.333611143513,845.9992690288124,4.567389250819823,53.91725187389827,0.6531390481277477,16.139167499771634,1167.8371863283096,0.6754719374670786,7159.075195421431,24.016023564285415,104.43769425555023,340.99226457163473,1005.9077380968704,58.34234272259985,1496.148313071919},
{3397.8749986497314,5223.8615773454085,1884.1806099815217,64.83236047010531,2585.1715465993802,1362.2861436362361,1567.3346645184668,159.6602118998875,89.87682882828767,0.830456490169468,11.964935343043066,916.1186769540549,0.7948052287827917,893.0468757784492,27.580323099410908,46.4149237671107,424.4281182011882,456.75969950821883,79.50774361939031,1026.9111563362603},
{4322.074115377345,3169.091438020152,696.347055929169,43.93667929851446,7451.370942419702,86.51905851583739,455.1874302339635,813.1203946066198,43.85231452970811,0.2751413176312343,8.901511273666841,1355.6930407195919,0.7519064760853019,7494.702666924968,6.7443069108222495,1055.2263365368563,230.93623140556267,1146.1398650640567,81.30448183844487,1045.966438070597},
{6100.104624197274,372.63376308720694,1915.8505898106155,51.36092326668611,5742.07086269455,988.216342311976,548.8382099470405,980.0508297145916,45.692712819079176,0.9458781582113778,23.1993352559031,558.2113820876898,0.6885771882204,2223.36115994808,21.934098771672524,771.4990742696832,402.2524926768892,14.844797858647379,116.06340832585187,475.44678616444463},
{5234.313447933438,5355.655213492656,330.2594658639347,14.038932727089824,4138.757784735488,905.3904928065156,130.2910690615837,385.06459079012296,84.36491711908879,0.17869710775568526,14.551672754646244,462.18370582314765,0.1660288402909469,6953.526034632867,13.414189735919718,168.1173274398328,177.6193671260136,628.3205751312823,25.986008910211936,1895.7176834990782},
{7544.329133249531,1385.8910700326755,1240.1807696604444,62.33573441789847,4850.655811483387,1499.5406825762593,1251.039699172202,1421.913736348467,107.5107624596075,0.5307900664525331,14.901502803057461,1252.1472221050776,0.712395544526225,6680.164015936659,29.630680038132706,1574.5987127929852,140.20087905283197,492.68297582474025,70.9072047918218,723.5189333378531},
{7605.846601384613,334.29916269027063,1651.0924910203585,3.3216150871005032,2406.07955333775,644.8309404438844,688.9704227337076,170.63792670742293,107.60236353812508,0.41489483311196185,13.056075483375825,1677.245236335235,0.6537461722873327,2093.423070714744,6.704713103528951,305.07359088013584,376.6652029283473,241.149847539396,92.44449937490003,1557.2429018302532},
{7588.286801286205,4435.551496331029,303.0486647795741,24.85726703195449,7993.219517792392,1299.1328049452266,502.8079659979467,180.75807248463644,70.57291639288779,0.8821620073941152,20.45227305594093,1566.185568267634,0.9703275170816763,348.30204663172253,4.058846525304564,501.84205365197397,451.1033463180851,1547.3051150753347,69.62659521834777,1190.5993039355192},
{7018.2303484153335,6371.647855960355,31.593873996958035,102.16402919174374,5900.704518321881,407.31404453823666,1607.6691156585357,1143.9598062967807,48.013749636962544,0.4810071928272802,4.311760568478026,169.40216282966492,0.8598229191079497,7678.197401974828,20.412463922167305,103.68682928316585,1770.9510137325099,1627.1952231654122,114.68539933350893,1425.260117192784}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
