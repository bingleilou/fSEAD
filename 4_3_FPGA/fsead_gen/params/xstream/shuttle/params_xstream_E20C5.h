#define ENSEMBLE 140
#define DIM_MAX 9
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.977841397161868;
const static param_t delta_xstream = 0.14331079528501967;

static param_t xstream_fs[20][2] = {{15,11},
{6,1},
{6,6},
{4,18},
{9,12},
{17,5},
{10,3},
{11,18},
{9,3},
{13,14},
{5,16},
{1,19},
{1,0},
{9,10},
{18,5},
{6,6},
{0,9},
{1,13},
{5,7},
{7,6}};

static param_t xstream_R_T[9][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0},
{0.38729833462074165,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0},
{-0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0},
{-0.38729833462074165,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0,0.0,-0.38729833462074165},
{0.0,-0.38729833462074165,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.00012799231138014235,0.00012234015150303773,0.0005171735398040283,0.00827560544061414,0.00012223879263683805,0.0006619635681250126,0.000521772031417927,0.000684514553942633,0.00828888891644177,1.0,0.04034357652299393,0.0005218247569667769,1.0,0.00012424757699204138,0.026481937409965246,0.0005172253400383838,0.000521772031417927,0.0005172253400383838,0.007836081631173329,0.0005265067082935586};

static param_t xstream_shift_deltamax[20][20] = {{-0.9720222996061189,-0.7386944669320493,-0.7849054677741933,-0.8387496009452513,-0.19929639727309723,-0.5675213339391357,-0.3226220212207816,-0.04463028587572815,-0.13117183453951742,-0.2843532828897334,-0.9195921678768556,-0.8122660180924475,-0.016733751291627907,-0.09542002205452482,-0.8086177980429645,-0.5994429774130189,-0.20666249170017448,-0.2580024685383644,-0.08943032233068038,-0.9928430959599046},
{-0.3097678976989666,-0.7759205054045731,-0.11054134083758815,-0.8568791318754078,-0.2687575297571638,-0.7033473395361672,-0.026114746202884564,-0.10439232093255102,-0.26694097140091666,-0.26422823571856147,-0.12207559898023157,-0.9773918878083209,-0.8941842282511602,-0.5662150068807981,-0.2563048140055517,-0.32006849390761727,-0.391814466595899,-0.11921704673046474,-0.10774365345513959,-0.7594919879691578},
{-0.19182147228847501,-0.6462497599268884,-0.387781484767194,-0.23539512804550855,-0.10285857533810316,-0.5495520311713297,-0.9907799273319188,-0.854639301649874,-0.7877946476631912,-0.30977966492866593,-0.7872561106087823,-0.10946472256774353,-0.4303167961194039,-0.22174594912141565,-0.4662783646498265,-0.4092370600059776,-0.4676617397355619,-0.2008588707154657,-0.16009539944956042,-0.3232070701517543},
{-0.9813020067429653,-0.4204003677762489,-0.23717286692619544,-0.4373347926507716,-0.4135005912128298,-0.7820624097272475,-0.11826916133596166,-0.2683705190381681,-0.7210032979580049,-0.5685070311611824,-0.8143664691643294,-0.8902289610277606,-0.672206346599621,-0.8253067123231382,-0.6765506421358174,-0.8090880323094618,-0.9739196396761038,-0.2822569279197652,-0.136673442348212,-0.37356937311769},
{-0.05529096713658843,-0.3681141390905406,-0.752246354749029,-0.9690680521143344,-0.4224219165238301,-0.1771414014687058,-0.743512706035683,-0.17040931904157886,-0.9190801858111741,-0.2234413681960431,-0.7144146174182499,-0.8452176886032613,-0.24939961820883216,-0.5712899564785129,-0.22990035999124625,-0.6972213309155921,-0.21822185073628642,-0.4734402139840621,-0.010683108847635236,-0.7156834695726954},
{-0.6847660682962609,-0.23474305199304257,-0.1157432376192501,-0.7118131495537936,-0.5091425146682222,-0.4950821187748694,-0.0206289657797597,-0.6576217238380551,-0.4843323753880284,-0.2290385605657127,-0.4945439135105565,-0.9345895376497292,-0.4824033359872407,-0.37780966796059046,-0.5534344136280271,-0.27571344025258315,-0.7400368574051,-0.028417090589436644,-0.7916443602310946,-0.310112706885463},
{-0.5490579819334687,-0.6689392193997667,-0.8375415558892547,-0.07558401274503679,-0.8939708279986092,-0.010990681411405245,-0.8950738040306143,-0.026360877528852522,-0.6997379162689374,-0.3456851759376651,-0.8047871496977215,-0.3588981415385063,-0.49262075966754515,-0.3452461083818913,-0.27381657793625513,-0.9264192131567336,-0.1388218963903877,-0.6342444718353474,-0.464645216698504,-0.670844847329473},
{-0.7028100174333927,-0.4975817108484665,-0.1148948895954196,-0.9032215060398535,-0.05951723557161126,-0.6708698987680212,-0.012409241741953125,-0.23526312705810082,-0.05500103957755409,-0.9875357299640174,-0.6918446600548799,-0.23736018811517534,-0.1394901942688368,-0.12702886384775547,-0.8076600593239487,-0.9122994142669745,-0.6909364999738941,-0.14037451203323537,-0.1867865066999327,-0.6495176567459581},
{-0.7304036062727352,-0.950664485861504,-0.15351118010157858,-0.2060254146675441,-0.7568282265351126,-0.6267962824652388,-0.8250954622110482,-0.5169270879847134,-0.6993114223980584,-0.9317920376085308,-0.606227327962855,-0.6056558295732986,-0.21097514355242153,-0.19968122440476432,-0.11277244354972882,-0.75571836841314,-0.5385159616476745,-0.14961762153149635,-0.8226768441254086,-0.7658530244930558},
{-0.5700598799590046,-0.22873951624936828,-0.7820785753062534,-0.30398321428917063,-0.45340506259631097,-0.8526870221345662,-0.8850177907004814,-0.6881801899303037,-0.8370886653636973,-0.753934037884316,-0.8809553909089641,-0.5671679538645023,-0.27880971458935344,-0.04875799496903288,-0.6627227724651525,-0.9899072219430105,-0.5716555005507782,-0.23285607931689933,-0.5973380189482923,-0.6302179270914615},
{-0.7763877601268091,-0.5252008092647421,-0.5352218151552619,-0.4369441818008245,-0.06685856605992735,-0.47517532297742926,-0.8246706119708703,-0.9815824926748964,-0.24817680812227516,-0.48486373349197076,-0.5095340598163232,-0.14045238277023386,-0.308030699927623,-0.1388753059877973,-0.7529770147975434,-0.23157464747568546,-0.18928041054431155,-0.040239923519509446,-0.9966883825959079,-0.48837368864185216},
{-0.6439815297939272,-0.1553157649519319,-0.051534833136268055,-0.8824089159222,-0.6960095674353095,-0.35983577403572864,-0.9127932728476152,-0.1620406929721555,-0.34573186611245577,-0.15226480968707623,-0.778777967704373,-0.11040748912093945,-0.31230491686112205,-0.8800528368506315,-0.035310311496361546,-0.6335685953888113,-0.7690465613142815,-0.03515362780161302,-0.3303460393375304,-0.9663015007174341},
{-0.6715357257534578,-0.5978878533684697,-0.4877873658897457,-0.2696160991566242,-0.5201501089400343,-0.4159555064222011,-0.835242302433867,-0.10347232204654133,-0.45005818456760993,-0.11992115929301106,-0.8385600642353767,-0.6682650038569408,-0.7336852226042925,-0.4945387875351308,-0.9490275018160506,-0.48894255228846395,-0.7201990872566225,-0.8527627346846592,-0.9523893509048073,-0.767863096645628},
{-0.6605584676138361,-0.18163513340572268,-0.45939231773275657,-0.8665693164610094,-0.3465155799051004,-0.2708957429275791,-0.27043751587000764,-0.19275510060699141,-0.22665157732454366,-0.46997371337566973,-0.5406177465408527,-0.7572594023671145,-0.04784390407964256,-0.5704063517351565,-0.30131686854597683,-0.39234109520896143,-0.6469203412665931,-0.4170603907849686,-0.967475996157434,-0.3954734000301896},
{-0.0873036458164016,-0.9883412533121644,-0.8601010209322589,-0.39982686126622435,-0.6438574250012206,-0.7604118211585027,-0.7827052477520086,-0.6716355261228504,-0.6298949273965517,-0.5302916664227535,-0.31203099464685013,-0.9867871804254995,-0.6398482717843916,-0.27163220552231404,-0.5769472012467958,-0.29354565317615433,-0.6724855130079936,-0.032730581522462665,-0.06685717086549059,-0.6232825026355282},
{-0.7201356146558174,-0.21120264527430854,-0.668057664062926,-0.8632935875482144,-0.47417746569206687,-0.3299973791775058,-0.36299819935194666,-0.06923758882401942,-0.4135314693126462,-0.029300380569760365,-0.3789453869576481,-0.14317054415302533,-0.8782204440988038,-0.10565180948257535,-0.4851020153662758,-0.8808215883283067,-0.6373498865402841,-0.9354984356887562,-0.026287411804993055,-0.16665131549340295},
{-0.11483069618176589,-0.766290166561285,-0.4275887961723849,-0.9459829963044923,-0.9591929328388612,-0.48685280268001996,-0.61626509913013,-0.1750465923252118,-0.7205917336316255,-0.3113146722074379,-0.030424943495026332,-0.03048960086492658,-0.07977209733175283,-0.7826933117553436,-0.3146849077124829,-0.5922555750295133,-0.9005242388045163,-0.05813514096773309,-0.5591072592382708,-0.1112302167836755},
{-0.7187562507486539,-0.37923895208818315,-0.7428841569921073,-0.7526672303376597,-0.1517154967352301,-0.7205641546672992,-0.27949854812132335,-0.307450709376083,-0.5679323588009689,-0.028806166546063272,-0.43868274073493063,-0.881170092012438,-0.883285753930209,-0.27626943338433096,-0.24111532437904223,-0.26306106171603905,-0.023082952430043435,-0.47379811543113404,-0.766903825229516,-0.09619322005927033},
{-0.5433223887468585,-0.16365126266254693,-0.48586139291783675,-0.40459065216380397,-0.8917777483586902,-0.31317061964186566,-0.10521884147304017,-0.1265442631087489,-0.6474547936548806,-0.9066393495130246,-0.18941504468789505,-0.048570459147166734,-0.2836576123809643,-0.6280752052431959,-0.28398269187760683,-0.28215966581809904,-0.06570443506512658,-0.5830589440031837,-0.6103636484294959,-0.8281697807492111},
{-0.6120641946590565,-0.507115161773747,-0.9243396707452816,-0.6683021943485831,-0.612264212959482,-0.10009220566257893,-0.6450698806663993,-0.22670364157038148,-0.8009983271454161,-0.4468411538527506,-0.45601049480101885,-0.5630959256782478,-0.4302751011993663,-0.669512148966692,-0.029610960853282627,-0.77083703446959,-0.8677966728894647,-0.3706377534686828,-0.36771175767488073,-0.8206630986619283}};

static param_t xstream_shift[20][20] = {{7594.380389921808,6038.037862930939,1517.682958164519,101.35205296629113,1630.3858453935434,857.3301632695874,618.3198826200959,65.19990790359218,15.825020200153253,0.2843532828897334,22.794016969534955,1556.5877380251668,0.016733751291627907,767.9829608317989,30.53469183635631,1158.959028125988,396.0781323187535,498.8202405536005,11.412632810627015,1885.717846174784},
{2420.2070761808764,6342.320945918616,213.74129248660978,103.54277255294302,2198.6271621286505,1062.51669034955,50.050107384861484,152.5056265513674,32.204674726840025,0.26422823571856147,3.0258992757038845,1873.0270550780879,0.8941842282511602,4557.151298951019,9.678476692913838,618.8182773177059,750.9303738092949,230.49343777630372,13.749684922438295,1442.5115122098239},
{1498.695274896298,5282.401173999215,749.8092128111105,28.44446001379685,841.4560805070122,830.1847074876273,1898.8751172412453,1248.5334266851814,95.04224940215188,0.30977966492866593,19.513790755762162,209.77295750403206,0.4303167961194039,1784.710450616027,17.607411324609668,791.216184372575,896.29514725939,388.33919216053835,20.43054258300123,613.8707542764056},
{7666.882456934923,3436.323746630396,458.59435696587826,52.84625950198957,3382.728038236666,1181.4281742761318,226.6682654770947,392.05962457981485,86.98431179694408,0.5685070311611824,20.185777745812373,1705.9921920960894,0.672206346599621,6642.437078479228,25.547626356115053,1564.2853697953365,1866.5616035981382,545.7136494875109,17.441554182450155,709.5244319458945},
{431.9866290434589,3008.939702689515,1454.5337238909717,117.09935412803091,3455.7108051517885,267.599925431625,1424.9761605948308,248.94915390777845,110.88098719577414,0.2234413681960431,17.708261859507356,1619.7347429744007,0.24939961820883216,4597.9967602515635,8.681402588948568,1348.0030403457238,418.23217343264594,915.3461312412259,1.3633228124035777,1359.3055098809102},
{5350.056272227775,1918.7735923901798,223.79961214394007,86.0134227835987,4165.146789209913,747.89934463791,39.536357906536374,960.7125517643389,58.43151962470034,0.2290385605657127,12.258306182365608,1791.0026789112883,0.4824033359872407,3040.7809722099523,20.898562105194305,533.062514361965,1418.3145374696178,54.94141216539736,101.02553769753908,589.000485654889},
{4289.773159129412,5467.8632581483835,1619.459410484579,9.133351425152965,7313.315263629338,16.603151503542627,1715.449947744864,38.51032440000063,84.41878318346663,0.3456851759376651,19.948334259334466,687.7752286508637,0.49262075966754515,2778.694898847049,10.339748701060557,1791.1326871339738,266.05852370648563,1226.2440037997355,59.29560698424358,1274.1430199507304},
{5491.033092964612,4067.198746571042,222.1592574882244,109.1426497458565,486.89318904214264,1013.4544121034264,23.782880251804105,343.6933892830239,6.6355141360930165,0.9875357299640174,17.14881821795252,454.8657091221286,0.1394901942688368,1022.38503899269,30.498526101795836,1763.8335627548176,1324.211453220785,271.3991391504872,23.836722930101022,1233.6360515729907},
{5706.620955561986,7770.666246378637,296.82721231203806,24.895509596969713,6191.391539538438,946.8742883246824,1581.3332500188505,755.1732611196394,84.36732949948336,0.9317920376085308,15.026613409382136,1160.649857039763,0.21097514355242153,1607.12368996584,4.258466508847353,1461.1008199193363,1032.0905093058466,289.26970500013226,104.9857419622396,1454.5930990608526},
{4453.860343735053,1869.7011033510828,1512.216915820181,36.73244410581901,3709.1749093378417,1288.1177502710166,1696.1771375430494,1005.355088458759,100.98924883686827,0.753934037884316,21.8363235695492,1086.893533302814,0.27880971458935344,392.4261233050529,25.025464043871942,1913.8799770899636,1095.603953698499,450.20238045494614,76.22917257165562,1196.9798621066718},
{6065.893738108269,4292.955361034527,1034.8979094291494,52.79905922730875,546.950477975997,717.8270011495433,1580.5190050716399,1433.983378470518,29.940901684662915,0.48486373349197076,12.629868339162067,269.1562270572304,0.308030699927623,1117.7304970437606,28.433607524281644,447.7248687361298,362.76457753003336,77.79959797894513,127.19218986067015,927.5735350546663},
{5031.407924818828,1269.5404006269794,99.64708008030739,106.62771712044257,5693.851783231366,543.588486379923,1749.410121441503,236.72351747503623,41.71027861486537,0.15226480968707623,19.30364223559868,211.57963022434524,0.31230491686112205,7083.058343318864,1.3333734216543442,1224.9372688155488,1473.912963913341,67.96578798518308,42.15704415627257,1835.307101497867},
{5246.688012055423,4887.0942697306045,943.1792780322482,32.579622251374005,4255.196715541521,628.3661616006749,1600.780134121175,151.16161000604967,54.296563641343816,0.11992115929301106,20.785466646900705,1280.6310833954692,0.7336852226042925,3980.269068480976,35.836785168857325,945.3182480428726,1380.2945422342123,1648.7257461542292,121.53897773550914,1458.4108512773191},
{5160.923031165135,1484.6731116007538,888.2749838803302,104.71370616682042,2834.743148474734,409.2305920926756,518.3058876020774,281.5938675032841,27.344023983113047,0.46997371337566973,13.40034258570819,1451.1756911819484,0.04784390407964256,4590.885114578079,11.37820333464689,758.5496394663213,1239.852468727718,806.3417595781718,123.46425697106602,751.1269919274985},
{682.1007049173934,8078.633557092036,1663.0800973657226,48.31391058157466,5267.210278443039,1148.7215577623722,1500.0904621602463,981.185165829415,75.99268535823872,0.5302916664227535,7.734341412913831,1891.031744376064,0.6398482717843916,2186.2173259098113,21.786442295180734,567.5391951105297,1288.8492914817598,63.281086576372495,8.531964572640598,1183.8073339191176},
{5626.397452242155,1726.3559238690686,1291.7475714555542,104.31787664881092,3879.1078958118583,498.5129017178562,695.7026775955987,101.14845393020235,49.88985538126452,0.029300380569760365,9.392954705978216,274.36518149356533,0.8782204440988038,850.3329565078186,18.318222260571094,1702.9745454136878,1221.5102538330232,1808.6863950233608,3.3546628330691517,316.52268217727055},
{897.1687044600209,6263.603217315435,826.7801100853117,114.30982338305995,7846.878328457881,735.4676694051495,1181.1002928911616,255.72369691336309,86.93465926443602,0.3113146722074379,0.7541459165794474,58.42881246599761,0.07977209733175283,6299.465395654989,11.883001717014325,1145.0629526108708,1725.8959556673092,112.39809125248742,71.35036176933667,211.26077793800508},
{5615.620524376021,3099.8731604379823,1436.43110061974,90.9501106280151,1241.1403406606369,1088.52539529973,535.6717709873791,449.1514571972848,68.51730847477315,0.028806166546063272,10.873670074464078,1688.6322088941054,0.883285753930209,2223.539807154769,9.10489744939544,508.6004906420808,44.23953573616241,916.0380954961972,97.86827924030754,182.70084415645644},
{4244.96114562045,1337.6741866997231,939.4552418554579,48.889553165282244,7295.374317121183,473.0934370435368,201.65672963938994,184.86716225372496,78.11116787566,0.9066393495130246,4.695048407023047,93.07810428446017,0.2836576123809643,5055.029807812084,10.723637303467953,545.5256035931258,125.92555964828803,1127.2822479268211,77.8914356891537,1572.9520017577013},
{4782.038765134892,4145.124519983574,1787.2911114043845,80.75568599111315,5008.755402047134,151.2050065626518,1236.305976219936,331.18892836481723,96.63518659980623,0.4468411538527506,11.303174733184958,1079.0900932937122,0.4302751011993663,5388.532840439837,1.1181568929371428,1490.3311473726044,1663.1720763782762,716.5885442526412,46.92546287573854,1558.6944776482508}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
