#define ENSEMBLE 140
#define DIM_MAX 3
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.908198388578782;
const static param_t delta_xstream = 0.1447555417130586;

static param_t xstream_fs[20][2] = {{13,10},
{19,12},
{11,14},
{11,15},
{1,1},
{1,1},
{9,9},
{17,0},
{8,4},
{15,17},
{16,3},
{13,3},
{7,19},
{5,16},
{12,9},
{2,8},
{7,14},
{7,2},
{7,16},
{11,5}};

static param_t xstream_R_T[3][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.39105317842609216,1.0,0.24811202011695074,0.5663290447231158,1.0,1.0,0.24811202011695074,0.39105317842609216,1.0,1.0,0.39105317842609216,0.28774244127026105,1.0,0.27401342464691647,0.5663290447231158,0.28774244127026105,0.24811202011695074,0.35045884862783616,1.0,0.28774244127026105};

static param_t xstream_shift_deltamax[20][20] = {{-0.9989919258097119,-0.8299032342351395,-0.8947826411950449,-0.5624122790400273,-0.28388240016648125,-0.3002085798997802,-0.6979876972512582,-0.13583629849559553,-0.4495678400671045,-0.9693717873751625,-0.6146018647428908,-0.8223042554930332,-0.28044087837049325,-0.7876359043183726,-0.12976046154661391,-0.7408173576937233,-0.03115311274486521,-0.28795077653090395,-0.9408533369313117,-0.5692567143547048},
{-0.475819878764251,-0.6114689706118943,-0.5085354592838699,-0.3910290293972728,-0.20001655507286098,-0.9631019006972039,-0.6645420338333489,-0.29338691643547066,-0.6787095318788594,-0.6691263147028205,-0.3808511796331565,-0.49375320947625,-0.7617475256592836,-0.320887371109964,-0.41116678149551367,-0.08964638629718323,-0.6500496383955645,-0.35856223261993897,-0.901487646705332,-0.10860294720682073},
{-0.7964449426671489,-0.38940332391637644,-0.16843412731296437,-0.45595832236169254,-0.29657352954893157,-0.7321934618764879,-0.9963899686935944,-0.40220660719918366,-0.2919058807253253,-0.6200124862194268,-0.5485664586726607,-0.17145529811821314,-0.3065695901026798,-0.6762490167858107,-0.6777801287671059,-0.22489479047669136,-0.9659975238201001,-0.18434256632238774,-0.9715374057198308,-0.31597994040299826},
{-0.7651425889554921,-0.3698639134042412,-0.3986538109031742,-0.8750408208691681,-0.5123822599340315,-0.987630365432294,-0.7484748912178079,-0.9696955607717445,-0.543270508355189,-0.47527026488651825,-0.6418485182162651,-0.5020760595372113,-0.17163008586326156,-0.7653813278087076,-0.7596185707537303,-0.028733228335788178,-0.44908043161638045,-0.25689856174601533,-0.9567692802193758,-0.4851490258651292},
{-0.1988893814194337,-0.6961680680804825,-0.8068033944202908,-0.10264660933272096,-0.007409803328058406,-0.07625311327288897,-0.02558606616274406,-0.062047112998898084,-0.8369537268401457,-0.5303657769773326,-0.8817123179375725,-0.5046883641013441,-0.3503952666296709,-0.22430550261990623,-0.4767891616066622,-0.272375761429549,-0.372431231022086,-0.7833043236499708,-0.4882221758612755,-0.24075580803270522},
{-0.5868475632003136,-0.36688481157720754,-0.33931373869051595,-0.033633247832957514,-0.06600898953247125,-0.07496186894046752,-0.5628472475308495,-0.2976251122180169,-0.14033404625250012,-0.6448585159681269,-0.4668579298253631,-0.8143659152120267,-0.8809317442190376,-0.7899297677610856,-0.16972958120600956,-0.765386242260477,-0.5675842560495198,-0.4228852230484835,-0.1564506497429824,-0.6138931072945805},
{-0.3971945408624892,-0.5124126134172583,-0.33645510437815906,-0.9095642264682469,-0.43978645262421556,-0.3460871879501294,-0.5466667233890943,-0.2618479555776214,-0.7771444847551122,-0.21971011086266312,-0.4079920869285242,-0.9511843378440262,-0.14693525946303543,-0.0608701954555253,-0.29659604096330044,-0.036745385094203886,-0.9394035606167382,-0.742332328315896,-0.7690491534769182,-0.7641288279806951},
{-0.4350437085434369,-0.4598827481855605,-0.7150618001446325,-0.26238220815966706,-0.303700056840552,-0.58873982256025,-0.09721353146289569,-0.433320764461598,-0.5138390831566854,-0.7544027251258737,-0.4787382249544363,-0.3619775716163832,-0.27396884605321514,-0.8560975715954897,-0.9898141868702822,-0.8708638907353082,-0.03797838138787435,-0.053888345202730885,-0.9506456894834094,-0.7581338209909302},
{-0.5554045386837696,-0.46655686691138876,-0.10111821637329266,-0.7514027270093745,-0.3927317606225954,-0.24210665463032477,-0.04299102639046648,-0.7817904746980108,-0.7734309553320683,-0.41726769373067485,-0.8333864006778596,-0.004241534670899827,-0.6463953859685675,-0.8474057875500465,-0.9546205787757174,-0.4456020509021318,-0.2893803053029087,-0.9096576227729993,-0.7045360361458312,-0.6172697502069293},
{-0.5208325143074349,-0.8092734949582553,-0.9666444977343068,-0.384359366801527,-0.9442612556041317,-0.024820024666280194,-0.8083678436280026,-0.5272090873896269,-0.5881544060411144,-0.43608337273040665,-0.19730631676814248,-0.40786813255829624,-0.11450929320540826,-0.5025310650722493,-0.004231319663007382,-0.45601314889600963,-0.1531986716237721,-0.27382925395770474,-0.725530521263592,-0.43621504914341025},
{-0.3769248175643778,-0.9484247530704975,-0.6698740155662039,-0.45936315913717296,-0.9406472957158557,-0.004490389300134012,-0.5234002848565852,-0.4170708781977226,-0.23741535859113283,-0.29160773651408634,-0.3448280924413528,-0.24292002313892302,-0.9923731723271826,-0.11747539930199193,-0.7422334602346252,-0.20642811387034346,-0.8776529558548952,-0.6724925196005558,-0.29566668436813015,-0.6496224169649318},
{-0.824770827396144,-0.8474943700929509,-0.5102133955265455,-0.5388681947501167,-0.682859596122969,-0.40701146696982227,-0.7480270497667124,-0.4554008268477434,-0.22829857316048097,-0.04811009166195579,-0.7342873040548434,-0.9308251223379675,-0.1841658618596611,-0.4582300887385332,-0.8014879162906573,-0.21114493635677822,-0.1922271101851355,-0.15990150589556285,-0.1770326772523937,-0.4377829332207053},
{-0.5307873819596961,-0.43408897545522607,-0.9980560349798264,-0.9602009858430304,-0.05200081794806821,-0.4596812182913915,-0.5100020621899399,-0.6395576565656014,-0.8697888301356616,-0.849495795359688,-0.6074848777784981,-0.1264033862110665,-0.4043284461008283,-0.8178695211294774,-0.7776295660066253,-0.8722522462981731,-0.2838697232305255,-0.3161882574756326,-0.7155362814444463,-0.9772330216571599},
{-0.3225714112204734,-0.7512284741886003,-0.45262728114244855,-0.6030706541195217,-0.5881184646735995,-0.6934408780934554,-0.27487305123380423,-0.30682469098473597,-0.26003018401442857,-0.7350717331325027,-0.8023056150178925,-0.647254023437117,-0.2083851249754447,-0.7749076539641913,-0.9071631649344059,-0.9502743739696812,-0.4949286444747172,-0.4960921395337875,-0.2577760357804145,-0.47326236176363096},
{-0.11348867851914413,-0.4107828528078886,-0.9098488688396524,-0.693139631719524,-0.6971547455499338,-0.6542530638788507,-0.39362871346798567,-0.34268068463609236,-0.5075720622094939,-0.0989248389993358,-0.35256404956777876,-0.19224879883730894,-0.5746441640243896,-0.2768771978410614,-0.6182350722286332,-0.9779301157464352,-0.06430480533039584,-0.4057214756404322,-0.39753517110644065,-0.8514908984980912},
{-0.3262240580819149,-0.3651701668729649,-0.20459920802057185,-0.98808857046919,-0.38448235187152857,-0.7963217338379461,-0.14266990887613418,-0.799254577861697,-0.4924700557008497,-0.47038027022044004,-0.6892541696329667,-0.7212138196699153,-0.4316708034412431,-0.14626000743894585,-0.017090006050992868,-0.49079900405244736,-0.36557691374554036,-0.6974515958568374,-0.04511827411210678,-0.5821371925801588},
{-0.1333372474356589,-0.9508518820374914,-0.13268393670199075,-0.11949505168004215,-0.3166792695668559,-0.6209701554877569,-0.002214399820284707,-0.3368644599109326,-0.04556197016835406,-0.5473759182084066,-0.7612561839181431,-0.31607486964426845,-0.8143818941964963,-0.5459294079993455,-0.3278540867217868,-0.5267474002642154,-0.23843586661732952,-0.5820981420252028,-0.04651580203608252,-0.9275715026263801},
{-0.7171967373599485,-0.12140839289937744,-0.6853221586775214,-0.6021559317021571,-0.4864693839814045,-0.8557135206268479,-0.31476047802158524,-0.5127263710624634,-0.9663763762914632,-0.5631305506516961,-0.11390029502601018,-0.6332248019690705,-0.7334994175392757,-0.8122679321889955,-0.6238874285143464,-0.6174710944718866,-0.11593338725474323,-0.6209294566468088,-0.09065243424914282,-0.9608164664379453},
{-0.1408573522131108,-0.8684398218758955,-0.6580788024953548,-0.7238802111327204,-0.17328566762458553,-0.4438651724943006,-0.18295488332405463,-0.6981355251301258,-0.38985002347721287,-0.2308723696979621,-0.25883201398083433,-0.8189153949054588,-0.8949215792067502,-0.9745286555176952,-0.8225957354841031,-0.4637427104757419,-0.8052933815331058,-0.25409794526076845,-0.10357775237425726,-0.6275364221191757},
{-0.13126043479553384,-0.21971532535569194,-0.38598900088920307,-0.6723969758390276,-0.3593643961527202,-0.3301753414910332,-0.3159898340899012,-0.5420279547691098,-0.5161890339959523,-0.5138851569317437,-0.7803001975095664,-0.7435437573409029,-0.8849462420197838,-0.4417179706274815,-0.3492258606255868,-0.2171321004457937,-0.9307860942042078,-0.8301136496112949,-0.4032630947917729,-0.13375512844145365}};

static param_t xstream_shift[20][20] = {{2.5546191181221105,0.8299032342351395,3.606365547196294,0.9930839399469553,0.28388240016648125,0.3002085798997802,2.8131958174467036,0.3473601698937941,0.4495678400671045,0.9693717873751625,1.5716580215932159,2.857778824225262,0.28044087837049325,2.874442758902382,0.22912556358477987,2.574584946257244,0.12556067509418042,0.8216393384225502,0.9408533369313117,1.9783550589258831},
{1.216765148615662,0.6114689706118943,2.049620405509436,0.6904626083383221,0.20001655507286098,0.9631019006972039,2.678395160057576,0.7502481315106352,0.6787095318788594,0.6691263147028205,0.973911479676507,1.715955447158016,0.7617475256592836,1.1710644159987693,0.7260210037373898,0.3115507948755574,2.6199844654408735,1.0231222125617039,0.901487646705332,0.37743110375857203},
{2.0366665880908434,0.38940332391637644,0.6788632297361925,0.8051120220835845,0.29657352954893157,0.7321934618764879,4.015887534283641,1.0285215141786643,0.2919058807253253,0.6200124862194268,1.4027924817809354,0.5958637779025944,0.3065695901026798,2.4679411881268227,1.1967956351214155,0.7815836603174563,3.8933926835336914,0.5260034581639205,0.9715374057198308,1.0981346339041282},
{1.9566203042640702,0.3698639134042412,1.606749284920834,1.5451102658825926,0.5123822599340315,0.987630365432294,3.016681299297812,2.4797025424382633,0.543270508355189,0.47527026488651825,1.641333081090332,1.7448800994415634,0.17163008586326156,2.7932256559872917,1.3413025127911562,0.09985745658145923,1.8099906300577484,0.7330348848427121,0.9567692802193758,1.6860530678873844},
{0.5085993220152875,0.6961680680804825,3.2517706882560296,0.18124906410707922,0.007409803328058406,0.07625311327288897,0.10312304156277372,0.15866668888519161,0.8369537268401457,0.5303657769773326,2.2547120611224325,1.7539587204214944,0.3503952666296709,0.8185931142203633,0.841894241606078,0.9465957132605302,1.5010608145729327,2.2350821693242153,0.4882221758612755,0.8367059338548399},
{1.5006848059955764,0.36688481157720754,1.367582830249724,0.05938817397119577,0.06600898953247125,0.07496186894046752,2.2685206757235874,0.7610860328917315,0.14033404625250012,0.6448585159681269,1.193847680012139,2.8301904703975747,0.8809317442190376,2.882814113136828,0.29970135345785087,2.659969933116647,2.2876128926844483,1.2066615658420978,0.1564506497429824,2.1334812639543275},
{1.0157046733672253,0.5124126134172583,1.3560612832041217,1.6060702429855815,0.43978645262421556,0.3460871879501294,2.2033060838060807,0.6695967966083413,0.7771444847551122,0.21971011086266312,1.0433161253684413,3.3056796684039726,0.14693525946303543,0.22214311409727597,0.5237168104424335,0.12770234704337868,3.7862073759019754,2.1181725935081275,0.7690491534769182,2.6556000032785914},
{1.1124924499895321,0.4598827481855605,2.882011922709666,0.4633034639569801,0.303700056840552,0.58873982256025,0.3918130666022261,1.1080865426171043,0.5138390831566854,0.7544027251258737,1.2242279346283753,1.2579915914329685,0.27396884605321514,3.1242906171426648,1.747772246705469,3.0265395917641236,0.15306949405342296,0.15376511511614507,0.9506456894834094,2.6347653743538504},
{1.4202787992138501,0.46655686691138876,0.4075506552468893,1.3267953215727142,0.3927317606225954,0.24210665463032477,0.17327264664647088,1.9991922271148777,0.7734309553320683,0.41726769373067485,2.131133172301698,0.014740733595555966,0.6463953859685675,3.0925703316980986,1.6856288542333924,1.5486142709257187,1.1663292458241468,2.5956189331061656,0.7045360361458312,2.1452162130895416},
{1.3318713234953816,0.8092734949582553,3.896000271484899,0.6786855987395883,0.9442612556041317,0.024820024666280194,3.2580761030721854,1.3481774768115529,0.5881544060411144,0.43608337273040665,0.5045511138977554,1.41747644441234,0.11450929320540826,1.8339651267808947,0.0074714862365502,1.584796274344878,0.6174576771877476,0.7813449568468254,0.725530521263592,1.5159913400946536},
{0.9638709985210245,0.9484247530704975,2.6998853793961706,0.811124139609969,0.9406472957158557,0.004490389300134012,2.1095321565229845,1.0665323828241118,0.23741535859113283,0.29160773651408634,0.8817933505340995,0.844227296003099,0.9923731723271826,0.42872132799101487,1.3106046160805878,0.717405861155034,3.537325420353284,1.9188915395733033,0.29566668436813015,2.257652413377477},
{2.109101454476538,0.8474943700929509,2.0563832227316112,0.9515107864785126,0.682859596122969,0.40701146696982227,3.014876302301357,1.1645496110801021,0.22829857316048097,0.04811009166195579,1.8777172634427814,3.2349246716221933,0.1841658618596611,1.6722906526532102,1.4152336415705344,0.7337983768562701,0.7747593610923276,0.45626328603666544,0.1770326772523937,1.5214402550005448},
{1.3573278808166325,0.43408897545522607,4.022602510387768,1.695482502248287,0.05200081794806821,0.4596812182913915,2.0555314569183065,1.635474896636023,0.8697888301356616,0.849495795359688,1.5534584841465773,0.43929350725269817,0.4043284461008283,2.9847790201642628,1.373105570431791,3.031364585799539,1.1441191889724647,0.9022122246695029,0.7155362814444463,3.396207446294991},
{0.8248786329234207,0.7512284741886003,1.824285985536279,1.0648767880417809,0.5881184646735995,0.6934408780934554,1.107858664421979,0.7846111677691552,0.26003018401442857,0.7350717331325027,2.051653481623666,2.2494214637915926,0.2083851249754447,2.8279915663355126,1.6018305495490301,3.3025172434578023,1.9947789883030507,1.415550332018023,0.2577760357804145,1.6447429849916404},
{0.29021290397360405,0.4107828528078886,3.6670890366810265,1.2239167992141515,0.6971547455499338,0.6542530638788507,1.5864959435759856,0.8763020058174977,0.5075720622094939,0.0989248389993358,0.9015757165988929,0.6681280592067401,0.5746441640243896,1.0104512149280098,1.0916534795260142,3.398630078445459,0.259176501404829,1.157686493661004,0.39753517110644065,2.9592120465063108},
{0.8342191703821434,0.3651701668729649,0.824624328656594,1.7447252258663102,0.38448235187152857,0.7963217338379461,0.575022156560109,2.0438513786757357,0.4924700557008497,0.47038027022044004,1.7625586688927364,2.5064561782615784,0.4316708034412431,0.5337694955180063,0.030176813656711442,1.7056886077902778,1.4734349169105996,1.9901098191345263,0.04511827411210678,2.0231189740737223},
{0.3409696041144932,0.9508518820374914,0.5347743194362308,0.21099933473916127,0.3166792695668559,0.6209701554877569,0.00892500016420374,0.8614287736178035,0.04556197016835406,0.5473759182084066,1.9466820011079853,1.0984645443645078,0.8143818941964963,1.9923454797983342,0.5789109525224475,1.8306211552902958,0.9610008676925034,1.660960036547264,0.04651580203608252,3.2236172687336095},
{1.834013318205254,0.12140839289937744,2.7621481553150313,1.0632616096823313,0.4864693839814045,0.8557135206268479,1.2686224467207148,1.3111423186127285,0.9663763762914632,0.5631305506516961,0.29126548845462713,2.20066528654463,0.7334994175392757,2.9643362665010073,1.1016341724436391,2.1459159508969656,0.4672622761287283,1.7717613896123772,0.09065243424914282,3.339154495931665},
{0.36019999320816776,0.8684398218758955,2.65234550984334,1.2781972209930235,0.17328566762458553,0.4438651724943006,0.7373882298722025,1.785270044191883,0.38985002347721287,0.2308723696979621,0.6618844399183238,2.8460014146341917,0.8949215792067502,3.5564996743259445,1.4525049406326649,1.611659053243985,3.2456846756296636,0.7250435999993924,0.10357775237425726,2.180896288183516},
{0.3356587851397343,0.21971532535569194,1.5557045592037912,1.1872902901665046,0.3593643961527202,0.3301753414910332,1.2735772895684594,1.3860722394602694,0.5161890339959523,0.5138851569317437,1.9953812948154843,2.584060085326558,0.8849462420197838,1.6120304003231334,0.61664833170675,0.7546057491110709,3.7514752157733833,2.368647996366672,0.4032630947917729,0.4648432391515877}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
