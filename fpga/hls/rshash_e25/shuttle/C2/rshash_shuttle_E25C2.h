#ifndef RSHASH_GENERATOR_1_H_
#define RSHASH_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void rshash_shuttle_c2(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_rshash
);
    
#define ENSEMBLE 25
#define DIM_MAX 9
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -6.133982010631548;
const static param_t delta_rshash = 0.1630262361817786;
static param_t rshash_f[25] = {1.9787156241476416,1.8042442563294498,1.2672688307722195,1.3562439629369345,3.3281380468654977,5.316961400191078,1.2084565141679444,2.2189577768162687,1.4148408951120282,1.437500013377269,1.6327578041770912,1.195056834536628,2.192411981767812,8.263401729655017,1.5737326160239753,2.406500874340278,2.4679424829279886,1.5515390158360893,8.129029028247734,2.7220641855177123,1.3210077234435678,1.6952448588095554,6.502945732937029,1.8162652054154025,1.6161711599892619};

static param_t rshash_alpha[25][9] = {{0.16339594871609087,0.28538985210329326,0.09012836327626157,0.02807143193168502,0.09833617472136831,0.2993773868557316,0.3211701137630426,0.10833832702794728,0.3346156496662528},
{0.11135210110687556,0.24877368494600705,0.4029704189221624,0.5044828910418813,0.4853534650917363,0.5376900559012732,0.49768621620079706,0.4592701482371123,0.4412308204328046},
{0.29800366157528557,0.07239815629981391,0.12020658120986225,0.40783640577442937,0.2905279416766523,0.3632064242253464,0.2639112884235259,0.674331771132123,0.6034728912992361},
{0.09881859865016134,0.5534918585824491,0.3248726929008,0.1024929638987814,0.20157302641903174,0.48803728673269425,0.6432191518471132,0.24521105134707738,0.300159729073386},
{0.028386725601194394,0.133791254050521,0.031815576460189315,0.12863083630012512,0.24233047804992336,0.25851303508879675,0.17161689573725605,0.1676913852977144,0.12845824879359613},
{0.07958463709060751,0.036125248289406074,0.06619176026707264,0.009498934785737233,0.0704796937780998,0.05901063919614665,0.08738386255431688,0.04781052576506232,0.13056314643195946},
{0.17553363023326968,0.4872883982037421,0.4079509818125841,0.5815543174857459,0.6002610186106272,0.4584916567683544,0.2864955661006583,0.6222344228492975,0.07613561630474794},
{0.08282260841564341,0.36960889203677066,0.0015613604033068668,0.009910061130375765,0.006100052945476322,0.25679522328802235,0.2058402915745441,0.4233051092975801,0.32184726815716147},
{0.6500768732920451,0.2872848162799743,0.3607711822669849,0.09345687605240838,0.3534168035190555,0.38848564463536833,0.48339207383525623,0.05604652502802019,0.45325371069972437},
{0.25443144665918666,0.13873294943605355,0.12206698533839977,0.2747954643630361,0.6954358226083989,0.4166210118588277,0.4172673039839911,0.5570874932789018,0.167536627222958},
{0.030226264404740556,0.20956277141650845,0.5401223983129123,0.36783067953293924,0.016241251985028366,0.5045159183847058,0.41067309879154,0.2179130388294659,0.2311901826655005},
{0.34779998988712957,0.4247709034814163,0.03914763576376028,0.6366994614319899,0.2731282032154626,0.575694396594853,0.6944936153585418,0.3614576490025553,0.17590750503923733},
{0.4003575451528073,0.34831168272964935,0.12799135865012987,0.2873163951877356,0.18584306907607925,0.018589030535201428,0.37948532291657705,0.22549252193397804,0.3111555180913103},
{0.08672879397053343,0.0814292306547036,0.045409302582097286,0.0009539977783042186,0.07501259634425222,0.11897546984888267,0.059781076224236555,0.004257759820053548,0.04583796943428353},
{0.5427416148916302,0.3779632809304248,0.4384324135153506,0.2917576200254154,0.08581817075495471,0.03717182478567708,0.1744841955862857,0.0732078698387689,0.3572781293917217},
{0.08481511144590392,0.13944429891275567,6.222660064180709e-06,0.21179968322307113,0.4122583624095533,0.013275715381853816,0.03670202569514734,0.054842178431120214,0.26427920023137097},
{0.30248553881493634,0.08796237063889402,0.21716800701108277,0.027262500761304154,0.2959962285424797,0.06190329113258336,0.1994760415762242,0.3967059218314014,0.39481506044397124},
{0.056549431813937075,0.5167207989372524,0.06434464784422184,0.024899386733053017,0.6188222925195991,0.21022845107091892,0.538292069478201,0.44222552516572455,0.5930692058501358},
{0.11782503086330089,0.05054950334147727,0.00694079252915102,0.10143576011427051,0.10677873930497153,0.03172141121525061,0.11063379176047926,0.07879790907987616,0.0366493750433243},
{0.10846688532640783,0.28332178108201017,0.12334633212346663,0.27314530813183824,0.23741147735265639,0.005864012457750105,0.2639045072138317,0.22305587435567614,0.17475830211931048},
{0.17912371358438406,0.5637367312420724,0.04010212086384278,0.5636254196300641,0.1348642309608535,0.5752657509192076,0.6943490390603686,0.12231337712681568,0.43361454075561323},
{0.179551609029051,0.28001235087183085,0.21846989347293538,0.12193769715870166,0.22662301507473612,0.5881162860555781,0.3747164010811158,0.29295032366533896,0.037546415823881574},
{0.024258856576478287,0.13076719589182692,0.12554833171535343,0.14691651622659388,0.11216543741146089,0.09740986089999963,0.06078285866055349,0.039226186083194614,0.09005197734898787},
{0.11596865882548292,0.22466780674210798,0.5311121471036575,0.3478146302363435,0.3903369920306701,0.2558575694988358,0.15103823113698212,0.47405725335347476,0.5452645337354868},
{0.10349760888580904,0.11303015137466071,0.40286936178576843,0.43318368217259556,0.2745502623967299,0.10219218365368439,0.5685190762281948,0.5300605673457026,0.6024369942576254}};
static param_t rshash_min_X[9] = {27,-4821,21,-3939,-188,-26739,-48,-353,-356};
static param_t rshash_delta_X[9] = {0.010101010101010102,0.00010105092966855295,0.0078125,0.00012871669455528383,0.0016025641025641025,-4.231371387466678e-05,0.006535947712418301,0.0016051364365971107,0.001607717041800643};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
#endif