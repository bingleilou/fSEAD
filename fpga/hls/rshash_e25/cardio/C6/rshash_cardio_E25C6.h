#ifndef RSHASH_GENERATOR_1_H_
#define RSHASH_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void rshash_cardio_c6(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_rshash
);
    
#define ENSEMBLE 25
#define DIM_MAX 21
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -1.3833949602465134;
const static param_t delta_rshash = 0.7228593631870723;
static param_t rshash_f[25] = {1.7257420998628619,1.1874227890680789,1.4249567702942008,1.6637888513358585,1.4740283825813516,1.2631199756654117,1.344567600814791,8.376231543574356,2.601559503006467,1.1705391260740012,1.144795348016591,1.1681726632521556,2.8180135680065668,3.925403063035766,1.590668272186825,6.422964057626744,4.298254137212372,4.824864752956083,3.864330270085709,1.85419150171202,4.305295004133363,2.1599645763638216,2.252287177613007,1.7177357011419032,2.412843720058305};

static param_t rshash_alpha[25][21] = {{0.06066709609928723,0.28928515772720487,0.399669092593799,0.37638836956980354,0.035477623762362666,0.3938514293452041,0.4575232176436146,0.48733561171672385,0.34173924750391466,0.1694482806484718,0.4587113285276378,0.46952911501466127,0.053251628511497257,0.4707995281650685,0.56694178066209,0.4148373154231501,0.4106986131532797,0.4696998148039589,0.34203737801089534,0.40444933011891,0.4527943574482713},
{0.5695942356072553,0.020719942069653823,0.30632595802346646,0.5305457092431805,0.5729352363188994,0.20749251343690125,0.26666713428117295,0.5762669830891546,0.25166054783681396,0.7411133391374103,0.6976478004368396,0.6056169692162786,0.6762856435415956,0.0210813686638776,0.3199535813356407,0.6320665913992303,0.0567015076941955,0.3835275854984018,0.29874786489281696,0.7050073385976886,0.5194972734306754},
{0.22670009513363196,0.43551580147001767,0.3627476022720202,0.5677088611355142,0.38881167486994256,0.034477702893177004,0.0078038464179139,0.04233550466932897,0.5185935212105619,0.054554778627702555,0.34583467036142385,0.00965626048076255,0.32670083781035697,0.4360813025542597,0.6941525910092308,0.11115707440401569,0.30582706621967837,0.1897636694437963,0.47299741930859374,0.13345933817884095,0.5120803629609229},
{0.46990284800355325,0.10359084164488466,0.29818535747841945,0.3362995682360136,0.026242718770751988,0.07556987344638512,0.4064165552301921,0.09219176460627775,0.3772358073240829,0.1821914210315801,0.3815201045152999,0.5248600632742264,0.14361546225857846,0.10228441212000404,0.1667570003388536,0.35779507815362127,0.5459164777213376,0.45876978468775476,0.18030493805752426,0.24684363206292012,0.2154610988072516},
{0.6174092020259673,0.5795713446753148,0.4093233940026323,0.19312422803742754,0.5935964374435597,0.18079563231919488,0.3363846011218061,0.12058169150289695,0.06063933584085584,0.03827977358010846,0.10949918375892517,0.6609231315441048,0.2176764006838291,0.5921757721247699,0.30909092866922916,0.520791204829558,0.13755979666757145,0.23570640870403112,0.18402131510277342,0.5643349395626764,0.43634020830035536},
{0.18306008609764984,0.003256935060404207,0.4537311394930554,0.12918010199924054,0.48855666033169276,0.2184601296787546,0.14202990744869287,0.7305782217807486,0.0729211673467915,0.6075934775411188,0.7496585805801019,0.2271503628507386,0.10743402561675526,0.43140629792684015,0.5870101412651781,0.07889765718574875,0.17620467409837512,0.6538225424477313,0.6336676071791773,0.7535139865079884,0.7687419494262298},
{0.2619492812759525,0.24226393652286793,0.728364674615349,0.03412258273486005,0.3458708573146842,0.62914029844681,0.07137783323707812,0.36816364516192274,0.0517883477857624,0.716406558050057,0.6485690801077244,0.6420829819600653,0.1525144535991498,0.5740866510773723,0.6403631590008048,0.08651649391733295,0.06524679536142976,0.07990679702199661,0.4952028151297263,0.0645627194684643,0.5119993984594594},
{0.0405363314441074,0.04665557214806375,0.07284053727727717,0.02391971492399947,0.10427355631217027,0.039356257634364095,0.02913819059451137,0.09116317662882924,0.07452183431081262,0.049382762679799935,0.08728055996755563,0.09107969541630648,0.07865231745857512,0.11376541703328023,0.05760773843027273,0.10167399253470193,0.052664404962864036,0.0592148775193184,0.10402371197137832,0.04595775716169757,0.021286396901240748},
{0.22081190037451492,0.3114266668256193,0.2536117384673372,0.2339745547811173,0.3329676368878252,0.2158386241718516,0.35544448448356786,0.25030739863694723,0.0892931282799062,0.20055478056128903,0.07359303436778984,0.19150851463528928,0.15096439334739786,0.31129219272740444,0.3772539554503938,0.24255708449662858,0.3410004551068905,0.21643875677501842,0.15006411444889467,0.11864208650533814,0.02768021919196547},
{0.604809716062932,0.5138334049002321,0.27635298465234254,0.004035460260237293,0.7909138157533182,0.8432405083444783,0.19550064359520072,0.791253239864792,0.12295011933075925,0.8462630388361063,0.29530842773698623,0.04377373495799268,0.3207738015705343,0.09259842322707665,0.7841837249199004,0.312791098184783,0.1291336839612072,0.04221865627912435,0.3593664324619037,0.5155841989942845,0.7453327364505472},
{0.6451504072965303,0.18905012802999252,0.07468603860096065,0.7823664202098667,0.09064066714107545,0.08533965593329745,0.4010030948033593,0.3104476181907019,0.2156563616568725,0.47350953791140665,0.34019734644828076,0.8305448838929549,0.7625469015017048,0.6362435821815262,0.048987469420452893,0.6670519547119873,0.3820967232918492,0.5377700403236156,0.23757679956320754,0.49395732460842123,0.38788426450531155},
{0.5093601623874201,0.8551242958858524,0.18019825996162117,0.3582086412497003,0.777241555402232,0.8387904180110877,0.6614901862802682,0.4762790920862438,0.43106860410525305,0.09959844920141218,0.5677068673457024,0.804483733746801,0.3067038593592231,0.1979420584551941,0.08748757186764039,0.6880772759480637,0.34814553678265564,0.11037881030047819,0.4545849683950761,0.44697570094430156,0.5863777311113697},
{0.1888696822873868,0.17470144902426107,2.48237697289916e-05,0.17289105177752953,0.27012499851028865,0.018834395490736143,0.3027392707194113,0.04763759938192639,0.17139731253705434,0.03844367403843484,0.11224836480882167,0.022761843020511156,0.353427019134592,0.02791098358791673,0.2224931096558643,0.1298941545177513,0.2926375240684976,0.1586192591793491,0.24202818313919888,0.3538053128974356,0.2611395535926888},
{0.15038641129058042,0.2329116898275006,0.05184305124218284,0.07574133153822676,0.1367024974922318,0.09392698070142635,0.09908655047770444,0.016327696597171735,0.06362503472290428,0.1764005544788402,0.12971271485313407,0.12022996051358129,0.23750273464958735,0.16677142953237306,0.23325934130814338,0.11307735007716818,0.1431774126571606,0.07528767456760076,0.0910935534798759,0.07650119461718582,0.20500620952696796},
{0.38938662452163086,0.3492184681130958,0.5050208484143748,0.42472915759725904,0.551676467282674,0.2854496541533449,0.17007079307173503,0.089234155406078,0.32668699149316105,0.2261427021234474,0.5755115506801106,0.1647710239034339,0.5364493201034911,0.510269497381206,0.24432501616072932,0.5478003748918014,0.35415108742493495,0.4123647603889407,0.14448363319717464,0.6200568634203759,0.06838451559379388},
{0.02764845167679086,0.12154491512793755,0.06013385269311539,0.0709331299221192,0.11099295864963046,0.1358696492162179,0.1518013129639254,0.03299712491450878,0.1399663419688889,0.08333505209687142,0.033041240353977194,0.0567752778097342,0.012380955475369616,0.13375208484127377,0.006048725209015705,0.07368992873969639,0.07734449422747933,0.1030153776485465,0.09942384951699416,0.10664683788556398,0.05883058697838344},
{0.03289981735017211,0.14611084894247062,0.020819163383137936,0.13119392601025634,0.15012506590558886,0.132613112607379,0.0975807280898448,0.08976301572233579,0.02857053426489992,0.21314148151318726,0.09289004169204218,0.20210347756936892,0.05530277861508006,0.13660928715276158,0.04710874109617055,0.17814925887738164,0.056638802923812535,0.09764872096633863,0.06910043089673097,0.16967242289516943,0.12729446048370002},
{0.06109525385252055,0.06372339711118992,0.1659233883478456,0.1831754793449651,0.11364147316391024,0.1722071669020693,0.04707538921793951,0.1570543696750115,0.09989664359622222,0.18545311841005452,0.0165370839981405,0.0145703515954339,0.0031007508288183453,0.15633091851107755,0.04311662883569076,0.16709602376661922,0.17303709078949642,0.11122364623012997,0.08494886423519604,0.12371408689488914,0.1345373642217073},
{0.06495977244078589,0.14151648288016652,0.03496668298397709,0.03262804173739933,0.01070548021206106,0.18140552874314406,0.10445507115460205,0.16499256032597803,0.0014550260613098711,0.09748265499674023,0.14730975025579704,0.003745992997423069,0.1318076068663855,0.09700708587074486,0.19660825670053894,0.07381440292618549,0.14529948973298018,0.06124736626536127,0.2404706720541589,0.044813034934615706,0.08003679026329752},
{0.377017268367739,0.12272498651466211,0.24780646411077856,0.12965032309139463,0.32013814688669495,0.2909311373661684,0.10327240120498105,0.41265284884475534,0.45118061018930816,0.23090321705820993,0.033358671412402764,0.04331231478737441,0.15191645945838586,0.35862757307303184,0.057308963635993505,0.5233388197277752,0.03285548143555327,0.22718230819775231,0.017478716147748458,0.09854519924140605,0.3991495257907258},
{0.09125614647890866,0.13012792800806444,0.020837382003620248,0.03853474142818997,0.03042098790372228,0.19671489125191974,0.18865949707939686,0.05592618976189778,0.009325286939914811,0.14973738904915562,0.12502771131443577,0.1077144680816532,0.15024364102357976,0.1612485002660877,0.2240183706321378,0.10125524516193249,0.1078002940509024,0.026774292087756005,0.15121207157879238,0.045911845976986825,0.0408031987729401},
{0.2862092179808209,0.2794059696995071,0.32593323320189627,0.06815290987899272,0.45514608187807487,0.15473708420885088,0.21355648037751435,0.3347665712359163,0.4225105554001246,0.07230712058111133,0.23578541829403055,0.32015782154728906,0.38869675839080464,0.17357044598584,0.1346865071003516,0.41768719889330314,0.27690616776092636,0.23978993084195044,0.05074469110045221,0.19036497570697522,0.19872054149138163},
{0.06865695688078904,0.19294535711000632,0.22767774199698793,0.029330265554581736,0.4028264994275251,0.36327169738294424,0.18764359848484147,0.43428616955190635,0.025596592213933983,0.39611299725336774,0.3741791123601946,0.30687504540007104,0.24563185708138435,0.13757152138934753,0.13029587304468593,0.2617575205178037,0.17260625952713657,0.10491743626246654,0.27914382346337674,0.1372568248225325,0.3804228332611427},
{0.5671175167913596,0.5253553978026223,0.14044670490941955,0.4821798038331548,0.40681033965006486,0.3361531018720176,0.3665505941291135,0.02924821076084133,0.47260360035064514,0.2852700020565103,0.21022493950709903,0.05224296451630648,0.01809328863913409,0.320749209589836,0.4217543045841503,0.030116374669655537,0.3437299562320892,0.5059104450903195,0.4128829819939533,0.39363370138091897,0.36993101387775656},
{0.028203936933540782,0.08596284460564574,0.12173183722066817,0.30296380453079524,0.026294907056445115,0.18633738567626068,0.16049605078600426,0.32190671695958384,0.012530641175845512,0.06910325468171734,0.17225050410773973,0.07361101390984598,0.23580997654128627,0.28503324171978106,0.22700508624679874,0.03587041034879169,0.17133459083905173,0.13424470807210814,0.06703288072957152,0.3850619384064356,0.19579727966387417}};
static param_t rshash_min_X[21] = {-2.746330647550977,-0.9199884374438398,-0.20364048566636067,-1.635871141309735,-0.6835984744007735,-0.06140064449540183,-0.27829494600614724,-1.9495717445965985,-1.441358488528391,-0.42048734791506204,-1.398087924648133,-1.8765244994087826,-1.4398413651943174,-2.325378561577513,-1.441407750185039,-0.48827888518542284,-4.567897329062897,-3.8293160555105947,-4.113439081421025,-0.6905897475230182,-2.1266054668088588};
static param_t rshash_delta_X[21] = {0.1750050751949002,0.20507768944038135,0.09868759942952245,0.19157113079326857,0.19997965696857142,0.05009571399865908,0.11279531203908376,0.22287053286338301,0.126980473929281,0.17655784941397185,0.11587612044978589,0.21338726397232247,0.257438263588967,0.15673583076011613,0.16149567346856478,0.06890082523104071,0.130981290338828,0.14368969105603885,0.1330241720960372,0.1113004489272115,0.30612654157244695};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
#endif