#ifndef RSHASH_GENERATOR_1_H_
#define RSHASH_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void rshash_cardio_c7(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_rshash
);
    
#define ENSEMBLE 25
#define DIM_MAX 21
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -1.3833949602465134;
const static param_t delta_rshash = 0.7228593631870723;
static param_t rshash_f[25] = {11.250484725717662,2.7909471820222733,2.38918188105923,4.960706095472207,1.1635248330918118,10.917035508186071,3.874813901093536,9.240764968658912,2.7544395818501086,7.215730389520277,3.3222822163873142,1.106087409721638,1.4442357198358127,3.204218364757681,1.4984008216107685,2.830077169717418,2.5914539019515717,1.3380399252367619,3.1542305547911487,2.302282091399073,1.1457236130316744,2.0537657922513124,1.701943874909883,4.527594858748464,2.2473920686217004};

static param_t rshash_alpha[25][21] = {{0.0842434354379476,0.0806401473272309,0.050211265537816054,0.03352496865208082,0.016590401655927917,0.02639441703638079,0.014908949258094852,0.0046240928399573535,0.0741536946327753,0.005590588878143754,0.04132705585574763,0.005110668819699213,0.08002813839952456,0.010869617976886405,0.050906394954429536,0.07970047020418337,0.08019640912282794,0.061075116827181974,0.04290028454541091,0.04470383296467691,0.025874998880785385},
{0.2537656082503305,0.16637337911181738,0.3053193896123141,0.1945772006927496,0.003281851753633646,0.26798874231559555,0.04107513409259289,0.30288426607735086,0.15070321679822846,0.3165102867458963,0.35331393794606114,0.1844861259717478,0.006007371652213328,0.1583581445612482,0.2640656975123458,0.29755606486957825,0.001922969392838412,0.14395492044404054,0.18671266226200503,0.13126685025893897,0.3266321034059395},
{0.02397111822668566,0.2009404794515368,0.23786270278154242,0.1864972807297646,0.0603857522651698,0.04052153007745093,0.05089360878688281,0.21777897267813903,0.1930298399720079,0.305744863332009,0.10654048859391715,0.16259360498576247,0.29943118869667723,0.21036881549332231,0.25314829062168465,0.23576260349682515,0.4050860652584667,0.2881778480829902,0.12451889535131223,0.1767187960400595,0.06355734438938279},
{0.0054788216797061985,0.0427152734421916,0.16297426223747966,0.181719867020352,0.1311482321746755,0.08899856173250209,0.18018719668461855,0.08093666209040884,0.06511164832916368,0.16926225203420742,0.12271025091986301,0.09217262192671226,0.16770627369896227,0.1039791106208571,0.05296525383976737,0.07132069082049788,0.1624500440952791,0.10204422839960249,0.03890404905269342,0.17289690333875082,0.18394112997583587},
{0.7345339770593791,0.3731910303337587,0.13323727153595782,0.7631330173461588,0.341668943344462,0.16605466009266037,0.7695974425256801,0.23560983419121578,0.008698493680837076,0.7469496035550687,0.6909721739840098,0.25038956205216034,0.03974640530857895,0.6221877933097527,0.8432301720536179,0.03482721299983186,0.431825118858088,0.8235869354980088,0.08589152375804636,0.7932220135736049,0.03937150824749847},
{0.03256551249102577,0.040281053796316316,0.07509693051475504,0.04633276822797614,0.07845255766387282,0.022624663658920807,0.07093809025031711,0.05085973466997578,0.0649098244761303,0.09026611668707887,0.03610994187865574,0.007893587374282805,0.050816084568196425,0.04685133056766387,0.0111032755372348,0.07914959111734872,0.007012734486726049,0.009570107761078289,0.0802277561112411,0.020700887729249065,0.06215698982618386},
{0.25100816427817374,0.18060057618386163,0.23928061242381973,0.08428684926451717,0.11824306117487803,0.16499200935581848,0.12335021770595014,0.11457216520344023,0.24193004095847773,0.07934486342583913,0.036643365935913066,0.19278710523496662,0.12853419606835956,0.12741932117239452,0.11489946956488514,0.03157867382319553,0.25026694586570714,0.23626180064213573,0.045035521928932024,0.03933655893925778,0.2233867843826193},
{0.018398736340162425,0.024794432018832642,0.04277623318981125,0.06809141203415814,0.03396782224425899,0.10506726925687424,0.0366671706836875,0.0689110268748417,0.08382917317861079,0.0631831034757938,0.06875328864226839,0.061908822843928075,0.04099878112084339,0.025245104890626608,0.03587713184032284,0.09016550071091346,0.09354341265522018,0.053682670209459715,0.05385592736929333,0.10494279192529835,0.013457996728423604},
{0.07516834817328082,0.20837157492072486,0.2788841635900141,0.3297937016389314,0.1484301157440439,0.3062581670883525,0.12337392141383387,0.029673914432268602,0.19070864755742778,0.11019590706369722,0.1731860314434498,0.029004550926190344,0.2831973569311685,0.21586864707231687,0.13030320842823997,0.30238109782020434,0.0940212082411973,0.09433865809365065,0.27108819893398767,0.3267695534914526,0.16394579445871696},
{0.10863609444096697,0.005657719877702426,0.08158664311618877,0.11086734002106911,0.09036082385072931,0.11862397019896849,0.07338357451177631,0.10278464024937946,0.12265051769752706,0.024559388581826855,0.051818681596482605,0.010496583108969736,0.013161958994408807,0.10180557560374855,0.11576683678989969,0.0031801933306285944,0.07949348654632543,0.06179504075845726,0.0421667657387084,0.0973281439376479,0.04252608913160383},
{0.2897436897256691,0.19727875864929656,0.21256961157465046,0.1295810996630296,0.22982872272145474,0.16437449653372513,0.24830835373675095,0.022687491686728296,0.300168708958068,0.13803899481153084,0.06891051038581902,0.12984709751083146,0.07159613676374718,0.05333441520920928,0.046150315250335694,0.24299799321793641,0.13256855523013183,0.046431285660220756,0.1124793883585209,0.1954646565333207,0.16313904793579356},
{0.5185721232456424,0.8821355665741561,0.8368701328360468,0.8766285094671488,0.8315681296774676,0.8937071082804918,0.39168087624441333,0.0009851223033391704,0.06899365912248358,0.4220202994613999,0.8764514164671294,0.036421664431923746,0.796133631615898,0.16970598950605809,0.7515110453403477,0.2073075123007369,0.031288601187008415,0.09367860844436045,0.5674157000033804,0.5913518144356307,0.1230054237738933},
{0.2841315852310953,0.2801332391301511,0.5763293512770518,0.5250973951386667,0.13093702235849813,0.006761824835976299,0.4011384725457432,0.4966608605455572,0.27558532115804785,0.6129982324086208,0.40903861221980053,0.6032429912722999,0.3551569653586878,0.6555985420929545,0.6434483771591809,0.6608069452684646,0.02985383442879021,0.24400900023741814,0.21002386510762922,0.25267219833077414,0.16080099146066112},
{0.08849246267114207,0.17892704283210217,0.03674662937743314,0.17112188374317192,0.22641796849982065,0.20775667439723117,0.10161141000298093,0.12408733414462222,0.2439209660686787,0.090667652548494,0.04713210845149065,0.16983802936327713,0.09236261600791416,0.03869595839734519,0.007396968424081946,0.2699948764060379,0.03184211384280555,0.10831869072553459,0.10319857351377837,0.041586811845026835,0.18188113714663917},
{0.10357862936270434,0.2441276009612028,0.007462090802130949,0.15086519898144357,0.09440303115050043,0.3371355892590739,0.5867691118507926,0.33950716194630526,0.4029950699188031,0.5890692092092387,0.603244239543106,0.008307690015352755,0.3133880841504276,0.033298672396770326,0.0020685609251180227,0.1423154950004554,0.5599053994075984,0.01876559674556405,0.5051700520853498,0.3504004210296782,0.512530107978659},
{0.3231374952210692,0.2775612347149236,0.25592563867871504,0.3144243984736399,0.2661326637219905,0.2616727700718352,0.16080549562511798,0.1280845965054508,0.15004702551196836,0.23519077732110447,0.31494013884055305,0.3020544148792347,0.3258800868562266,0.23186890036814875,0.305245966703594,0.26404708646466146,0.23962813806206817,0.1452394348009341,0.2987865204900399,0.19895042580563105,0.04967754946317862},
{0.21918187723716828,0.09970794654350187,0.12202425895112046,0.0032330661063062005,0.3632373799598811,0.24002246552467066,0.18178183778231985,0.32240720568158315,0.3832246268176675,0.36872108424106786,0.15753849142306267,0.37757424052004823,0.20683021087166406,0.2698631755042215,0.10663792324042774,0.023993315085764095,0.3548033942926627,0.05321844880068158,0.292367345791984,0.0196224542410719,0.3765037282529005},
{0.28882259736736593,0.6300536264182559,0.5019702473051247,0.7324375720809169,0.040153774833839605,0.501920552837972,0.6284903394168785,0.24839905693227227,0.10218865965471537,0.10836070604740851,0.3628833989733921,0.07734850821981218,0.44429897253581807,0.19607854708758135,0.47889453436998836,0.1472485041075976,0.3706663770720373,0.48111730074118164,0.516958346950616,0.4652143334450255,0.05153518855810365},
{0.24231845163703122,0.06245864243458608,0.06515937553989012,0.23201075857581702,0.018519355177388327,0.05345064787850765,0.2953329914045571,0.13780415638380336,0.23100741476775175,0.0798251835504034,0.3004295556457432,0.22244084529690736,0.0018642158816782545,0.1610345559849306,0.15198131818954563,0.24141378151120618,0.14770184495679814,0.009542111398055273,0.19861354112024088,0.31116821477582296,0.06701034235786034},
{0.3525491399416359,0.169407271996321,0.3602067511977683,0.10260416883864693,0.05188977135201106,0.014984328949924793,0.41103927474557944,0.25351304039483497,0.1482732332902918,0.03632081064325215,0.18870324145140632,0.17370295338113362,0.08967533376599714,0.3445968976208337,0.1267070660737586,0.1690185326634159,0.21848762408820221,0.25041393485187374,0.3981237107258847,0.06978065179320475,0.4181256926798919},
{0.7168441059599976,0.7976815174954993,0.08556862732380188,0.324811655433833,0.6380325745795007,0.639076975845245,0.753369397686448,0.15385558951921938,0.5352609557546084,0.03603174791443369,0.8284727287635092,0.06791601934245363,0.748286851397309,0.5327076190892537,0.5000610586898647,0.6660684939191922,0.22681337788512287,0.17393875866872466,0.29727599476763467,0.35552909656423715,0.1962887248250693},
{0.1205052771148105,0.47626213494866415,0.18755707696266607,0.3766124747002182,0.42670100761217544,0.3814643758812623,0.14757184723452038,0.13946271465346402,0.11073621693273057,0.00555354684010693,0.2619252359626172,0.003129862690004915,0.2755004528172403,0.30109885184331503,0.47895286850003643,0.3619630383913082,0.011831354212056113,0.028498185195938313,0.21147770003323055,0.12433886904491523,0.1454625741064581},
{0.24466861326586883,0.26497937282052647,0.24445510518105332,0.34230628471758495,0.46108487143225113,0.26188639835012173,0.2921953052746648,0.4744506182047662,0.14258410433148674,0.29441282718925627,0.46764984690363226,0.5295826488615968,0.27424952418540627,0.43307221572834087,0.036243977838981825,0.1683078051330852,0.2996612416088687,0.3519658302512058,0.3209081690860645,0.002363691744977288,0.1783861767192312},
{0.11478770540914061,0.12718465149013886,0.0941882006324216,0.10080584479046009,0.1840484860210195,0.20765748618889654,0.1762061802979411,0.05994589071246075,0.030714862586912667,0.03160602283313619,0.06731039202586472,0.06572709931593501,0.13594820623021256,0.10367742042376589,0.10883342869855572,0.1695733434675995,0.19736737545639188,0.17019343648916105,0.07463028047714161,0.1971387098999819,0.14698386356189583},
{0.2720498690944157,0.045674040450586054,0.13629750424545894,0.1866293682805883,0.2201692335352263,0.18484068971001733,0.027095937996830136,0.0961454080883054,0.13044077140349947,0.1152074044333456,0.255856516468675,0.13716266730494323,0.0534845785679387,0.34400807733210353,0.22141866025541782,0.3490012924021755,0.2675161417904626,0.0956456078654829,0.17837390624809432,0.19185277041552565,0.19414204250255201}};
static param_t rshash_min_X[21] = {-2.746330647550977,-0.9199884374438398,-0.20364048566636067,-1.635871141309735,-0.6835984744007735,-0.06140064449540183,-0.27829494600614724,-1.9495717445965985,-1.441358488528391,-0.42048734791506204,-1.398087924648133,-1.8765244994087826,-1.4398413651943174,-2.325378561577513,-1.441407750185039,-0.48827888518542284,-4.567897329062897,-3.8293160555105947,-4.113439081421025,-0.6905897475230182,-2.1266054668088588};
static param_t rshash_delta_X[21] = {0.1750050751949002,0.20507768944038135,0.09868759942952245,0.19157113079326857,0.19997965696857142,0.05009571399865908,0.11279531203908376,0.22287053286338301,0.126980473929281,0.17655784941397185,0.11587612044978589,0.21338726397232247,0.257438263588967,0.15673583076011613,0.16149567346856478,0.06890082523104071,0.130981290338828,0.14368969105603885,0.1330241720960372,0.1113004489272115,0.30612654157244695};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
#endif