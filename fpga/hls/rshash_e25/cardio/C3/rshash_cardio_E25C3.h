#ifndef RSHASH_GENERATOR_1_H_
#define RSHASH_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void rshash_cardio_c3(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_rshash
);
    
#define ENSEMBLE 25
#define DIM_MAX 21
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -1.3833949602465134;
const static param_t delta_rshash = 0.7228593631870723;
static param_t rshash_f[25] = {1.5607298713617122,1.2332527188032547,1.376564598366967,6.642034856917744,2.8806685730059716,1.376526274251918,4.205101375829092,2.2460227570021782,1.8701541675465074,2.608157203979776,1.291835373872862,1.8327749907086954,6.62558095785849,1.1038569259276092,1.495608089205879,3.1148172536980447,8.667907137058894,2.5382346333311676,1.1393453477629836,2.7784239741065178,2.9195569034031843,7.786100618596548,2.466122813120164,3.2803830458403813,1.6163309628457339};

static param_t rshash_alpha[25][21] = {{0.04569768671482597,0.47929165906643123,0.2930002007890888,0.07606479180515856,0.5201819151577266,0.5375691564452095,0.31877621221701025,0.4077048284833024,0.477598503538248,0.3213609716996561,0.2617667707459713,0.2830209640560204,0.34156474311636714,0.2957839604226931,0.590882979951456,0.08339588421819505,0.4029381390032786,0.47464313614330217,0.4095683986309708,0.08672158039049074,0.349884278536863},
{0.6102670218426496,0.7995981794630359,0.47243660117795616,0.7210759679683356,0.0947368426230534,0.08300240487363801,0.3870643261086742,0.6946409852179194,0.47978230013458517,0.339845823963033,0.1495622869227911,0.4053529143315345,0.1676791274046013,0.7839627179252061,0.2642296100918775,0.1099926211168971,0.18892534024254481,0.0613404825269307,0.4193643233848915,0.3050402086354592,0.5535621095044301},
{0.7257205089626092,0.6443560197201659,0.24056873031477757,0.1946532214288696,0.330311921940503,0.5826786707708642,0.018524450877693128,0.01801144541742374,0.12682702912871005,0.3815295296660219,0.66847225218767,0.6588760251678953,0.23002631329879286,0.03059010337174194,0.2742467860577149,0.16153877439757694,0.4371161963147211,0.36266546728431215,0.03312005644558242,0.4143212995331353,0.024217681127255312},
{0.08476916150732904,0.08098518548799233,0.01288045125524805,0.06920877137196865,0.13767026726823833,0.018800611970595543,0.133141012725576,0.09364417932184965,0.1190955602291477,0.1457957564707638,0.055823361444284327,0.061595395789797516,0.11505218488742457,0.053765464481716346,0.01272515313205924,0.10655290111867474,0.007070407530889985,0.10529960849639902,0.08240392022802563,0.13125907785958443,0.03542853072020354},
{0.04612174364081153,0.1262031482481386,0.2543116698058496,0.21660461297261666,0.03537005929901799,0.2084645153152478,0.2045954816659001,0.1648090038442498,0.27154995911523205,0.2715945536607831,0.21960549801262957,0.25238560046925435,0.2148348479740014,0.0704294620973042,0.056755080733533116,0.06436667044143483,0.2492171589027976,0.018043502153009452,0.20704734803543542,0.12523629827696314,0.2922011047341726},
{0.7193597652814224,0.3429166275517805,0.19172164756649643,0.47065305761178905,0.38099530381692837,0.6664329935009905,0.1721149424971861,0.19429120568290828,0.4817721166688125,0.08707038245073892,0.7210875205748981,0.27540983473799036,0.22870867128318342,0.0051776872372497436,0.5502355184339004,0.6427654393023454,0.12779387136820713,0.1426744654461155,0.38871354162017785,0.11468803159259085,0.16897802977065318},
{0.15564964737411344,0.10008868748174275,0.1521478766001345,0.0709784713711457,0.17452576889350158,0.016501280732574727,0.07677481634683385,0.2319388146464013,0.16280408130094712,0.010977353988825335,0.22048547195067053,0.037197085386890046,0.12202725312477403,0.13133937591418635,0.001827010914794027,0.1888767556382333,0.17229818437883634,0.19376523092748166,0.22952455670724842,0.08172335708823886,0.13173149389547803},
{0.004105007742357193,0.2725146789097757,0.40201761255341134,0.3788075191889535,0.2974427692528432,0.014904874019452757,0.04842110252087016,0.24611385846059505,0.10000917003621138,0.2424601410782511,0.20928267131365116,0.14901119818279104,0.1769636478306139,0.1399398991522782,0.35417424797946073,0.16021333794626552,0.1954375827086874,0.2525433704155959,0.44139611120960576,0.02240425407926613,0.06979881805073267},
{0.2190218778312077,0.3884257800079085,0.43279916110202116,0.3351445788821625,0.07920619358425166,0.515474923745004,0.1858937830076573,0.39601654481092013,0.4371763681025543,0.14477300409851254,0.370168816180166,0.22658178147556915,0.44927919195330657,0.39307485610665927,0.01611158837336329,0.35778001398874015,0.33420280055656726,0.16777416159617745,0.22740950242371383,0.2942026004268625,0.1427891574471545},
{0.35604948690873633,0.24042832068865455,0.1431016194115626,0.31631024224093457,0.2894179728872252,0.1135556335936164,0.23240719291386672,0.18378975112525617,0.06568291923625835,0.09392444996918226,0.1947096415901213,0.06593639285267527,0.3039864534931954,0.22218522341791244,0.23074913983722312,0.0004993503587969867,0.1428759653409956,0.006956135049938421,0.09774971209294052,0.30046004459118114,0.05518235067370842},
{0.6684653281133561,0.624797826366438,0.19558188332368112,0.7488912537427732,0.6454602407479924,0.48370878632207487,0.14596024687762385,0.41364134043348205,0.3586640081701434,0.589966260051074,0.15429629973689385,0.19322432064648037,0.4743968803786454,0.20004332372534947,0.5479033159576703,0.6485463863006214,0.045609976449734,0.12827083753837262,0.4583020848735896,0.0022916310307166928,0.5887887119079418},
{0.019191552585883894,0.45084131925169707,0.4927301707604358,0.35255027259430577,0.3929327261643899,0.03806027873631224,0.3734188238145606,0.46810332764219936,0.5255303641534742,0.12251801579445414,0.45554650327010526,0.46968507646027274,0.39925531475951975,0.3704754151443079,0.022743641984764973,0.19092581593188623,0.33642187248078836,0.030747843519557724,0.4304411045379646,0.44007123113156005,0.31036154130941396},
{0.027920982144510078,0.14719204776406025,0.10462936928461959,0.09982102789612497,0.13113399880190296,0.0013309019052524863,0.022762275242982292,0.0731592746840536,0.10955464612271253,0.06467500121384569,0.12516381725923406,0.003987938415012323,0.08378993510554224,0.045616743535364754,0.1048676311558549,0.13206306051100172,0.12542715835441656,0.05931481188878522,0.10874139270237967,0.14360438017409996,0.07354745028299106},
{0.2397422616926053,0.32165691258506857,0.8450780469578549,0.08161449937558828,0.4710078408285484,0.4753436197849336,0.2843387664240026,0.33695508394483265,0.8902856984673626,0.5845109628084013,0.03633487233158184,0.33525363479789544,0.4486866567271589,0.811199462486167,0.523725584345353,0.49458977081158734,0.6494744091894245,0.7294475245200818,0.8747933332044686,0.5890054524284691,0.5056713062307497},
{0.5104131620062566,0.2764657278418194,0.46963193739279,0.5344559882521488,0.10667992655118212,0.19229942057074706,0.44171688410617505,0.18279635521689044,0.5749084723350847,0.24110532818531605,0.09030238411820347,0.09324930744670212,0.5560298878381942,0.4728401971303058,0.3950959552133093,0.4980920051784069,0.11398063033899422,0.6458993461979141,0.11788025571736716,0.17202071187646986,0.5762334389685603},
{0.12699850971394042,0.058669033274446176,0.07535241840061226,0.13203152403327467,0.06837332508628846,0.16851393533952408,0.24404799832819926,0.038713565597092256,0.229166455791528,0.20752967880591844,0.3144429820216615,0.15200830607639332,0.26106116373150906,0.04492938252015443,0.2700838948091826,0.21100182421813746,0.0022327257748364173,0.29531679250324677,0.30225935305213586,0.24528964945175277,0.016243425264535122},
{0.04427530851709169,0.09506268381972793,0.11089577261912048,0.08432944976176611,0.10937585902430216,0.011646242466073906,0.04507570981123834,0.054955461515577286,0.08106259343427485,0.0707532432921794,0.02691108470433032,0.08560410178011141,0.03495944294809331,0.012996950550268158,0.009528781402550415,0.0034121317494826327,0.010049399076894141,0.0761340579117852,0.0342753939854557,0.043754987647324974,0.1019251418660832},
{0.14096638468147243,0.05041084686190875,0.06005823067053279,0.1872128090631984,0.07684675420454713,0.10867412932492208,0.32387113304911685,0.11732462365522173,0.08957610656550327,0.27100828170979946,0.3912622773203366,0.04042997119884679,0.3530533593934577,0.05376124351442803,0.20785212514359597,0.28422225454123967,0.01111068636941243,0.05426917976796407,0.1899597954158471,0.2725800006984493,0.16388119293375703},
{0.5145720843139594,0.6042596629914713,0.5021035103150217,0.0199680553290375,0.7081499517032468,0.6687445793292689,0.8304089676112544,0.7078873873472519,0.082073360478463,0.28261267958713654,0.3422534691796634,0.563612151917068,0.08918161015285994,0.5868393562992926,0.7909684369866582,0.31846299738741535,0.4330724510083206,0.05555237017285268,0.6067503804345268,0.5175105098864353,0.4258232345180065},
{0.22396847652843158,0.12149786557710249,0.13543359952642425,0.11527385577823328,0.02769863183905169,0.20254137630120472,0.14765490970394035,0.0572730278678087,0.2746358736208971,0.23691205508184554,0.24638864838060254,0.02444004060875259,0.29603489409606965,0.19873991541865008,0.1848370199723218,0.1489189635167811,0.11897249663377818,0.006576010088682307,0.26421308334795324,0.20110173114655217,0.17684063219110197},
{0.17559426056432131,0.1853452635538447,0.14664431479880316,0.25984577995591973,0.024022250210488965,0.15986248420411908,0.011643807473244458,0.07794610487796781,0.035197178138837396,0.15103755913969355,0.087441857741533,0.05941027134792978,0.2879878590817844,0.048591360715398456,0.2294923417171844,0.33443333176916135,0.04078478180697199,0.1523874189414129,0.2449319705721232,0.08416619858056713,0.10356441396138694},
{0.02999975178744905,0.069548856368708,0.08120502624068353,0.09323050350961598,0.10502501582992882,0.051295405265473853,0.04471779439753771,0.08698696313159648,0.04337210673320955,0.10873640156849528,0.008995199017433012,0.0161537769571429,0.08694235511179478,0.089126896820612,0.034729119069036606,0.10816999918382433,0.016608970967356466,0.03561073183413243,0.12589236934419454,0.10091329847610857,0.0665464823434401},
{0.3792593881226165,0.03832686248702959,0.07186752753809579,0.19464951996859803,0.24380510996977103,0.3011263085988604,0.1793477874962319,0.27766757510239076,0.3537478055915171,0.1893054777030188,0.2369627713207845,0.18301441240485405,0.1960067387111087,0.39762884043402236,0.11295193707884427,0.39687536575953686,0.39266032357636105,0.21122004311897025,0.030507961064764094,0.3027927256832901,0.33092509474166215},
{0.22234577635646222,0.0478834978546158,0.16911149481250987,0.029452564156576582,0.24426489269713206,0.2169877354434068,0.010475297909847718,0.26981226086762855,0.22204867987214638,0.1321915329131122,0.2429728768537009,0.1668529858203942,0.2126929624908112,0.2119451516824599,0.21489081884423736,0.2213339313811386,0.2041179834245454,0.2792011092052985,0.0023239476221698697,0.21811179731875213,0.04445557949242897},
{0.19952205197075026,0.40900101127672117,0.5570874959307937,0.10108013799687478,0.2044047266948847,0.10146247690698998,0.4424734368389921,0.32323780889890846,0.5434987390483588,0.2590814498476904,0.38067544440596485,0.5061541337331569,0.5863400244274742,0.35041406120495977,0.29085512645547673,0.36322689858171875,0.022938385316419466,0.1345842908037169,0.26428609477669895,0.05317739688003131,0.31669650680319167}};
static param_t rshash_min_X[21] = {-2.746330647550977,-0.9199884374438398,-0.20364048566636067,-1.635871141309735,-0.6835984744007735,-0.06140064449540183,-0.27829494600614724,-1.9495717445965985,-1.441358488528391,-0.42048734791506204,-1.398087924648133,-1.8765244994087826,-1.4398413651943174,-2.325378561577513,-1.441407750185039,-0.48827888518542284,-4.567897329062897,-3.8293160555105947,-4.113439081421025,-0.6905897475230182,-2.1266054668088588};
static param_t rshash_delta_X[21] = {0.1750050751949002,0.20507768944038135,0.09868759942952245,0.19157113079326857,0.19997965696857142,0.05009571399865908,0.11279531203908376,0.22287053286338301,0.126980473929281,0.17655784941397185,0.11587612044978589,0.21338726397232247,0.257438263588967,0.15673583076011613,0.16149567346856478,0.06890082523104071,0.130981290338828,0.14368969105603885,0.1330241720960372,0.1113004489272115,0.30612654157244695};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
#endif