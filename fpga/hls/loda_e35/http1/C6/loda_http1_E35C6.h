#ifndef LODA_GENERATOR_1_H_
#define LODA_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void loda_http1_c6(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_loda
);
    
#define ENSEMBLE 35
#define DIM_MAX 3
#define BATCH_SIZE 128
#define N_BINS 20
const static param_t bottom_loda = 0.8953576384868612;
const static param_t delta_loda = 0.07089864275670443;
static param_t loda_min_X[35] = {-13.918630105157606,-12.056039735507143,-5.380588482479905,-6.243267550631,-8.44864493079339,-4.749666873953545,-6.220639015270455,-3.646464904966262,-8.895865665817725,-12.276504247462379,-3.839029906582461,-4.237586345453126,-11.452137874924652,-5.197094030770127,-7.1449512141063085,-3.9728470105577394,-12.032467804510778,-5.890100619178142,-9.814982173931543,-3.397422343999523,-6.902321028687611,-12.006948010185415,-5.5125696525903605,-8.982002351247358,-17.197943464463297,-8.469827026534915,-12.621000723633063,-3.0164993493386985,-17.14458606531203,-8.09575365031284,-3.7635063869849583,-3.987902633517774,-4.991310758075575,-12.277667046562284,-3.4585456270226644};

static param_t loda_projections[35][3] = {{0.4129294369551306,-0.527936029389493,-0.7421407069878159},
{0.3138411253115303,-0.9422285418851474,-0.11708596380515207},
{-0.2875519520262243,-0.22749662839484228,0.9303543190391964},
{0.8957868522181406,0.24673289779956897,-0.3697144743400544},
{-0.8199592345342515,-0.29969506893304876,0.4876983897443375},
{0.9572817174341068,-0.1887705660738224,0.21903740970568344},
{-0.6920988562611213,0.04358962001815321,0.7204853351656234},
{0.6131319373806764,0.7888194208610348,-0.04281528507764422},
{0.6256564462020513,0.40278363860684524,-0.668071367292784},
{0.674948972704067,-0.24541303557546415,-0.6958565414044482},
{0.5853913516181513,0.35108808629915755,0.7307900663730106},
{0.6235408988155539,-0.09384527680872715,0.7761377529311304},
{0.2626522996364271,-0.9641925125517752,-0.03669561601596666},
{-0.269247698544047,0.8816427518811242,-0.3875715867865091},
{0.04341404065460787,-0.46303208933281864,0.8852776430714404},
{-0.3794670480607667,0.1398591283903567,0.914573224866078},
{0.31141091631760787,0.31122311847923195,-0.897866032168658},
{-0.7177359899974557,0.12184749115441024,0.6855714678731518},
{0.795216589924558,-0.576443860290773,-0.1879974761581362},
{0.6933131274318637,-0.013129044590011756,0.7205168530428709},
{0.31083887480398387,0.8456570556698481,-0.43387018577726316},
{-0.3963605846363111,0.4406480185190415,-0.8054362859481836},
{0.3252543571034309,0.9049804280197492,-0.27426269904313516},
{-0.23470068502705246,-0.7486409325008745,0.6200422103631763},
{-0.30782698302899064,-0.25565846937585196,-0.916450378119659},
{-0.14394161929753838,0.6849887391302274,-0.7141927173381032},
{0.31613599461544073,-0.9282496612436579,-0.1959862222441676},
{0.17996794170738786,0.15941145108852106,0.9706696292866375},
{-0.3263832022409124,-0.24882697536471154,-0.9118986465752742},
{0.7699743710725505,-0.5004783751462643,0.39580407261975636},
{0.8131555899180274,0.43803660596140154,0.38327786059578295},
{-0.5065090347134149,0.7920014529518534,-0.3408552424062709},
{0.9645031213606777,-0.2277716230042035,0.13361817480994437},
{0.4253247663229898,-0.886964400112616,-0.1799805436294748},
{0.7858304374098096,0.6180090185792178,-0.023138206392443784}};

static param_t loda_delta[35] = {1.1370235280318228,1.3277817091192412,1.083775717300849,1.364580238329895,1.2664563367009096,1.5477482919696908,1.1296607671206504,1.4830314160314653,1.1781343914162625,1.1615870239325272,1.0329516880751037,1.0940786809594265,1.4053115979864166,1.2313537325501227,1.038537971872239,1.084785494747021,1.113487843370002,1.1483513430823593,1.5369063512094678,1.1647549987627612,1.2247904530398206,1.0236086021387059,1.3174964118522587,1.1557535650071429,0.970608911645134,1.120308077186274,1.2673215385770868,0.9899975638103093,0.9723473800171585,1.2896413484713374,1.235515528842458,1.3790640472703293,1.6446575885123933,1.2900305703144685,1.4971113649860437};

const static score_t log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};
#endif