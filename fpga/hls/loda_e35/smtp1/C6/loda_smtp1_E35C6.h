#ifndef LODA_GENERATOR_1_H_
#define LODA_GENERATOR_1_H_

#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include "ap_int.h"
#include "ap_fixed.h"
#include "hls_stream.h"
#include "hls_math.h"
#define W_WIDTH 32
#define I_WIDTH 16
typedef ap_fixed<W_WIDTH,I_WIDTH> interface_t;
    
typedef ap_fixed<32,16> accum_t;
typedef ap_fixed<32,16> param_t;
typedef ap_fixed<32,16> score_t;
typedef ap_uint<16> const_t;
typedef ap_uint<8> char_t;

struct DataBus_IN {
    float data;
    ap_uint<1> last;
};

struct DataBus_OUT {
    float data;
    ap_uint<1> last;
};
    
void loda_smtp1_c6(
    hls::stream<DataBus_IN> &data,
    hls::stream<DataBus_OUT> &score_loda
);
    
#define ENSEMBLE 35
#define DIM_MAX 3
#define BATCH_SIZE 128
#define N_BINS 20
const static param_t bottom_loda = 0.9718000593034282;
const static param_t delta_loda = 0.07128498340681227;
static param_t loda_min_X[35] = {-15.095425721697586,-11.025283900080666,-0.4595849956778091,-10.085490079490937,-0.7862829174004695,-9.336093816968182,-4.651090617893333,-10.357094831972766,-12.989524910166988,-9.062311334038995,-4.0816006685426105,-8.403034929480139,-7.798957229420558,-2.377238129100477,-10.060665402840865,-8.75641503018988,0.13413279555599636,-5.625381295866482,-5.432491317109535,-9.006755998605614,-3.195155510837875,-15.136913718111778,-4.834904971630323,-14.98766650424004,1.1858705165136252,-3.2545580567848376,-1.941247098485561,-8.413603019091445,-3.8560180333962086,-4.322819671194283,-6.067273547197061,-11.01999533886662,-11.086202979335122,-7.912252696782664,-6.441883581964532};

static param_t loda_projections[35][3] = {{0.4910461363250947,-0.5508942848501408,-0.6748252951095183},
{0.27747971060448073,0.007330573827821346,-0.9607035301747405},
{0.5957146642973241,0.385617119430903,0.7045732580384662},
{-0.9445309567152194,-0.3140713368619079,-0.096023263683371},
{0.7429617490123553,0.48134735369022474,0.4650941459531817},
{-0.5129774627942905,-0.7889414772936573,0.3382683373755724},
{-0.8603733824973097,0.4064196614259752,-0.3075397559609715},
{0.5358339078977647,-0.8224996978046684,0.19072564132344388},
{-0.7423755351195838,-0.49402468069241745,-0.45256842545925224},
{0.4189582958111744,-0.8263040130717613,0.3764247924253913},
{0.233824012878771,0.9194754152745149,-0.3160558363755153},
{0.8256476682144418,-0.029967976432974237,-0.5633896061879095},
{0.5431087194559194,-0.6278904651344681,0.557482271147857},
{0.24862120367492274,0.06400151294482037,0.9664839902574727},
{-0.16406747172968186,-0.9324100713888133,0.32201447714805986},
{-0.9349815538261238,0.020257396449982593,-0.35411739846265017},
{0.34057462127083643,0.432248250285563,0.8349672912583435},
{0.05817898148404382,0.3809606731386266,-0.9227589997584655},
{0.38994328552573543,0.5991553787878449,-0.69925465042643},
{-0.9560918640300794,-0.040503346810720195,-0.2902547612574489},
{-0.3431764439603171,-0.2248695645448547,0.9119559239635207},
{0.004356690294354286,-0.44897720474033614,-0.8935325897096499},
{-0.6427993714199597,0.6166485223764534,-0.4544816475426056},
{0.3691102517469411,-0.42958195631127194,-0.824146203575003},
{-0.06147581139124924,0.733184376212368,0.6772454467118021},
{0.8889777658574929,-0.01836528207505749,0.45758195793248235},
{0.08799824685437461,0.9885007523404329,0.1229738637798878},
{-0.789642842297754,0.13962664172298844,-0.5974684782723558},
{0.9039761519351291,0.37761212117781556,-0.20058963749941608},
{0.7631011259186823,-0.13227514237144153,0.6325977855891167},
{0.03220682833083018,0.3510039122842173,-0.935819947302921},
{-0.9153985070748422,-0.3183697549362999,-0.24634583898850562},
{0.37877890886974164,-0.010366574904004828,-0.9254291287398553},
{0.8024445484151543,0.035823174886700594,-0.5956504401575103},
{-0.16377234564907703,-0.5977408477880217,0.7847830895771495}};

static param_t loda_delta[35] = {1.400827849751229,1.5797875067744453,1.5079380387913757,1.5918701480177104,1.4543566486735944,1.4429883847416607,1.8607994572002864,1.411905859153279,1.443168566065604,1.47185387976508,1.4041471763828635,1.9614807357054471,1.5396454035695357,1.5255884397926973,1.4246725088280305,1.6814451935898138,1.4959554348936472,1.850063520062809,1.7907473806216165,1.7225979796547435,1.7807677952790177,1.4051408005937562,1.5959171375602366,1.5137717541264237,1.3216001303759626,1.6041995795563204,1.3285680906834212,1.5651546391650035,1.6520997701740419,1.5528044218687493,1.8032595718844324,1.564437847520087,1.6290919171410219,2.0423891609554423,1.7041231958186496};

const static score_t log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};
#endif