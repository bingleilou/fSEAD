#define ENSEMBLE 175
#define DIM_MAX 3
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -6.727058836573144;
const static param_t delta_rshash = 0.14865337501781295;
static param_t rshash_f[175] = {1.6255939832632842,2.126684934010487,6.333929720888654,7.811660813952194,4.379325623001682,2.218413745238045,3.6256127805883267,1.2139442606690927,5.135625506286408,1.3249648764318303,1.6243806761450073,2.390638051021633,1.4424793559261078,7.735894086692176,1.5486427855901175,7.820384486011885,1.3851655464697148,2.728281994193859,1.1409311995961504,1.1746477938885986,2.6594516786970606,3.3433736241341556,2.4852433242624463,1.3175704573725961,3.863520341923227,5.626753386282901,1.4171082331215041,1.099692279694874,1.0997869795314725,2.774934254635921,9.59550357356561,1.3738736811322882,2.334652386704994,1.1508830169204207,1.2967295402231234,1.2223582272222058,2.2491979254019725,4.917811240387211,1.4558287167040078,2.4527933023733883,1.8244648336505727,1.6923698130598726,4.581888086904758,1.5281840379555183,1.104364766709532,2.414189308953868,1.9474705026477537,5.404419989756726,2.591713622301031,4.877585157206749,2.6961727241263977,4.651396809193729,1.6674250139561826,1.1744597764198386,1.1869479773199878,10.689097344516421,10.396407383372548,2.9099899185261946,2.935587171788674,1.1652532911508906,1.448108072033092,1.2335806246320622,5.07680066707248,1.2026815616020732,1.45564390061475,1.3131592565946322,1.2449849635161905,5.724706771790508,2.9156361554871917,2.108794206767265,1.2176597536287197,1.953214588165017,1.4760257627243532,1.4028433563517837,1.5040449446860447,7.12754560862634,6.77971434894105,1.6950536471356163,1.5677768615132106,1.7083347723673648,1.532462476299402,1.6928002711028531,1.9377521064081913,1.3725965628042005,9.184118492034472,1.8245676014724193,1.558030037854671,7.025171442217889,1.534388404639862,10.707095762335,2.2666272303646116,2.0349647312690244,1.7845087745375163,10.665484889220863,2.9261701492285543,9.208659439435687,1.4075742765514965,2.680505425029403,1.4982284512478723,1.7394812213821607,1.4949216107529237,1.582932424804031,2.221165027784842,2.6964613553529495,1.7784454300703254,1.224558488611233,1.231397014720668,1.951592873020231,1.5621488151491827,5.098270240900417,4.493761873811084,1.8724621165607274,2.632469347069577,1.4862010883900174,1.3736425926576565,4.772122435980168,3.0327532222187923,4.844974174734098,2.3425436087135756,1.227213078686462,1.5657269104531932,11.273959022612745,6.182177555036094,4.191042524324303,6.124984080581049,2.4363738880748,8.433784730188657,1.1921375028866654,2.0673468743171237,8.611223475329846,1.708605212227475,1.1819332261294644,6.756011464410598,1.6821983970566563,1.5087304867934899,2.7014324206742573,2.6132361143725564,1.3024269159204716,1.2291305222363074,1.0999225818937033,7.186380532897257,1.344899910097829,1.463113526539607,1.577837131020367,1.4950221153905183,1.4173493462358346,4.563704804205657,2.2720386125361998,2.738692030869454,1.1345168966277275,2.5876477937690017,3.7801859122674486,2.4644330919301676,1.1653549184724075,10.911114896694754,3.8729686952401092,2.038317810015329,2.0709698563675873,1.743951382680549,1.3133208238292762,2.4775331668715026,2.5436751358118626,2.069989894488568,1.9090186637931421,4.980450096242683,1.1795960563537249,4.949960338999298,2.7640042463678123,4.241076985855425,4.339335655959442,1.3888167522463353,4.7767045514808695,2.877555501123289,6.660604626755717,1.3955924674496385};

static param_t rshash_alpha[175][3] = {{0.03558005664919674,0.6032012174738892,0.525549808639495},
{0.23156166887869625,0.14756715425039224,0.09960751597895334},
{0.013656697323518754,0.13012178030156496,0.003964406824157426},
{0.00037398209914809037,0.08872808614084166,0.05925543657331277},
{0.1861777966819185,0.19001272165202535,0.0846732968428445},
{0.10823965939382338,0.43269340332906225,0.07127698734602668},
{0.15159644025223737,0.17600376719967042,0.14743157839485696},
{0.3653507886828684,0.27095357035169065,0.1418901209997052},
{0.05526996059311017,0.015438998000006941,0.14205579082895498},
{0.7166578388624036,0.23463709028628313,0.4285473174706686},
{0.5979732044915084,0.2663577505163321,0.49530555062503656},
{0.20769865510675498,0.007395423116171809,0.4001139025467451},
{0.4773371949889662,0.21882261105899364,0.5589203639015655},
{0.01721530886189766,0.04664521942430444,0.1071553367209158},
{0.0009641604547325066,0.07726536825203696,0.5367928641914288},
{0.11844866778876277,0.11644699712145742,0.08292162536706309},
{0.05316647200267375,0.26453200631376966,0.6260782101988223},
{0.10861137689169892,0.25856650169672596,0.17261187626025737},
{0.3529387841809362,0.10877337040563964,0.22829434473381396},
{0.05041754476849114,0.3397000768874652,0.3474893527784173},
{0.13184680711593086,0.037977691207682705,0.23810757337955313},
{0.19330294840654474,0.10135031975107174,0.11219871560197903},
{0.25441761642623123,0.06674115265060163,0.3971011007580279},
{0.404607891071013,0.3585928759688914,0.3597121450460215},
{0.13514427753899896,0.08603809124675074,0.09303881420337973},
{0.11900594651566705,0.0362136992961823,0.08877781866011521},
{0.5524896696644882,0.2903297225092544,0.002646304460364573},
{0.521523357297981,0.5334240905610498,0.0025357443383717568},
{0.5167131711689759,0.055327820426296664,0.8566200787985159},
{0.3189778004677164,0.08677299555787252,0.07364462762354594},
{0.06974781072968901,0.018675846192752612,0.051186893634133125},
{0.6062423545913108,0.4096445893025604,0.6093789422892983},
{0.3767582503204692,0.12328730648715805,0.19211609301349203},
{0.8172007248900361,0.11820772494845667,0.6915226550073533},
{0.5054056362084112,0.5222061857713424,0.4641133527127232},
{0.7676257014475921,0.16361534297715982,0.6247972693078717},
{3.655374800307367e-05,0.06001294598802706,0.16242888264072572},
{0.1572191530065388,0.011193501048999818,0.19101894498975822},
{0.34535717435823604,0.17401833212573828,0.5538178199898492},
{0.26095603022619246,0.3035979698639514,0.36352889927581605},
{0.41206272064935484,0.33860186975081935,0.514855767575609},
{0.09953110838833393,0.21697862109745147,0.030870320260641765},
{0.0994377663477096,0.18232631397002552,0.2077302714280765},
{0.04897343471291443,0.2826385593837369,0.21298522634279132},
{0.8258914542717265,0.07968394752379342,0.13110183837993794},
{0.18350409396550804,0.2995349492533219,0.026093699697180422},
{0.43228954456724406,0.3102506090019667,0.4895170092079146},
{0.0880153394763304,0.03279949919802126,0.03390267838475601},
{0.2051593895679692,0.22416609819386038,0.04184005200821975},
{0.19267037257645722,0.04984876962618475,0.17021588168171176},
{0.03857414005040189,0.2699932560561577,0.11561502637626636},
{0.09652025548118533,0.05892273058269715,0.19308766706850106},
{0.34524913925863576,0.3216173374461054,0.08233939963051147},
{0.7127490103954585,0.4893313836422366,0.0596649358051145},
{0.08692423933413478,0.5146202086692655,0.49546058082418193},
{0.011439193378547737,0.08381303768933084,0.05065350234711008},
{0.027312064055396105,0.02698774656616672,0.0016272086723519773},
{0.13703724190791464,0.33441972096990735,0.08608076685771789},
{0.07011455513205644,0.16898585949711417,0.09361492157508097},
{0.6713856052090657,0.6872385967303475,0.38138420917397275},
{0.502222669418706,0.23579926076529498,0.316936452869987},
{0.6770211951054685,0.2021727377338079,0.5629013640877659},
{0.05732425273595372,0.06615384097016948,0.12747080843573108},
{0.27510085998115213,0.4236370782505893,0.7202168460126112},
{0.6525145186169141,0.4627865936704283,0.5914114736495609},
{0.6291645035427931,0.3356429055832087,0.24518948598922705},
{0.01785382568669373,0.34483763141011253,0.24828038619584908},
{0.0695408637045092,0.11528903809909569,0.019066480042220054},
{0.09098453857772994,0.07147897966819906,0.12986956638981784},
{0.027641884439810544,0.09708667448122792,0.14544260975073894},
{0.647346288931672,0.6294014397645047,0.0660076960474783},
{0.4944457820627282,0.17472655497860576,0.1494787292139495},
{0.24720134158935828,0.12843698257812391,0.03853259870155684},
{0.23118238922139386,0.09951912087499017,0.36836666923151357},
{0.5257410631966797,0.16162654734836623,0.12291321131389638},
{0.1230476570823864,0.043609602515477935,0.08152259634196175},
{0.02300414783052572,0.02511527278865,0.045735457773678385},
{0.5554502454157653,0.09163333958015535,0.44210239533130347},
{0.05588563746548483,0.1478970706274735,0.33430584505035016},
{0.5796681503724035,0.3593488310822816,0.4490317306796948},
{0.554684495066266,0.32450138278799984,0.4755882572231067},
{0.4225948575309371,0.46713358778593567,0.5339755340986067},
{0.3385926142966787,0.26107127238596933,0.15559584569397097},
{0.09178931808907105,0.21556759138293807,0.3919084046208351},
{0.0372588631766788,0.05780008120242513,0.07337381963840044},
{0.32595414662338507,0.4356546737074633,0.19774852806086862},
{0.2557531727532486,0.4470651286640396,0.48073527026924945},
{0.13926443764971297,0.02631726339164873,0.056749025751695846},
{0.4067192777214713,0.3599374738779003,0.49534343043219353},
{0.0805849246738906,0.03701808334619286,0.07140120117405194},
{0.3826128185925259,0.37263007703664436,0.16570797604183393},
{0.04885503358998284,0.17567896590735813,0.48464440992689506},
{0.010183659945496965,0.13650417331612721,0.009704305563313942},
{0.0711390420424947,0.008287448910195765,0.06106614860998323},
{0.21429249629480732,0.21273619875251742,0.18266039307462897},
{0.05178813865813403,0.09983936166942516,0.05113638851944969},
{0.6321044411628717,0.6756331292773512,0.2848997726820497},
{0.3505402231349872,0.24218020689987052,0.037247795359554664},
{0.2649009495343117,0.6181060854998133,0.5579764832161681},
{0.2240101251826683,0.1796212106277286,0.26587290469406516},
{0.33393550374161196,0.23876585258503327,0.5026606498068136},
{0.368189687537745,0.09136027152482278,0.07502259527681224},
{0.4420375282238868,0.41411004155853304,0.07442641713224396},
{0.1348666799844901,0.14185872595281723,0.1706114352655067},
{0.33435539748627907,0.2907188183279104,0.03896795719241834},
{0.06817024262484564,0.6371354376810499,0.3873945450311339},
{0.21730848033132558,0.3406585765028297,0.2081975208224589},
{0.502153444446127,0.09877440220161453,0.29132998027149637},
{0.4068888580426937,0.6372356725988579,0.41726519770504833},
{0.01790967880273573,0.12159423419494185,0.009542637428686974},
{0.10844928777211933,0.2089602290674386,0.06466274013918094},
{0.3696897171517757,0.29554814841521604,0.3017263098604021},
{0.18896562179885718,0.009685664317632918,0.2652748622167515},
{0.0964542391046569,0.4121516523341443,0.6027776682268107},
{0.2303518853052741,0.17321188584004782,0.5156062825115547},
{0.17581719569790616,0.16740465131867063,0.020322523768697566},
{0.0503580651560724,0.19208485405230333,0.05995905907587387},
{0.13816696968172396,0.16645610016062193,0.005872633591065648},
{0.21032430906778862,0.00971779677418326,0.4196334945261831},
{0.7588109348483985,0.2803070599102663,0.1929589241319954},
{0.23522805899959245,0.4391957345637146,0.29820349605746976},
{0.019871541845312656,0.08600667469128731,0.0026189793808659425},
{0.08552983949248444,0.05259884572633259,0.04988889231112641},
{0.14733355260291575,0.01408175419391995,0.0018412359373875021},
{0.07248676639970711,0.061012804488898544,0.09870304608666171},
{0.26759274062344995,0.27045432105679784,0.19641116805150452},
{0.07051909235553523,0.02296951634290189,0.04703765111326015},
{0.12796655154532754,0.09439525109207143,7.579120569109798e-05},
{0.29201307868946136,0.1345806413015329,0.1091486132555329},
{0.044152342508336245,0.08377223101540468,0.08028847260473489},
{0.1254020121343851,0.11055138154566234,0.5424997919312118},
{0.3478442719842413,0.4740286938717784,0.2720302801150636},
{0.14106802728685533,0.057611492954371915,0.0366124745153116},
{0.3818125773058506,0.14140166198023638,0.4163654119687093},
{0.585896199349389,0.6578563599264051,0.6118048682937408},
{0.08103471155247863,0.35890864638705616,0.23689612657473225},
{0.13045207942975237,0.31847708711696576,0.06775626983225147},
{0.32009004516018513,0.023925962443005287,0.6383708390650814},
{0.4234108496700585,0.058549886339399095,0.39160988828735305},
{0.25573047351585065,0.7554943944709729,0.5490858448494516},
{0.06270080642974803,0.07697647565440748,0.08078333246698773},
{0.47095102384802406,0.5097811780484479,0.4636525750279432},
{0.4034060991159575,0.3895599575821813,0.6707274350353164},
{0.005191715650516441,0.06843087250082332,0.13811047646566726},
{0.4731118646058546,0.45606937525069924,0.6041843596176949},
{0.06444312086086419,0.45586434987347346,0.2372181816980448},
{0.052011902599822586,0.05978098037465082,0.2009577691659727},
{0.3125751615581579,0.3258968475053372,0.25136770591587737},
{0.28690729428390194,0.051647982245516685,0.08363750883497667},
{0.17177247202290724,0.5560757621433092,0.07526832549796304},
{0.3015909874189275,0.09276733577090839,0.16430836536656582},
{0.21369682007593904,0.10406531682476128,0.05538631881094763},
{0.10882244747823931,0.24724447296515586,0.028673562090793157},
{0.8317364109714644,0.487625446477895,0.5335951400395675},
{0.041844961595099775,0.07920897144415005,0.08943204600798126},
{0.07717764148161094,0.1699136931455047,0.1101126939766595},
{0.18393992180876598,0.39815230947666497,0.11389313139278238},
{0.32304706025808977,0.41290033574738355,0.4608817015693105},
{0.17438168959070655,0.374719185377083,0.4418811841239194},
{0.6782653917729843,0.6660061768347673,0.034908969255532656},
{0.34502265424211037,0.12959671380233742,0.3411116604354749},
{0.24403894643985524,0.08777560670616263,0.3563656988651481},
{0.47403114376962224,0.06368409923128937,0.06629851365770256},
{0.2276720277977887,0.31632010931406046,0.32777779958231756},
{0.07206725292457133,0.10815508139794935,0.041921035903209856},
{0.6812689157526545,0.7786651199247666,0.06874040316859095},
{0.178168801313503,0.12389005150112277,0.040936071581741014},
{0.1543528253012001,0.07861544837770802,0.18652138095226123},
{0.05263176478021515,0.08349553310583398,0.20804853007325333},
{0.22814600480343064,0.12436208268877338,0.04341306122023582},
{0.6332626828713277,0.1831675242680138,0.301821776691145},
{0.053085193975286486,0.17377350764165506,0.19686961447645138},
{0.3342016117438441,0.05523375887356159,0.14517045080782445},
{0.0949060928994582,0.08757723907574758,0.1027255719260559},
{0.4131631042791789,0.025126182206309248,0.4901730095054561}};
static param_t rshash_min_X[3] = {-2.3025850929940455,-2.3025850929940455,-2.3025850929940455};
static param_t rshash_delta_X[3] = {0.09614502352502724,0.07570437288699758,0.053820455935644385};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
