#define ENSEMBLE 25
#define DIM_MAX 21
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -1.3833949602465134;
const static param_t delta_rshash = 0.7228593631870723;
static param_t rshash_f[25] = {1.7897239865113324,2.15907757221047,4.13938711989258,4.846533746795669,1.6261703781384584,1.5111860595601991,2.126948617412716,1.2581765869042552,1.13170226754801,1.3727151942716334,3.2048245829761184,4.327430196062532,4.6541051425957685,6.331210885630042,1.3810316360625279,1.6380031997300377,3.059270193952926,1.253953054373586,1.5698874342264022,6.908549468303001,8.913066464359147,2.1602196535971827,8.286330183569104,8.133592250553049,1.4839589041124834};

static param_t rshash_alpha[25][21] = {{0.4515607339513778,0.4722916236685877,0.27895915714318215,0.3747888077839409,0.36347922130047045,0.2784173171371135,0.045726609476627975,0.24792739930787014,0.3458347343231757,0.10988459586173958,0.3411869412430555,0.10712988908286535,0.0041506866351632005,0.4987338778012485,0.32191365294870977,0.5042175865412901,0.35097242119037375,0.1265433302479033,0.5498693173022329,0.31812036964568857,0.11484867219999922},
{0.3710906521180183,0.1361096027928664,0.33486479466037256,0.2872504786066441,0.27191340894114163,0.24400161836201695,0.1844718008125123,0.3652977039048275,0.028904478611265858,0.24089268157648264,0.05351002568503554,0.07960596813686695,0.2773673149041998,0.1828417764214879,0.3737220748479687,0.10350003626112414,0.0344655870656554,0.4487927560493794,0.1675780760211685,0.033725936088923596,0.24237106726381935},
{0.10373221984311182,0.03244745243363589,0.019353988153474097,0.22358479135989567,0.04176727582853897,0.04033270074331855,0.04338706994669022,0.1640867723676243,0.11455156392224776,0.15591567894429187,0.20726869100543757,0.1693057250303085,0.03800912468465815,0.23511344571691975,0.20119757751839412,0.0038811922764990453,0.22416885517725452,0.20050173979997915,0.08498853546141773,0.07015110339960451,0.14982743106003885},
{0.09818742657863744,0.19431959773915036,0.1149384574521322,0.04864256952874925,0.02014038637511186,0.15888230191345917,0.10741222892436957,0.0027411123720387596,0.13798888609982438,0.06124285976982682,0.15915266121454652,0.02779620450243184,0.1097951327234462,0.005246849883399966,0.0080812822025611,0.09264630484699873,0.12359277967528172,0.10265789888158683,0.203722318952467,0.15127244568884748,0.00990864428877046},
{0.5938924206523732,0.4310884360064622,0.38694238695879457,0.07498753643152287,0.43301103831308085,0.497260006686596,0.1668239750345868,0.43925574475069856,0.4678660738617066,0.38507186983956976,0.23697779341884562,0.08643338912402371,0.24984845658963542,0.10248359651899304,0.2555226240381041,0.21115833003647685,0.4412600212161146,0.010846242607951345,0.06194731886999307,0.048611380924686615,0.06968521273126803},
{0.5459679417903923,0.05128950973198801,0.20703689697588853,0.3613299068883968,0.48865546201767224,0.028959323156554875,0.1421725623840871,0.6312686531754602,0.5824211891277988,0.28127323874398935,0.5103487854113966,0.14443132161165156,0.3566369046148059,0.2618499394927779,0.4042778887068402,0.3409042724037322,0.057566817687005965,0.22696284091420146,0.03466834102656215,0.5479200142026738,0.4237622847646285},
{0.2252000352181947,0.19749704732504875,0.2860699145420919,0.17091663599024587,0.3861573279420968,0.3294725812923811,0.19946017069608526,0.1840916830433624,0.23916577698545868,0.33205204465290084,0.35569434449339943,0.443329698673116,0.2386972084460677,0.4298899104488621,0.13408756811691455,0.4115117723655922,0.052029049745829524,0.2330400340081059,0.04423619710485846,0.11643479253811707,0.15599251844244877},
{0.29386838700242485,0.5554529452134449,0.6141512078958761,0.180505331848574,0.3977289148694247,0.056031651432468126,0.11298040271294954,0.22824597878191952,0.15420835189561816,0.5643966588895953,0.41167784038612065,0.5908962296573794,0.7107120154863902,0.6651640912351974,0.19272279350019583,0.5925813263813134,0.5515250214113705,0.5240386388095103,0.09924990567076744,0.0019246521390557036,0.7278754890414819},
{0.7287994340794738,0.498592349043699,0.7746624140708119,0.09944121055746745,0.5493188309183774,0.567955399402824,0.5399876814487878,0.638583996213886,0.6679080643683254,0.6943843996391273,0.7528602742537672,0.3721505384917333,0.021812733954721,0.23811314522984584,0.056608113940059386,0.4199300701244678,0.08659457926578312,0.8599565092279918,0.41656036391302953,0.6104406744001041,0.8237100239191768},
{0.6391793959593376,0.6238068362219432,0.6113155440871523,0.4392560561012763,0.53231299241214,0.4575905936354908,0.4402507039154831,0.2604729355935683,0.6283795423125074,0.4323465166827635,0.14928532907471756,0.32024139533914786,0.5746199303374464,0.10470080595237574,0.3348004906650973,0.021703150193175764,0.12827563218978558,0.6076497424553088,0.6531255216969979,0.15707343166606091,0.709542672979513},
{0.209836543486805,0.05985201658017116,0.06704049922847671,0.3083855988240401,0.22215416626176213,0.20495310770504194,0.13980402603439115,0.2308758266606168,0.2672732528548621,0.1861104407874192,0.2470330902802473,0.1292643012319351,0.16171668265740993,0.15479158451268496,0.18636353115173468,0.06232724976023789,0.1229412744229585,0.04070834717406377,0.13440812739804062,0.10472728377857521,0.0025769198102304947},
{0.05779441257628238,0.15179005796704667,0.22970398639577722,0.1921964064949717,0.15249871956964142,0.09758997830380402,0.21016222241924248,0.1461860015512055,0.19245538676351584,0.1675862285199049,0.10529702894751566,0.0021784727041977937,0.2094942305721302,0.21697668483350102,0.023222559288768627,0.02735218385858938,0.16441412646069462,0.046997258986766495,0.10198151083779365,0.09401296967366511,0.22967746846849899},
{0.20744909280722398,0.0005173132143450228,0.03726727372197493,0.04687351131006575,0.0696673532951932,0.12581455092623026,0.07409315962574682,0.2089148647217961,0.07602394812005996,0.06849305188628142,0.05842119024264894,0.04718838174568941,0.19135015989173026,0.19210555673532415,0.06182579973543748,0.18973789828838278,0.16662876255260992,0.06793040552846237,0.07113780923500483,0.148586698449894,0.06802281010891888},
{0.15016228983054006,0.13398057016055528,0.1410617707678374,0.1409705008934826,0.09026759869414865,0.0831975940967051,0.04249230309361928,0.08838608669660568,0.06070429679261408,0.11226625443505638,0.04476393574421133,0.15722362030480702,0.10554224369093058,0.07823291687073446,0.039393683354598696,0.10667282632738008,0.11595179050976212,0.030322826659684266,0.06960710872313641,0.055699772143748445,0.004713113480614767},
{0.08147987363209899,0.4489368591660069,0.6023720804115664,0.14133757907194536,0.10251099366796591,0.46880214228537853,0.07273948113627578,0.527122300048532,0.06126103280964705,0.7133962429539529,0.282569219815995,0.29138814894602505,0.37440495654349526,0.5478147917293184,0.6502453243001468,0.5528105560757299,0.11245968034478315,0.4097883496317145,0.7228680612317933,0.6835393361801863,0.13545426143351488},
{0.4104945840898785,0.4258143668908524,0.12176101615419341,0.27906365616044554,0.25800323734692765,0.5443402056581312,0.07835846332357661,0.49682470377418625,0.5332723027219636,0.528845379942187,0.2193447551120065,0.5412974567047015,0.26971686261833755,0.03226506707791537,0.06785860396880515,0.2446486041619033,0.1287752953231675,0.03901042762713967,0.009865641326654495,0.04207918837880694,0.569496991638253},
{0.10050793556012463,0.05642077001299047,0.022201092479907678,0.20691377855072127,0.23246130938466686,0.2508621177432715,0.018180445613194256,0.19718379837436983,0.1643814019211324,0.11610137901538668,0.01944529208744527,0.08833911917231509,0.2311453752024623,0.3235732372119219,0.1882138202167146,0.20795784236571543,0.24211482149517938,0.30430449771948725,0.1361081146465478,0.12225445637051553,0.24644122000083923},
{0.7010120766716362,0.6677092396704257,0.5712074944619144,0.469405331965465,0.5399531476667406,0.28756934745051027,0.23778968247420582,0.1758449680397293,0.6820890072841113,0.19397198781268796,0.24340340111841052,0.21122833845160371,0.588796909233164,0.5517355598779942,0.22192105092566364,0.08426403974394898,0.7943143557153173,0.7676583801815013,0.577834090805714,0.13008956157500692,0.725150299465254},
{0.09044755453703125,0.12708509094829806,0.12751345112288648,0.3101285304586223,0.43970675765533634,0.5321735412672887,0.542597998645599,0.582131804293448,0.1534357023649501,0.13779509313622748,0.4289784642404847,0.33149375898713385,0.37921714369486414,0.39405958978709005,0.43755032431998686,0.6046548178466423,0.6201537653278485,0.2892893790753247,0.4228672737941942,0.05820900471954275,0.3134316782536498},
{0.10321766357032443,0.0886402705959871,0.04147220208471275,0.06091402935707885,0.14294943775542135,0.1287533459529742,0.03856624337992287,0.09867969523095135,0.14213046124963213,0.014399782172256714,0.1114948220257872,0.12178303886149734,0.0217214341179116,0.10358408915306141,0.07336131075599951,0.014320569692285191,0.036490439556394076,0.004923664082743621,0.0837720426452335,0.11783578355883424,0.1438511576080468},
{0.04330058080975817,0.05381832844938659,0.01836423192849695,0.006020812644462108,0.033042797241661384,0.005262376977899799,0.07794017726040665,0.0146169752653083,0.08057500321460397,0.08907518543729577,0.012060932031982491,0.03474971472550996,0.021449381852008335,0.032449013710165175,0.03395387102644567,0.09600515590897465,0.03516589793543161,0.06248603908797523,0.11020550974828341,0.02828764076656278,0.10922340343462959},
{0.16617406852818922,0.06877588674497483,0.07541521085920326,0.22995727755016654,0.3700541804493716,0.3067346001549814,0.20023035247827115,0.2862824792958815,0.10653762810267904,0.06084304542459987,0.0519100583794645,0.40060972210217566,0.17778951407351357,0.041227008719929396,0.017350863198895623,0.15564524269949837,0.07955484480029881,0.01459733203342868,0.28484064685108,0.16582061852501154,0.10871790881351735},
{0.047458547540096874,0.06976889757436391,0.09401048714548528,0.011550192101168213,0.0183937778615307,0.014744096097009418,0.026941165756064454,0.053038401333258274,0.06480073529600906,0.06527144867886818,0.03223479517345659,0.09598328993084046,0.010348167672225343,0.10551161979108933,0.09569223149830282,0.02743910405267741,0.018482851305416447,0.08864471402172332,0.061727539362730025,0.1194136440246403,0.03883053199392206},
{0.024186814355165943,0.07458104869254711,0.07172449204477077,0.12010844112699337,0.09050157330992241,0.03994184691050471,0.011077093083268753,0.1175820535901268,0.012236438902828667,0.005973741949614068,0.0499132197765634,0.04790725561379262,0.11488683072018198,0.011369622275164226,0.12287138494408627,0.03801947779418218,0.09949276932478394,0.011334752278750283,0.033435332911846014,0.10173218735328361,0.03223251782421796},
{0.6619150732912797,0.1851719429531848,0.05490442236695279,0.18682180809336793,0.49381478923146105,0.03430652881562619,0.2820121350294123,0.15625873380865937,0.4810621952901663,0.5163240777369739,0.6202039727705713,0.5539184666979186,0.4784450862357349,0.10152366096710488,0.3221331672374841,0.6352555951993132,0.6403486853166047,0.16515387041992635,0.4792769625476578,0.465224911649731,0.3899578410856369}};
static param_t rshash_min_X[21] = {-2.746330647550977,-0.9199884374438398,-0.20364048566636067,-1.635871141309735,-0.6835984744007735,-0.06140064449540183,-0.27829494600614724,-1.9495717445965985,-1.441358488528391,-0.42048734791506204,-1.398087924648133,-1.8765244994087826,-1.4398413651943174,-2.325378561577513,-1.441407750185039,-0.48827888518542284,-4.567897329062897,-3.8293160555105947,-4.113439081421025,-0.6905897475230182,-2.1266054668088588};
static param_t rshash_delta_X[21] = {0.1750050751949002,0.20507768944038135,0.09868759942952245,0.19157113079326857,0.19997965696857142,0.05009571399865908,0.11279531203908376,0.22287053286338301,0.126980473929281,0.17655784941397185,0.11587612044978589,0.21338726397232247,0.257438263588967,0.15673583076011613,0.16149567346856478,0.06890082523104071,0.130981290338828,0.14368969105603885,0.1330241720960372,0.1113004489272115,0.30612654157244695};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
