#define ENSEMBLE 25
#define DIM_MAX 21
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -1.3833949602465134;
const static param_t delta_rshash = 0.7228593631870723;
static param_t rshash_f[25] = {1.8690114510518325,1.1712614560798869,1.7337070738942897,4.55211317293291,2.268171243268123,1.3698922696919058,2.7689176094955124,1.7201466521017852,8.141521260865165,2.3464049032369036,9.510038968841044,2.979898596826161,1.2511006358444834,1.375111136165666,8.17364608558093,3.7907584947309574,1.5839118696267895,1.4674018506909479,2.307660555413503,1.5348218857584135,1.328227799638757,2.6817209256599654,1.6245166298088833,1.493051146541046,7.490188054491134};

static param_t rshash_alpha[25][21] = {{0.04943812222872973,0.08962879824837414,0.0036646054410166486,0.38837715819565205,0.10676888300528065,0.331082180174926,0.3971993492470005,0.42851436818216887,0.5204743501725143,0.41311804428720883,0.195481739079481,0.07620464697662069,0.1996319095337695,0.24984473822345984,0.1856750060178451,0.1343644058740247,0.44414455319225005,0.08937611652104387,0.5346859747601123,0.30014207667831916,0.35579461658119876},
{0.5094063954437849,0.33589067055708205,0.8271149391952587,0.33962941970627053,0.46377656017943575,0.3338096821073898,0.73223439237195,0.39256657011701124,0.3785835935373387,0.6209633445255125,0.5821961434448534,0.8293114089601286,0.566582266461687,0.20938410890510986,0.5378892573999047,0.23573341290740552,0.8029913423637873,0.6971335572528782,0.6233485412688433,0.7699198264673336,0.2091118752986091},
{0.5104064161883013,0.11154280067790753,0.5349120601901658,0.42899634501854345,0.2382164832759769,0.02612160872763172,0.07729605903972087,0.10179677004777125,0.20175778948414858,0.41796823842173886,0.34649402414430036,0.09824000832136379,0.5131057705554887,0.20738270937790296,0.5367704788478902,0.1910651679209589,0.2226659432960365,0.42802479023411377,0.4857082918882752,0.5292499666465758,0.5391065912459773},
{0.08174511268931194,0.04192315609750461,0.20780189688794273,0.003911989065692455,0.01862654047896426,0.10066363623052793,0.029130153762336304,0.04132969543274922,0.0986784948721643,0.12036012535395661,0.11942494270675781,0.12483627375794083,0.013685374070535198,0.03653330079083082,0.1237730921516244,0.012183578551460664,0.05819022678529797,0.2074637018893863,0.1689774012454351,0.1236943546391727,0.09506079316650398},
{0.34063048552212566,0.05128953840277369,0.34361617209969325,0.4379530269946523,0.20684425744374305,0.2136004939653804,0.03763183818345552,0.3576660691316478,0.2521640724861642,0.4196562472620641,0.20547638859733025,0.24003621102610828,0.15161835143479996,0.21658895002132508,0.2771158596036191,0.33621756895153854,0.20314389269217334,0.3538380301217207,0.37404539902114414,0.4336305718176328,0.01383212777010904},
{0.36568594338093574,0.5150508110913552,0.019679152488025025,0.5106898805477846,0.024925568038026882,0.5283179772718775,0.023999242694027832,0.5946144747279055,0.38610913546970316,0.5605881228173815,0.09109683543890948,0.7002514351620107,0.1890902216826482,0.6919185073222871,0.4139863483138879,0.08041163490588128,0.0804185369330793,0.392324013483748,0.5734143215127058,0.2657320450814989,0.15417612181062443},
{0.29188204647436056,0.17141455569902855,0.19048877578538012,0.15263491175875124,0.08421636362673765,0.18611370445545136,0.2611657535366037,0.1267666094542539,0.11836312637604166,0.295332079488841,0.27584009867023285,0.17426401911373496,0.09986021951557167,0.09282585586320426,0.0012251950888020648,0.1016600455090822,0.11446011323714751,0.2273915979959076,0.24992582710410147,0.2035927037742393,0.30775426813674145},
{0.15447297969307316,0.23582070980234374,0.11835510899341051,0.3778176135083263,0.36265741345381025,0.19601829161534,0.3780825279543761,0.4226842645311336,0.04292273751394247,0.4281387103045505,0.32821565310581446,0.15145585271736628,0.5171321551983289,0.22848168451836454,0.5209054362496425,0.1264312301241973,0.03255398363575724,0.5286753807908087,0.12077102135223694,0.3484404842004743,0.543074343945457},
{0.07696053564899172,0.09119473264282789,0.0897103091242189,0.04937079138033061,0.04880589287083802,0.0905488168454994,0.06311495930544862,0.003983468552888963,0.06531721410775296,0.10141209340625384,0.06399197346266573,0.06315672061610669,0.11963235879754275,0.09195006304309279,0.08011631924234501,0.10875222769250296,0.05585736658191552,0.03377514202030939,0.09967065104539165,0.08670133929305306,0.082942193297057},
{0.2161861821746251,0.024435313129662732,0.093888869243562,0.31170848189187844,0.23911943370700464,0.03422751036775928,0.33112234025488024,0.0008605939722053198,0.1569289703683566,0.33310441287197956,0.3032345221505314,0.17099042445159784,0.06622224257288556,0.3415339047822675,0.09336644671034917,0.18460285385936603,0.09527205809282109,0.3817712250424771,0.20893887254873786,0.17561237733015134,0.35833710881813224},
{0.018055679250920397,0.05682258130004295,0.047292341639872996,0.06449840432882087,0.006125077796486153,0.037681719021187644,0.012794195873985916,0.052477125799886545,0.09147454731315875,0.08638475296331839,0.016803516077141097,0.09961992552228842,0.07821612542791029,0.09156003954411221,0.08506418213123176,0.003137788857637619,0.07698522215571904,0.005054471216354367,0.04422884684271521,0.084358831222267,0.09741044739883165},
{0.2608237391081456,0.1619377318556536,0.3305855299698959,0.3140746055841555,0.06334536723191413,0.2717428643915411,0.2015529946463,0.0825933579055604,0.023720228980570142,0.02258791279632195,0.24301626383384667,0.19836738954819183,0.2692386298996956,0.2936006462215993,0.05143432512141623,0.27943464818223257,0.22537967745375045,0.10307056435041288,0.1643598869349071,0.12417906888792252,0.22461680912119342},
{0.5482162073749269,0.2631108395764215,0.15285683418977783,0.031064850219441446,0.6745051345861339,0.6982217256883135,0.061671000614754834,0.6251923369347852,0.18405571057660797,0.4973474605593422,0.5706103637157105,0.05697080061837672,0.3591392020032715,0.5346711628860041,0.4142092043468832,0.09747701591683053,0.46676002589830456,0.48612408733351026,0.7329808978562524,0.48345478965941235,0.03895272130411685},
{0.2131145361400046,0.37305441947402407,0.5275367652780926,0.47501551459977803,0.30568395136653775,0.2477034458504039,0.6270182881203652,0.10907556654334088,0.0949082262856135,0.4126631120558875,0.02740442881152413,0.5882201091141092,0.3282952583687462,0.3713153832167431,0.6308420424946679,0.053954599247417384,0.06487153057127229,0.20449125172922566,0.30167992492235374,0.28314865198114736,0.1429642354839321},
{0.07282563105597507,0.039686141442891454,0.0370870936837556,0.06265388859192798,0.11364520489035705,0.005159535963238658,0.0952520210758142,0.0722007477242269,0.015091512345786661,0.0829052037551018,0.07939144521821424,0.11504261218183313,0.030070490179113906,0.11297209830827104,0.08619217604661869,0.11912227458834884,0.034789445185169035,0.09068737472356336,0.001644145102443813,0.07676694465790929,0.07318543838662178},
{0.145152402158119,0.00016936654788995457,0.15766470793585102,0.10470864877189688,0.2088769731694857,0.2533308217978196,0.17541186276599346,0.07778005400095575,0.03736601927724988,0.23532191681899015,0.08827085964186913,0.19144709748199915,0.25550293908206373,0.08876729683093676,0.040191384195470026,0.23838865160207473,0.08016555008753803,0.08273968471788917,0.10285351940084335,0.09399556805516682,0.11751185778557603},
{0.24517370895395346,0.36118315609473894,0.007006534848140017,0.15669461999710352,0.3741805095371383,0.12114207159637978,0.55125640757606,0.4893572946928213,0.07967576092631663,0.5279170580979752,0.02035430084812377,0.20840959836688686,0.2888218507665422,0.38346619764637035,0.39978234325570333,0.4596002428485055,0.26921291923820595,0.23545010189635746,0.5524898872476499,0.5147692992079459,0.31504125039252984},
{0.4870943008858246,0.19045487397415312,0.003219682098810498,0.3486250035801562,0.22072113985431752,0.44825233940856496,0.07682866721765313,0.578578055220059,0.5088268842315098,0.10242763167589056,0.565302327146181,0.27469346733203465,0.5456039325617204,0.5683705384891803,0.3262582883283064,0.05817396731736365,0.4792696234153308,0.1359279004133722,0.5029995640868719,0.38742314275861917,0.26277182382324643},
{0.22032666229528416,0.2018823436239998,0.1438065138771129,0.389142270707906,0.06017900278118974,0.14927320833969038,0.39373734563473284,0.39907579636359114,0.3694120781323231,0.008095148887821764,0.3005064525700898,0.3132406308873593,0.3862166233866423,0.10767239336392614,0.1882048439498727,0.20459594921175117,0.04210345624910404,0.39748553343661686,0.2959651180804836,0.3440515465342693,0.031801323090015994},
{0.39447476707783474,0.5534384306315816,0.290938816825514,0.49200843463586574,0.5108976791613067,0.29435815601421544,0.1538122808098008,0.15346832774288197,0.1524963986544071,0.10423537669906245,0.424236820200926,0.2141069051126408,0.48156701571051425,0.3710017946124392,0.08793589009312747,0.3667325307380924,0.5183543105724174,0.2758715895205646,0.6059659409851549,0.4873109287820856,0.6405611840396883},
{0.07452395810398918,0.5654944509757109,0.4197818819666842,0.35194905725261255,0.48962808593109025,0.27504932219613404,0.6973647496276124,0.08157615365350955,0.31468930995939864,0.462804870402135,0.31790157882497266,0.6461237116854871,0.45433055643239967,0.4924000715991467,0.47008484964468994,0.05619314233990723,0.6519925668268011,0.10915818850857686,0.13374461748936065,0.22197217484890386,0.14235194734438278},
{0.035826796008501,0.11107690574812852,0.09494721520353572,0.19088351757782915,0.25597869537486356,0.0625203375329841,0.25741147356814215,0.08959048781607137,0.33682542550979266,0.34385110173283534,0.0205462365084299,0.016095192968297086,0.12575286420736942,0.04083857134577377,0.26184094312531064,0.05998013260565662,0.1445189862089974,0.1854304036446561,0.304920291908495,0.14459425055796885,0.26087688711549656},
{0.1918256338611116,0.11464680422746783,0.12523150990065995,0.10121554121083404,0.5375921715622557,0.023205260685396925,0.35736387533864533,0.48624596913412754,0.39491554281302643,0.33199254537237805,0.037861163422311626,0.4223704084720372,0.05362863755874072,0.5412365550716537,0.4723190979377597,0.5424419221092762,0.05479454882518424,0.061734259628291786,0.1646569646436338,0.08098579691486991,0.33976928905659326},
{0.40183997121670223,0.2083098417548903,0.4651576714928871,0.13439696059178416,0.2186103489414933,0.3939713303397617,0.2752354319864516,0.5742984609344026,0.26757766068368716,0.04506146861481352,0.013917808815359995,0.4515993929988908,0.5227120567637461,0.6509550574641852,0.5324438086375074,0.33904122806345083,0.5149570015597029,0.41533864507161283,0.4812721366153632,0.43347987415180306,0.4500166067840233},
{0.031831725110268064,0.03199747118161295,0.06480148248734038,0.11287240123870199,0.04033918930936876,0.10418780370859129,0.11006377927033789,0.09105651725510097,0.03563931650229384,0.014248371060084053,0.0010261392519095166,0.12814333409862463,0.024246512710989165,0.042729099064408,0.11900785136461868,0.10053498821362472,0.060929795036733896,0.08698057795805039,0.06214035125381624,0.05898656683852618,0.02133479317255772}};
static param_t rshash_min_X[21] = {-2.746330647550977,-0.9199884374438398,-0.20364048566636067,-1.635871141309735,-0.6835984744007735,-0.06140064449540183,-0.27829494600614724,-1.9495717445965985,-1.441358488528391,-0.42048734791506204,-1.398087924648133,-1.8765244994087826,-1.4398413651943174,-2.325378561577513,-1.441407750185039,-0.48827888518542284,-4.567897329062897,-3.8293160555105947,-4.113439081421025,-0.6905897475230182,-2.1266054668088588};
static param_t rshash_delta_X[21] = {0.1750050751949002,0.20507768944038135,0.09868759942952245,0.19157113079326857,0.19997965696857142,0.05009571399865908,0.11279531203908376,0.22287053286338301,0.126980473929281,0.17655784941397185,0.11587612044978589,0.21338726397232247,0.257438263588967,0.15673583076011613,0.16149567346856478,0.06890082523104071,0.130981290338828,0.14368969105603885,0.1330241720960372,0.1113004489272115,0.30612654157244695};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
