#define ENSEMBLE 25
#define DIM_MAX 9
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -6.133982010631548;
const static param_t delta_rshash = 0.1630262361817786;
static param_t rshash_f[25] = {6.849329485523468,3.7402624480264945,1.3043589504010393,1.2023646492585893,1.6317360788890387,2.0049777114181047,5.162002724704116,1.2845036551522675,3.9050608156723285,2.3035922297169305,1.296069922179319,1.3412908499871365,1.3734687559573693,1.3024228859884128,1.6323922003237008,1.7009037063734587,9.516643161487066,1.3506739948870334,1.9014865050949403,1.282522049348909,9.692371687314942,4.099318366829969,1.8108820967256243,1.2416986711808484,1.858628478046741};

static param_t rshash_alpha[25][9] = {{0.11035690818051937,0.03734803251684486,0.08411481418361497,0.05646190806921873,0.13846656920462314,0.11142127159192666,0.07746354738310345,0.05223347136937618,0.06008515503233147},
{0.002162618223464443,0.0655308693610806,0.1159068938316598,0.06887483029190904,0.04371110215104595,0.19411219881227676,0.23285164865145783,0.26194246677352295,0.11676763642036228},
{0.5891968964902228,0.14943801991315608,0.3431019569947886,0.10113732829034874,0.27109034378026053,0.26514626717529577,0.21612326390185482,0.2286641090047486,0.0275184110876997},
{0.0027720607315026365,0.2502392704673711,0.31020338224019395,0.2440356095811524,0.12733891901368538,0.19872315628334694,0.6463569832448531,0.04842627827314725,0.16880834219597465},
{0.1980457959236404,0.3248282091411963,0.051788748114591526,0.5449734210657903,0.11598020863164689,0.041023381838463054,0.055256212314934716,0.29398186807295884,0.5274691287521412},
{0.27393035955223033,0.13519750457555535,0.31559016340331786,0.49535271997040164,0.2925771894486273,0.036884522599914295,0.07202635485871507,0.1912797806430454,0.1480626775300899},
{0.13653531475231148,0.045676816646618046,0.01578571118912524,0.10033766651876129,0.1548576911899368,0.014245188327100543,0.07765555724045174,0.0631324000844812,0.13430698636140698},
{0.5831964374406876,0.5219300809554005,0.14080638546761348,0.5978832380024535,0.4240233718099047,0.2820089698586174,0.19718367078764149,0.43842743156262054,0.6180157079208338},
{0.05789351389080549,0.2126404841742465,0.15736084755651536,0.12226313724853063,0.18897183277355137,0.2553710194526258,0.15462890119841938,0.1529783527007281,0.13194937585720132},
{0.27021366602657554,0.09159030655784346,0.10885381925534222,0.007250672803131519,0.16775317773275927,0.36133856217992244,0.1408534858248922,0.0807062103150931,0.2513181495655605},
{0.5475613678379606,0.4871689801111189,0.18205689678187734,0.3949953751175678,0.15824840293887557,0.004805067688426551,0.7153675447305691,0.2792161155813149,0.05103010797564193},
{0.6034878349498265,0.3978198262117084,0.27956861674155303,0.48806069948170355,0.5898628152067406,0.5007288402172954,0.3623603612802864,0.24405197294172667,0.37103986185747445},
{0.13792035945817424,0.5913953649203278,0.6659016673519548,0.16690968580509763,0.009405295436309058,0.5905974017585974,0.5697190373769762,0.5945623371942815,0.3578248213270929},
{0.7013663125550694,0.1079932679771372,0.39572457589159876,0.027295128267957224,0.05490731638581507,0.19939982537427822,0.47384534672682843,0.3803540266274034,0.5576482145485984},
{0.40461216288096546,0.5763977155503284,0.3826396823164609,0.20699436735142232,0.436113335571986,0.3520673439681208,0.04159727011674741,0.25878558025551957,0.19876426855558724},
{0.38112003718846016,0.39438618741123926,0.32124254777582406,0.568166068168085,0.3340433237600792,0.14911608228184478,0.15400203450180677,0.5812117730651668,0.36328813253990155},
{0.02685383101391112,0.034649520484998024,0.03180299478691631,0.03699651291972565,0.04514112308960404,0.0938695305215117,0.01699372824941343,0.08400652626866179,0.002634295972467697},
{0.04307619863012111,0.7083355640879435,0.09769176711041966,0.3928841261438275,0.1357678290580678,0.32833797351993427,0.669541697465602,0.3911890675785423,0.11666831749423291},
{0.18532422679353325,0.23908011421458408,0.05080765754537996,0.3740292738787218,0.43615521634843696,0.2526706477997856,0.02131422843408058,0.44623590124940976,0.19881410388894538},
{0.4928693194572222,0.32483315846750926,0.7328771219902115,0.4298253436186628,0.0007203553450405224,0.5403049250086657,0.36342660781008934,0.20009463193127927,0.3519436223603796},
{0.0895791525152158,0.07090150030382572,0.04844447501198586,0.09921496708132818,0.07716051166682092,0.0729656048496077,0.02923022185064378,0.03588835239818932,0.06362763870042099},
{0.04031331136924774,0.15019922266287947,0.09695960571586074,0.07999819793191323,0.11285727976110387,0.1330842080397899,0.1380736752163947,0.2431706779311374,0.17567174238909122},
{0.390765806110348,0.16900882559644573,0.02282808798834518,0.4707565474252739,0.4812645557395528,0.5296679261801472,0.17603138220510203,0.15375443663763302,0.08962290719913407},
{0.0515384652430979,0.06550909068558684,0.13121583795877687,0.2524287316638154,0.38824302775101055,0.06450450992498402,0.5816217031756671,0.060651204213197044,0.7056929466536468},
{0.37181100842520054,0.04621799893774295,0.5034676684507218,0.2955588862252758,0.2546619812396353,0.33966402119595784,0.24876475507638654,0.3153647543964533,0.48842976810235683}};
static param_t rshash_min_X[9] = {27,-4821,21,-3939,-188,-26739,-48,-353,-356};
static param_t rshash_delta_X[9] = {0.010101010101010102,0.00010105092966855295,0.0078125,0.00012871669455528383,0.0016025641025641025,-4.231371387466678e-05,0.006535947712418301,0.0016051364365971107,0.001607717041800643};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
