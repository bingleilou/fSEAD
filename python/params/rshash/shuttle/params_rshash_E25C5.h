#define ENSEMBLE 25
#define DIM_MAX 9
#define BATCH_SIZE 128
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_rshash = -6.133982010631548;
const static param_t delta_rshash = 0.1630262361817786;
static param_t rshash_f[25] = {1.7741599276046314,1.45467785598178,1.1740128063164452,1.6383663060756184,1.3956228866590068,1.2339165517468482,1.3957602610935995,2.6543564877477084,1.2645471216809079,1.1693336671861247,2.699707249573756,5.372997927965606,1.3572795097961186,1.604650362541657,1.1382150075944553,6.461438009395007,2.832962863508502,3.182455589126456,1.2714446570893843,2.494542888732477,1.2316220825584803,5.9314843496586525,1.6646182356095212,5.464344611159453,1.441001153973275};

static param_t rshash_alpha[25][9] = {{0.03805280752316138,0.04031119962218733,0.1327651637373004,0.36639390884125217,0.42077454737749487,0.15400838267825012,0.3709223423300656,0.1389311317853297,0.2041537847478989},
{0.22448065297665573,0.2978541094388276,0.49907618357892264,0.2821025511941778,0.4467737720213109,0.09787516331885404,0.21049311422155614,0.5376604183741165,0.10197327125560991},
{0.4073586770880937,0.08331315757736696,0.04015952577325878,0.5828249323793674,0.3206884946797416,0.09319643766469332,0.12360010783290351,0.7123569155644836,0.07716537526229011},
{0.13117624254373023,0.1906017851986211,0.28087545920112883,0.3599512442893727,0.19034743968761794,0.3381831930210463,0.08570790860771683,0.5266714003408332,0.3017990416345305},
{0.19048438966277434,0.04921267231186254,0.18872973632126083,0.12332298968508788,0.21612045820815254,0.037105958926676015,0.6162936622923663,0.2792397114329487,0.43393883467267613},
{0.19091776220007334,0.4238304013195863,0.34887747329362323,0.7861800126421574,0.3083736569412945,0.3612543421219887,0.7417053643286925,0.6348208896545949,0.783201123957639},
{0.33252293773629493,0.515915742710452,0.19673090378012748,0.006946281560094138,0.22077301293222934,0.6931414442205559,0.39196435892864034,0.008129689052304722,0.18292690741228448},
{0.14874091015287355,0.20138388195905046,0.1436398548561766,0.0039001494413858657,0.13363139057010512,0.36582074242133095,0.1264424627978037,0.2136853635906825,0.0868389722936529},
{0.5798940137789779,0.6738963925840491,0.1305092392946771,0.20013781436042796,0.2336416522029526,0.005882432914479458,0.5941807025907149,0.5673573933691575,0.4324682328181115},
{0.713524877488738,0.7943768254712048,0.07807597915665976,0.0493674913305268,0.20809446361283232,0.42244285783767593,0.06834496609263478,0.2622626433611028,0.24496545945587025},
{0.30770649239137093,0.21985737912042586,0.15963595133395522,0.2957327141724635,0.29182759613475145,0.06263221633146268,0.16800005159118933,0.21159130099153445,0.1651136705053492},
{0.03424221334852838,0.0920232909199095,0.17979977321342475,0.05521612938645972,0.002389060796242206,0.18086718323988255,0.03773238453222511,0.02640945243554655,0.060339692871583944},
{0.39069960210944094,0.20687795310238807,0.47304005671848776,0.40312892110719406,0.0033296065198595085,0.014255540820018064,0.5409178574674681,0.6757170409112802,0.28884090776754656},
{0.38257129568909587,0.5458748164125891,0.16814073240874125,0.4487467341350505,0.5242985138054201,0.3960974127373528,0.5731315152784182,0.42036747203972286,0.49332158754043376},
{0.05339883720451443,0.2332724612045065,0.09780699417247703,0.3597658701068158,0.34761296462593716,0.12593835698675093,0.5390279812656094,0.058605323502421064,0.8566422414709752},
{0.1459362316940588,0.030846826992017816,0.0752987919339284,0.09087924629972376,0.0006853298288796942,0.10582565155851605,0.0781818721547254,0.07177076232650882,0.15263640177936902},
{0.14470086179818736,0.09673209764170082,0.32084147038240574,0.29223126217043865,0.2862109549631485,0.1098756507764845,0.22846771986037284,0.27530189032838204,0.31913992538405755},
{0.05371777231348476,0.1491805810856382,0.2952349647426641,0.006408001052437419,0.1886315574046218,0.10313827099385375,0.031871243535221326,0.13827434246555384,0.0947680473861678},
{0.6738807773249078,0.11439615392989702,0.0477285831026258,0.4501548850650584,0.24516271793818845,0.2762099577278805,0.7620189416308092,0.7027614946675259,0.6183232512585702},
{0.0645480863090724,0.34297827333200775,0.3328430575747402,0.24446958753517348,0.2750823618689556,0.06640505051620965,0.15769921166801856,0.18426365476605747,0.20017164269780924},
{0.6787880468517264,0.723171998542338,0.39032636811384797,0.7753979587570387,0.15844802851005502,0.6354235680133358,0.34918259964101,0.5669040844610441,0.6021356242413616},
{0.09324621190590732,0.12120570649628565,0.0188137684607556,0.08252770533259188,0.0044244498509850355,0.09685827798070012,0.060869535448983755,0.017368901470823688,0.012343811367409075},
{0.16218128537736842,0.43573432352488145,0.17011360718057705,0.07272724045345409,0.3582756341624106,0.19661166340229577,0.34817811598772275,0.3724050999202888,0.17576710536658285},
{0.03350574614811493,0.10294850288043896,0.09519433372631675,0.15653778648603447,0.028479612568730602,0.13169563489490785,0.12080225623223757,0.05025394699813193,0.03245974715042593},
{0.38985899836870364,0.6414535345771607,0.6155564769974542,0.2268694498453605,0.5849310733546013,0.18195702156282748,0.46820139549571255,0.4124534733044025,0.5933449658591147}};
static param_t rshash_min_X[9] = {27,-4821,21,-3939,-188,-26739,-48,-353,-356};
static param_t rshash_delta_X[9] = {0.010101010101010102,0.00010105092966855295,0.0078125,0.00012871669455528383,0.0016025641025641025,-4.231371387466678e-05,0.006535947712418301,0.0016051364365971107,0.001607717041800643};

const static score_t log_LUT_rshash[128] = {-0.0,-1.0,-1.584962500721156,-2.0,-2.321928094887362,-2.584962500721156,-2.807354922057604,-3.0,-3.169925001442312,-3.321928094887362,-3.4594316186372973,-3.584962500721156,-3.700439718141092,-3.807354922057604,-3.9068905956085187,-4.0,-4.087462841250339,-4.169925001442312,-4.247927513443585,-4.321928094887363,-4.392317422778761,-4.459431618637297,-4.523561956057013,-4.584962500721156,-4.643856189774724,-4.700439718141092,-4.754887502163468,-4.807354922057604,-4.857980995127572,-4.906890595608519,-4.954196310386875,-5.0,-5.044394119358453,-5.087462841250339,-5.129283016944966,-5.169925001442312,-5.20945336562895,-5.247927513443585,-5.285402218862249,-5.321928094887363,-5.357552004618084,-5.392317422778761,-5.426264754702098,-5.459431618637297,-5.491853096329675,-5.523561956057013,-5.554588851677638,-5.584962500721156,-5.614709844115208,-5.643856189774724,-5.672425341971495,-5.700439718141092,-5.727920454563199,-5.754887502163468,-5.78135971352466,-5.807354922057604,-5.832890014164741,-5.857980995127572,-5.882643049361842,-5.906890595608519,-5.930737337562887,-5.954196310386875,-5.977279923499917,-6.0,-6.022367813028454,-6.044394119358453,-6.066089190457772,-6.087462841250339,-6.108524456778169,-6.129283016944966,-6.149747119504682,-6.169925001442312,-6.189824558880018,-6.20945336562895,-6.22881869049588,-6.247927513443585,-6.266786540694901,-6.285402218862249,-6.303780748177103,-6.321928094887363,-6.339850002884624,-6.357552004618084,-6.3750394313469245,-6.392317422778761,-6.409390936137702,-6.426264754702098,-6.442943495848728,-6.459431618637297,-6.475733430966398,-6.491853096329675,-6.507794640198696,-6.523561956057013,-6.539158811108031,-6.554588851677638,-6.569855608330948,-6.584962500721156,-6.599912842187128,-6.614709844115208,-6.6293566200796095,-6.643856189774724,-6.658211482751795,-6.672425341971495,-6.6865005271832185,-6.700439718141092,-6.714245517666122,-6.727920454563199,-6.7414669864011465,-6.754887502163468,-6.768184324776926,-6.78135971352466,-6.794415866350106,-6.807354922057604,-6.820178962415188,-6.832890014164741,-6.845490050944375,-6.857980995127572,-6.870364719583405,-6.882643049361842,-6.894817763307944,-6.906890595608519,-6.918863237274595,-6.930737337562887,-6.94251450533924,-6.954196310386875,-6.965784284662087,-6.977279923499917,-6.9886846867721655,-7.0};
