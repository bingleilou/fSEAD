#define ENSEMBLE 35
#define DIM_MAX 21
#define BATCH_SIZE 128
#define N_BINS 20
const static param_t bottom_loda = 2.580379516762855;
const static param_t delta_loda = 0.0805177582801107;
static param_t loda_min_X[35] = {-3.0325112126940312,-3.4242945559101354,-2.168118321248001,-2.547892761195084,-3.761052117465586,-4.269206922433268,-4.078919743034213,-8.157508530191821,-5.778045569405653,-3.0513012814196947,-2.6781691636479357,-3.1825524168024746,-2.6633795694149227,-4.341308710782255,-2.267201689273732,-1.9819300815722567,-2.5462942841131944,-3.144747042890322,-2.8784810757126955,-3.5367077491058496,-2.338058181494445,-2.3102596721843103,-3.534504439383794,-3.8499430387679716,-5.041264325531101,-3.0718904183614986,-3.1552488542488333,-4.394581243128149,-5.2417046764961714,-2.4362156174390326,-4.165964878720858,-5.711541917273704,-6.027813787281776,-4.749638402054995,-3.0912186152375063};

static param_t loda_projections[35][21] = {{0.0522081285188994,-0.31689865524054345,0.4479724863972201,0.11069360404600594,0.10685617789402391,0.16190512069056115,-0.18589216401896358,-0.04446007961884776,-0.1008258351083789,0.06697896781255476,-0.20454341671266932,-0.42755953221936355,-0.2622660459329526,-0.11232109678485853,-0.09058922322630572,0.22419966963513094,-0.26813545969789526,-0.26152446861015255,-0.16699691288302487,0.18013164730041975,0.17308198134222577},
{0.04379827158661594,0.3862918770427661,-0.023460975496822346,0.022617739460391976,-0.44367848446515923,0.04362979887531884,0.4975541729755918,-0.0797542815274232,0.06366257695865464,0.08145523049013524,-0.01055379891457055,0.1646516270646005,0.2750395804983789,-0.3181212391308832,0.052510769271603586,0.32208482439205344,0.00942394059969352,-0.14603245080999913,0.17218057590109903,-0.1138566143598477,0.09922784724925335},
{-0.07346987689940745,-0.22208713160909052,0.13729204563442424,0.22705642097259657,-0.0359070556277027,0.12106863940489364,-0.202580409538175,0.11010860142082769,0.10071873318132059,-0.11766442907971686,-0.05577249499858414,0.40691851731008233,-0.08505319888640668,0.025966682018817737,0.3180963211207141,-0.02231596719657755,0.5050514682897562,-0.43786764320435506,0.18305238168279553,0.11481027885476187,-0.09998724042441678},
{-0.2819220992762178,0.33400637807868677,0.3064639692596617,-0.21463691816127134,-0.2591056082419476,0.2578373415681859,-0.12217810792512446,-0.11247878991691336,-0.22927433179481915,0.0753432438389232,-0.06544702268485243,0.08739707007447942,0.08462038925728782,-0.0782098305337585,-0.03986968121848275,0.16818442085646132,0.43508193970625075,-0.2519299840478027,-0.2927329663313184,0.2318081774266029,0.04759437200145428},
{0.15115409877606925,0.2926035473974774,-0.07145194536475051,-0.12481635448505185,0.374742632361238,-0.1631903626515243,-0.32512527180964723,0.13282790573228978,-0.07979667082555948,-0.12518126315793746,-0.2972899585616961,0.17839300351545065,0.09868835256984987,-0.15892198931568172,0.5094842511969798,-0.11488706092629115,-0.18772096253353504,0.020928625110528714,0.00589041634250167,0.2942527566532166,-0.09016458134745446},
{0.012712221294710703,-0.24754705403486413,0.31446586559837564,-0.08421237712007112,0.42741167858212714,0.23822825103010836,-0.016781824990635515,0.17227961427279256,-0.6455489021262679,0.1230562892263468,-0.03233960026707932,-0.1063215356995632,-0.14130995758302706,-0.059897421043613085,0.21716636812809106,0.1827251228918918,0.025983727318987678,0.05930374635625095,0.03294802343184627,-0.09015815306604064,0.03800787070674424},
{-0.14695527501877237,0.048822069091490713,0.2887397260148186,-0.31622576710350403,0.20488646376040612,0.2851280301667554,-0.02891067249979759,0.11504057052890719,-0.1920196027194697,0.3843792741462099,-0.2272789581869751,-0.0885837907505306,0.005795404380677399,-0.33201090995851895,-0.0349077100646561,-0.09038741918191993,0.08466162144141601,-0.41537595842959046,0.3050994330485795,-0.130981076670662,-0.03978763316582122},
{0.13282805092521172,-0.16064275897940727,-0.39833079755703565,0.10145568055339658,0.32257060912990787,0.09267663660576873,-0.40663373783120327,-0.2995749058471578,0.24672337175011624,-0.20938097502587333,-0.03982725470016074,0.07845908509858762,-0.33090096538542785,0.279075498203315,-0.1090952434801122,0.0467790317128178,-0.008796549207505305,0.3032313373904321,-0.07483682591401394,-0.08071016247691365,-0.042287893174341035},
{-0.15203899886845662,0.08541917233142483,-0.15508093906108314,-0.08272293916386475,0.14044939750234625,-0.09984513711741047,-0.16965345413351343,-0.37140889411991246,-0.11443557942143046,0.3485561222458703,-0.25825055697833305,-0.0072519558796766736,-0.04946834992754904,-0.32000332261595305,-0.24887446132722288,-0.13465436808195308,0.4295408338167234,0.13392995734190452,0.24878439081067008,-0.15712779453997516,-0.2588336293327654},
{-0.21239650798098264,-0.33438575341986315,-0.05358185203035337,0.24797684619613203,0.04843072047043754,-0.2638702130837355,0.054558103216318446,0.12365915312800245,-0.21730307646593902,0.29399678397965945,-0.003204127558918082,-0.41058345539996244,-0.39902087610158676,0.21120539741130503,0.0641035222069421,0.3445772980707782,0.03661611470827698,-0.13118090505660446,-0.1592919380552588,0.08508221444389694,0.09162509068397047},
{-0.027730346650319336,0.12403005594446141,0.24236291837803736,0.20507714531097263,0.41058418594374874,0.37250049745839486,0.1733266092641584,-0.11434522024173806,0.15510879650114012,0.22443753944138436,-0.2627056055266619,0.03551510668740937,0.24412115511373378,0.11280526474755072,-0.2830429021285074,0.18854826110989492,0.01935042542611155,0.4219401359990193,0.09332152594717458,-0.09289079301926867,0.0645158042045543},
{0.3753618794117384,-0.16412024817423215,0.06549803552143102,-0.37486181579392114,0.12801938544273503,-0.22561470150546042,0.10357479460929264,0.16718286564991094,-0.11984917355653728,0.15582022038643373,-0.06007844901945878,0.45076414990130764,-0.17226495445724246,-0.025514586624437115,0.03162615362859431,-0.014789429825881597,0.007929898251095698,-0.20878490483287684,-0.05003821716093145,0.4178909673119239,0.28915474652434947},
{-0.41805607556175617,0.029403196357917872,0.0983128402487487,-0.18416858356561674,-0.19578747118549622,-0.18437250889184872,-0.12331314167498987,0.044245031617472626,-0.4155863904209286,0.08424312931898872,-0.14884406534802586,0.2973063675266426,-0.19055358316792256,0.10863285930604871,0.4058026076968229,-0.11432902185620125,-0.07386933575575752,-0.0049432844386704585,-0.20871558229166995,0.35348077803449574,-0.032957188416455875},
{0.1918523032853913,0.009185167493385608,0.3383773530323463,0.06499748179555125,-0.3437922359311321,-0.12027183803575925,0.08007636303758221,-0.12025803593106442,-0.20438631986366682,0.40466780518906276,0.12675249663849045,-0.2363277393854873,-0.34928115067499027,0.12165427700963632,-0.2570788510656613,0.31178927055885886,0.24759508094582588,-0.18796677154719654,0.03651910541408121,-0.0993916704219601,-0.07388259764937596},
{0.08342799387585925,-0.2382397036927014,-0.03466459637222371,-0.11298232864498782,0.47168969338267736,0.017987985104389318,0.1124275118099137,-0.059083701976613695,0.21883603096258847,-0.1765863881652822,0.18348604988663264,0.09479871053733023,0.528112632797291,0.17476873917725438,-0.025570886891552142,-0.10103944498941367,0.2583942916476565,-0.34152481511473637,-0.20926740259483756,-0.10400590269791797,-0.05759109516922871},
{0.24695121875130366,-0.05929382272853053,0.01833147042254156,-0.10448066277816226,0.35200828222691405,0.41591611369949294,0.15639537773080034,-0.2363554364150682,0.26675777602244716,0.32126048941624274,-0.08882854917517485,-0.059255138044538795,0.24186218733572581,0.09360142927799515,0.2549855946476465,-0.08098937293080348,-0.23049720964899545,-0.24308966596792841,0.11826963833811203,0.289595815612078,0.11111916814573115},
{0.05220995546445986,0.19920311417831224,-0.13063388778390303,-0.006102384151710812,0.0833047217424448,0.3903951209639633,0.1644462977507895,0.3908957464973279,-0.04406809822815965,0.16984190666086696,-0.01983929315745215,-0.11640091738277239,0.4903536087617396,0.194563514937498,-0.024477216301270272,0.11715433371550557,0.048636478141990375,0.4407648029833643,-0.2362765401046675,0.06026579151692536,-0.08857238434531657},
{0.161644144852938,-0.20714946449898877,-0.25028962986809705,-0.13336866736283176,-0.36771322124750094,-0.06539400313506659,0.08294333249538562,-0.1585691769375308,-0.01816866511056425,0.2872844094734883,0.19028189465070383,0.17401947206858112,0.30679076048511505,-0.051270238857132756,-0.002810108019221374,0.4120251581966432,0.1737771603112417,0.036537227712393594,-0.3617074275553009,0.30981367893066947,0.06921348901566972},
{0.1573534813957924,0.025453837901732605,0.08145643845996164,-0.6948799108564396,-0.010269195228701466,0.3150736808087097,0.24260723165214362,0.2602353400298666,-0.2542951588069585,-0.16356136366955004,0.14050527637030508,-0.028675977149349576,0.022104654538479998,0.20359237615483528,-0.175260762318787,0.1545430421046571,-0.08755512177596138,0.11767867152893056,0.024349178939672922,0.14443161734924093,-0.08748066540723541},
{0.1680032678936917,0.28500372915984906,-0.12492852445530676,0.5691836879187824,-0.023882407920924952,0.023610406853423867,-0.1322291919920997,0.17783582635598796,0.12730104302210907,-0.22662111440644314,-0.2542622163398851,0.0357386819016985,0.12134219103231941,0.3237433942529473,-0.11414269454252125,0.14365562325750247,-0.04429688159964069,0.010737435005626066,0.2662024364042925,-0.26196811215676513,-0.26921302855223356},
{0.27994926504610873,0.05350444105078214,0.1599196678438158,-0.38670321115760253,0.24248294431924203,0.3006709033336089,0.21306116966502003,-0.14885886194990733,0.22106905872426746,0.08784158008007377,0.37355197332345347,-0.1277683323813594,-0.04292086197765328,-0.08963617226922342,0.24781148029683694,0.10626267934968628,-0.1057921004425654,-0.200695191508758,0.363701888811939,0.16355495384306584,-0.14616626024529064},
{-0.27120155738191964,-0.12810532899563337,-0.017763391406010076,0.07082839850109744,0.3278878644448314,0.16150454483890656,-0.25947693145084544,0.07003288870759435,-0.12675276652914302,-0.11483067362839544,-0.24648092997007434,0.16621791261306354,-0.18240331445173488,-0.13239799518503562,-0.13735646401831736,0.4092967917058276,-0.14021633250495028,0.28616093370522583,0.4227052043676623,0.24523075116640772,-0.0607332268173737},
{0.05191434061424356,0.03130518032951218,0.08307986527005545,-0.27540335367891755,0.3066023580706602,0.2284803419410591,0.04372002761377812,-0.11009061400342815,0.19704542158595323,-0.11897085980417264,0.17401432045673268,-0.4409853384921424,-0.34723418505210274,0.350554411043059,-0.13354400848974834,-0.30564617618905193,-0.10289695138051558,0.06257221936878818,-0.24846472934196595,0.10049555928053282,0.18589038927067011},
{0.20815988316267195,-0.07567901931047755,-0.04476646899099609,0.06548417714082969,0.00645384975604985,-0.17118092743661684,-0.04606548576189376,-0.14715854193484512,-0.042787231822072794,0.2094846217605743,-0.4270640727036136,0.4979467189614391,-0.38996367542118693,-0.03928255995113023,0.12624339255634864,0.2615834862301772,0.029424737358290435,0.3310418424970368,0.03845504146107436,-0.09581673761939513,0.23745787013221054},
{0.03927943748326002,0.15634670970397038,-0.3848230703427921,-0.2630403576940575,0.1535979101294489,0.2031881420003201,0.14925323650366804,-0.03376283594643314,-0.13629754198786034,0.23407290971490885,0.04077455727614659,-0.4167717247065098,0.10066208236835145,-0.07201354243372222,0.206056834492036,0.20652909960021923,-0.1694466991111403,0.06987114764694147,0.2585108704185419,-0.4035572091241221,0.23663956283994567},
{0.041740012356470936,-0.003001523345927827,0.3845960212131677,-0.30759644307238476,-0.26034000770395355,0.07076024507811063,0.36670360828609594,0.08500883718940712,0.0914860483359582,-0.5154609297601193,-0.07082813054304501,0.027094702726107915,-0.02696315012020138,0.2862888248113528,0.01403148095068602,-0.28463890251994345,-0.023767480467289402,0.16932747710462828,0.25122332120837604,0.07182118050034249,0.002022240419363339},
{-0.13462504194772967,0.09139425548685708,-0.18550364547164686,0.013727492881309256,-0.3851430578316077,0.005287715570060135,-0.0526040880090911,-0.2724777058391647,-0.03982439763341822,0.28851899120287294,-0.21033999689523905,0.3349428276799473,0.17317248201263716,0.11233719042645461,-0.017546149961650832,0.4321784669821071,0.2914654855318119,-0.0007353777043127324,-0.36628170727556814,-0.13300042859843758,-0.0761012001532503},
{-0.11925052960307517,-0.1689046634812831,0.07329453284488173,-0.19232325302062975,0.3299354846430506,-0.0552187526571479,-0.019428558931968654,-0.5645190732743715,-0.12050119459191237,-0.16132101455581108,-0.23180327234862733,0.07557479720616471,0.059753287005393514,0.02102364370133276,-0.022707654776426195,-0.25833265570014774,0.09145098290157566,-0.33609870783932155,0.028002142175558582,0.2767418967870511,0.3376024773673971},
{-0.03164704178345156,-0.05413981502506694,0.004978936406794785,-0.0519395686919855,0.23009116612275748,0.03619121797941949,-0.05568742809712854,-0.2855670474997401,0.2334365044663102,-0.3303564995437443,0.09457743501652874,0.07352827351569123,0.330615034951755,0.18406293379055622,0.1047237504385982,-0.4874356865221982,-0.09998276302850416,0.025053092256827506,0.2912350777746651,-0.1453520680403323,0.41005946009470506},
{0.37775601072003767,-0.0108155059374915,0.06197512766436366,0.19733720507032707,-0.049012656338119354,0.17719949258761736,-0.07175529438907285,-0.2756302180877783,0.5253859584318414,0.006991076782450534,-0.15181893074226085,0.36491241203968344,-0.02264523504669348,-0.3132297450636946,0.2519270348498713,0.11324966381810046,-0.012548474219505607,0.06266266656028474,0.09108217896377499,0.04647424309394227,-0.2788013017178522},
{0.2509675088237119,0.12576641478403738,-0.03824993664450757,0.3825545827234752,-0.3555812147606281,-0.05061121082920601,0.02589787208808313,-0.17312197059615553,-0.09102087140819465,0.059112490218000024,-0.0739641213703676,-0.09100237223808705,-0.541832549104837,0.04330675512698759,-0.3621068127145368,-0.2526765980090609,0.02080494644459746,-0.18947985665854472,-0.0933882932368368,-0.21823774673974505,-0.0714499086491078},
{0.18540467991778387,0.06689698408819153,-0.09234921469898066,-0.17654512829938382,0.08218426390918983,-0.13424109216136243,0.22336437130213163,0.11486088390627962,0.10845858601022522,0.2777227167811577,0.0398323076846415,0.10721400054989408,-0.14956892117394796,0.2555224144693374,0.38349954471029135,-0.22211879071064908,0.3330707425729672,0.15508035882182267,-0.007903001698592167,-0.5585187214627104,-0.023584762285032413},
{-0.14733372888063992,-0.04026227991952007,0.21769192681256122,-0.27398505151562436,0.15625732665822217,-0.27227799452213813,-0.0974222221031145,-0.17530699545752507,-0.43449923199486756,-0.4771222358001913,-0.11322434129794454,-0.07166468827843407,0.2883435510763479,0.013088889361792266,-0.17262965625729557,-0.21877105610557554,-0.22530070145258901,0.14585836487609785,-0.033059429520083776,-0.1352772886031511,0.1692484052664045},
{0.23820086685412745,0.21941886225999338,0.14089794113497578,0.16544619176385733,-0.12903133197402863,0.09050905289810081,-0.588513398119254,-0.09027923540834935,-0.11695073867273405,-0.034593981402007125,-0.385048979604809,0.1318935336041425,-0.4177792604561399,0.17674751928287524,0.06356973232240183,-0.05115109857304483,-0.10096813118120351,-0.08006975773016849,0.15237219239442973,-0.18093637070453952,0.05496487910113391},
{-0.5668735001296216,-0.0761162916242217,-0.1601376352314892,0.1499892468864752,0.09244702847686051,-0.2159466640607203,-0.06543799943494402,0.09958876228513765,-0.2952032591895401,0.04764359602372608,0.02110164680786323,-0.13549071698704152,-0.2876516751663875,-0.18600430374051427,-0.070546185887927,0.3139984820154062,-0.14551807498622382,-0.02546526959881685,0.41495501814992075,-0.08709330691987069,-0.1568845132882684}};

static param_t loda_delta[35] = {1.9997278603293016,2.647471851311369,3.8448575880937303,2.5721290117122515,2.196473650127108,1.9719618904519187,1.9491596446212671,1.674169558672286,2.238553317882912,2.899566153798696,2.295257420511875,2.538883040450937,2.9532929061406206,2.2462658324108915,3.377325120238876,1.697218256034331,2.065516878446592,2.0643652063615514,2.1044043735243645,2.7820498147529227,2.339334125488668,2.6233967989964135,2.301373084866816,2.1868235351032923,2.478805929200403,2.1522433084589627,2.382147179462841,2.639607267094746,2.5476037299597656,2.8593824952727385,3.2673804469633696,2.254120226644977,2.306855927338251,2.5876041494224644,3.3731517611568247};

const static score_t log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};
