#define ENSEMBLE 35
#define DIM_MAX 9
#define BATCH_SIZE 128
#define N_BINS 20
const static param_t bottom_loda = 0.0327397510472687;
const static param_t delta_loda = 0.06681249496346338;
static param_t loda_min_X[35] = {-4370.183569351785,-7723.1995737816205,-10145.715593704803,-9089.817316839344,-2472.36121737095,-1914.8755643275056,-8083.396672675686,-8372.962422552162,-1709.5064531328742,-5195.302757832996,-8333.935550233273,-7699.861149860534,-9740.375671204894,-7742.432909297899,-1865.1556032928115,-11730.603052554177,-4467.63427807111,-6893.726931784604,-2071.5041617621473,-2067.611430038207,-3277.8476973961933,-2145.471960324179,-5996.358557833497,-3008.193829198305,-8589.33513074698,-6389.580187296151,-901.2743954099683,-11601.914582866248,-8287.50828168438,-10652.835381345847,-3024.435804717527,-7753.979214240335,-4213.112049838158,-3663.8341232612343,-3444.3901722814785};

static param_t loda_projections[35][9] = {{-0.4437531542727801,0.12898020564645243,0.6122684645686363,0.38287197086735575,-0.1181703397275709,0.1662814576800721,0.035992331371770936,0.06902897103249145,0.466164591881826},
{-0.021980779310733202,-0.02274123463505529,-0.42472329861104074,0.4251167924308342,-0.08842541574738592,0.28473788360024305,-0.6063076325459934,-0.28441623189987963,-0.31700040889491743},
{-0.19343505328538885,-0.23156551387916277,-0.3768566772582222,-0.39594847750764056,0.13257022117503434,0.37796207822670425,-0.49972785612327764,-0.2656021628235316,0.3598075953974291},
{0.23789172418365626,0.06407113383557492,0.43836849840019604,0.42504237692887953,-0.2082902535573904,-0.6507511002283436,0.27633332375852643,-0.1456393347143829,0.045185274017898985},
{-0.1974877279492876,0.5202458070731824,0.3166352143351694,0.589707399651717,-0.16229558767228638,0.03733139480976847,0.34747277006737215,0.2080739102734869,-0.2248658544110357},
{-0.10005076889636523,-0.15066116560377302,0.09097561412763383,-0.2898986670850905,0.8640287042369849,-0.11606507508455456,-0.15452644819603645,-0.2606371913444517,-0.15213936103031814},
{0.012152482765307906,-0.21105157834032356,0.3143662611058401,-0.43131625012704733,-0.36776644546639686,-0.4721224515362697,-0.18477758948926726,-0.23723124647830168,0.4710376897432475},
{-0.23027132637358871,-0.24712852725780848,-0.3513893372288542,0.03868711607670829,-0.20790661398349625,-0.5413646947970642,0.3066194391287801,0.563741347542124,0.11318466197330085},
{-0.12216527195092558,0.3379631136480547,-0.6097544452747226,0.42723847906955126,-0.5226163944957952,-0.06016700460208599,0.15010339903435407,-0.1175946308322539,-0.058445588128685624},
{-0.30620965953111207,-0.238504543807266,0.07907027869880409,0.25498693382356286,0.23309507895695325,-0.3673443534642351,-0.7043730005406575,0.2727929400451855,0.13508619364586968},
{-0.4553347722177406,0.01385389851788672,-0.2704534602382437,0.1431315353284531,0.5822189751232252,0.3106285712549492,-0.396790434484326,0.2679383473291551,0.18478082423180728},
{0.037678406614425765,0.21793776266675216,-0.03749026615340798,0.6318435275097958,-0.27816067046671433,0.28465470196450865,-0.14928873253143526,-0.23219974628248471,-0.5620019574583748},
{-0.361824551797292,-0.018924580353115027,-0.2520304731519063,-0.14413455828209662,-0.21976471297804132,-0.612204046212769,0.4268559712613897,0.05661661697954449,0.4194388380890334},
{0.48438283804262044,-0.5644312906613381,-0.15477555664352413,-0.08177405621519117,0.04687958679115198,-0.50450434651042,0.3257046531996736,-0.20228979205501563,0.11145000106217269},
{-0.8476905431113592,0.08660549500819797,0.053773322784137545,-0.3774718725381556,0.19796851136610813,0.06824363028618889,-0.054656688750390356,0.27783489518472587,-0.0671962750353737},
{0.2726864850316778,0.3723968707870716,0.10019287089478976,-0.16529488859642053,-0.2115755277279034,0.4394652346304896,-0.7068031857727278,-0.10851800969841059,-0.018995833892430484},
{0.4135491358707258,-0.11274777512174748,-0.17074717990861044,0.42589350829214734,0.42168870052120716,0.16776405927837792,-0.24741662802061745,0.4764536239196454,-0.3339700409819062},
{0.23675082012484283,0.10260100782542717,0.5374401393605126,-0.5154679851447358,0.07021808654853705,0.2595265887077236,0.17533591089533457,0.2579346066572242,-0.4575099587688563},
{0.44277518519485387,-0.42958942089752505,0.5332157362368652,0.09625707899031644,0.34550852606853144,0.04925639169806229,0.39754525531661095,0.1559659451851326,0.1471348986842295},
{-0.060399308833069376,0.06434291955115876,0.6709297856018461,0.36532210993490755,0.008171054816387224,-0.15972580082189045,-0.5211341889542488,-0.20170741209853035,0.26600577137271475},
{-0.23471892712595543,-0.6296051100894922,-0.6226859107747358,-0.12631999218927453,-0.245114857534061,0.04305210866639217,-0.13048000179497293,0.195169098240377,-0.16661080839199519},
{0.08249873746690341,0.21928579043370788,0.013747638129259566,-0.550958487013583,-0.101340984465967,0.016399189776966215,0.0459905302081808,-0.3925001228033185,0.6889506837477408},
{-0.33893126060507267,-0.15250994833955955,-0.15849388548271057,0.22408006382784665,0.6589577935376976,-0.42806920925836656,0.29636839656892044,0.09870090859932176,0.2673750401202475},
{-0.062430449649852955,-0.5891014470308837,-0.024313264353199415,0.15087869510100532,-0.12785894736928843,0.058313379075277345,-0.6816532856030064,-0.31600348355425306,-0.2035894020090168},
{-0.40176279038716683,-0.092138745209173,-0.5444063964833539,-0.06618235395345419,-0.37861225060251313,0.31584535921532025,-0.08626955728601882,-0.48884000203613126,-0.1995649569328743},
{0.04961245256943711,0.03750335192280989,-0.374420279709151,-0.46100071334566145,0.15883787545256084,0.24208351819186077,0.04718223373256336,0.6999899595313624,0.25956481367621187},
{-0.723260822194174,0.0030994219888698365,-0.16516987833250776,-0.20179509885290944,0.03436125140528886,-0.04420365731253695,0.09601465444233996,0.04724953080915899,-0.6279298010809825},
{0.36465984556298986,-0.15226563445458308,0.09809073387238192,-0.05972359723301918,-0.41843692070046634,-0.74675038254425,-0.1673838561103167,-0.04719641298765129,0.2601523137308469},
{-0.238061128327689,-0.1748423993983753,0.3839164818996246,-0.43949524441765686,0.4333628110625972,0.309082837060528,-0.03215139800665501,0.23470070737300155,-0.48244734324008337},
{0.36437915857585423,-0.624920020138594,-0.08180904904045531,-0.04553975864036885,0.024137510176713433,0.3983112615120159,-0.020405806580337894,0.25951327614118713,-0.4908545499667437},
{-0.484411675540442,0.6243330344429444,-0.005954728106563914,-0.2357298627315066,-0.04223935199489175,0.0672125293392657,-0.22747392015729578,0.3533786241098345,-0.37017163646950474},
{-0.6430233506444016,-0.07860767612826254,-0.31220934009137274,-0.4245853137471068,0.36494075697332956,0.2871095352234091,-0.27585732174914696,-0.02642228907712514,0.10092275487017383},
{0.1572958056094113,-0.05593644697335528,0.0490296164127671,-0.5055267645136968,-0.40208112873683,-0.20746948701237533,0.45674735087484447,-0.17635111675643866,0.5193623489169394},
{0.28104858373634345,-0.23542102274066812,0.394184973139553,0.6345840896300846,0.12255804933916375,-0.2825005627125199,-0.075095450876159,-0.008676034684197377,0.4549376133713433},
{-0.20761160528255546,-0.6730746637805015,-0.4089587420388172,0.3240730662298919,0.42841330382859033,-0.012292982991502591,0.05078030736910506,0.16851783682537008,0.13012046768356375}};

static param_t loda_delta[35] = {0.002686689362203426,0.001562429552478054,0.0013252922953714025,0.0007536673616102135,0.0039366899165181515,0.004044297157707195,0.0009626916019801807,0.0008738382708243551,0.006002284636731488,0.0013302689060609779,0.0015044278204508514,0.0015133646526018533,0.0007655678669894408,0.0009412741929316358,0.006012977096806981,0.0011087781823729658,0.0025427056692173835,0.0019272273342765963,0.004723837348482005,0.0031301037566056076,0.0031976252312114987,0.004615248515381104,0.001147968875973845,0.003452302789896466,0.0015148077353411748,0.0020892181567697446,0.010262258738937937,0.0006320451755542243,0.001605908803093045,0.001197185961892312,0.0032665169092382955,0.0017420294687405318,0.0020336622385577277,0.0017680117339006365,0.002997493029528676};

const static score_t log_LUT_loda[128] = {15.0,7.0,6.0,5.415037499278844,5.0,4.678071905112637,4.415037499278844,4.192645077942396,4.0,3.830074998557688,3.678071905112638,3.5405683813627027,3.415037499278844,3.299560281858908,3.192645077942396,3.0931094043914813,3.0,2.9125371587496605,2.830074998557688,2.7520724865564143,2.678071905112638,2.6076825772212398,2.5405683813627027,2.476438043942987,2.415037499278844,2.356143810225275,2.299560281858908,2.2451124978365313,2.192645077942396,2.1420190048724277,2.0931094043914813,2.0458036896131246,2.0,1.9556058806415466,1.9125371587496607,1.8707169830550336,1.8300749985576876,1.7905466343710503,1.7520724865564146,1.7145977811377517,1.6780719051126376,1.6424479953819162,1.6076825772212398,1.573735245297902,1.5405683813627027,1.5081469036703252,1.4764380439429872,1.4454111483223626,1.415037499278844,1.3852901558847919,1.3561438102252752,1.3275746580285044,1.2995602818589078,1.2720795454368008,1.2451124978365316,1.2186402864753405,1.1926450779423958,1.1671099858352583,1.142019004872428,1.1173569506381587,1.0931094043914815,1.0692626624371138,1.0458036896131249,1.0227200765000835,1.0,0.9776321869715455,0.9556058806415466,0.9339108095422276,0.9125371587496606,0.891475543221831,0.8707169830550335,0.850252880495318,0.8300749985576876,0.8101754411199827,0.7905466343710502,0.7711813095041191,0.7520724865564145,0.7332134593050986,0.7145977811377517,0.6962192518228971,0.6780719051126376,0.6601499971153753,0.6424479953819163,0.6249605686530753,0.6076825772212398,0.5906090638622983,0.5737352452979021,0.5570565041512716,0.5405683813627027,0.5242665690336022,0.5081469036703252,0.49220535980130375,0.47643804394298717,0.4608411888919686,0.44541114832236267,0.4301443916690522,0.4150374992788438,0.40008715781287235,0.3852901558847918,0.37064337992039037,0.3561438102252753,0.34178851724820525,0.3275746580285044,0.31349947281678164,0.2995602818589079,0.28575448233387735,0.27207954543680085,0.25853301359885306,0.24511249783653147,0.23181567522307364,0.2186402864753404,0.20558413364989406,0.1926450779423959,0.1798210375848123,0.16710998583525832,0.1545099490556248,0.14201900487242788,0.12963528041659547,0.11735695063815874,0.1051822366920565,0.09310940439148148,0.0811367627254055,0.06926266243711372,0.05748549466076013,0.04580368961312479,0.03421571533791296,0.02272007650008353,0.011315313227834146};
