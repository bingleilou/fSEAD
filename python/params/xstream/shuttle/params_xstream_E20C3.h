#define ENSEMBLE 140
#define DIM_MAX 9
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.977841397161868;
const static param_t delta_xstream = 0.14331079528501967;

static param_t xstream_fs[20][2] = {{17,10},
{7,14},
{7,5},
{9,2},
{5,6},
{15,16},
{15,6},
{3,3},
{17,2},
{3,9},
{1,11},
{10,16},
{5,4},
{17,19},
{14,16},
{3,12},
{5,10},
{3,1},
{2,12},
{15,9}};

static param_t xstream_R_T[9][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0},
{0.38729833462074165,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0},
{-0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,0.0},
{-0.38729833462074165,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,-0.38729833462074165,0.0,0.0,-0.38729833462074165},
{0.0,-0.38729833462074165,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.00012799231138014235,0.00012234015150303773,0.0005171735398040283,0.00827560544061414,0.00012223879263683805,0.0006619635681250126,0.000521772031417927,0.000684514553942633,0.00828888891644177,1.0,0.04034357652299393,0.0005218247569667769,1.0,0.00012424757699204138,0.026481937409965246,0.0005172253400383838,0.000521772031417927,0.0005172253400383838,0.007836081631173329,0.0005265067082935586};

static param_t xstream_shift_deltamax[20][20] = {{-0.8205797432075211,-0.13169925151093675,-0.4854385059555696,-0.06444567426316761,-0.2727039313906554,-0.9519264281730415,-0.9732379333338683,-0.743436066917239,-0.24029903111586282,-0.5972295256760483,-0.7424293476907542,-0.0809929002623485,-0.7428935454049537,-0.32536129261087476,-0.7319412283368756,-0.5381867690728003,-0.1495867412759101,-0.7869238570871213,-0.5518631334774247,-0.040686406479201076},
{-0.873144467779613,-0.6071376769544232,-0.24892710552239464,-0.5461925189041509,-0.6412077180820711,-0.1518557696927364,-0.3493015645444776,-0.1423566187108246,-0.8811164968088369,-0.9373661643311969,-0.8289919680968912,-0.7907465086682602,-0.5104266246317736,-0.8330165624611683,-0.40647529609808886,-0.59900307289422,-0.08477773984743764,-0.4217093781516976,-0.2385725238960561,-0.6371314071937773},
{-0.9198802964409654,-0.07284639876372023,-0.07070328879855005,-0.24712303172047612,-0.7764993568118891,-0.36770528244828427,-0.757698603770015,-0.0656199205989515,-0.3740692825695764,-0.3335533721409589,-0.7488434930146209,-0.746876349429506,-0.49685533168824747,-0.44885372202519913,-0.4762476060105684,-0.73050381351231,-0.36158276672447276,-0.03280004348892973,-0.4767950154552342,-0.5655507245088356},
{-0.4140993295239478,-0.7595799963183583,-0.3271789855487488,-0.8319588493341665,-0.009271508280157548,-0.6187268884066153,-0.5996638941197455,-0.7447946121871061,-0.8833191502642948,-0.12073034139599248,-0.37910344338241864,-0.8076161993622382,-0.5576907142502905,-0.44931778476825623,-0.8597622919614037,-0.6549212512890233,-0.07399661488211073,-0.7014877460975093,-0.9711126088696492,-0.017423108442655377},
{-0.5511524610516345,-0.020259556995036565,-0.28635301192080653,-0.35050331118054046,-0.8315499651477601,-0.9284671535671902,-0.052986233412028017,-0.519520651596504,-0.7392383733371459,-0.7884345557898713,-0.6004676110605899,-0.6806809640839222,-0.7859719045065136,-0.49150426622661697,-0.986110292649379,-0.12378838039299533,-0.663781699087156,-0.5133212183093024,-0.5425995351103023,-0.1839293832241109},
{-0.8091512160174276,-0.06658929950460424,-0.8456313353261024,-0.26153077793167623,-0.10650716459464882,-0.3945250681749564,-0.44642271204894746,-0.05420117182880391,-0.7126437473775424,-0.4675491660139717,-0.88934435040951,-0.8241017634229075,-0.7162481052647857,-0.4591676471912458,-0.35432696924882223,-0.870511732800923,-0.5912863582353802,-0.20902678252562734,-0.38249796016528137,-0.896219607154878},
{-0.39752957455766413,-0.9326568613121909,-0.2204500571714807,-0.1368198343288024,-0.04253733147047556,-0.6948177451625247,-0.011136053363717702,-0.4093693332701499,-0.1780881263018903,-0.7511631300591146,-0.4585066188258319,-0.8146782241307003,-0.21192567628193415,-0.27281584241898416,-0.8199607434319055,-0.6338841101073694,-0.32742232432254526,-0.3097587519922259,-0.02823035495760229,-0.059404841560014465},
{-0.5759096239168038,-0.82606278232389,-0.2035257323893942,-0.4176141902256936,-0.6654876793078707,-0.38187005425927,-0.2690783696054676,-0.2076947571253328,-0.34485866593732084,-0.02985894692842317,-0.2148990530337147,-0.46622225385138955,-0.2417509647880728,-0.9177131840434275,-0.08151880204552575,-0.6024842171864185,-0.5415772780704444,-0.31523237663252157,-0.948560574189653,-0.8433334319795466},
{-0.9717950157955608,-0.8831351522896015,-0.019094394999719544,-0.33459781106915787,-0.01094762271189098,-0.7085370663015133,-0.9343941971034938,-0.9324430665174616,-0.7411367052635771,-0.6543804523811707,-0.33604612413121937,-0.5668238385124479,-0.9435947708052758,-0.6585882354372438,-0.6547479146928342,-0.332093177367521,-0.7659037070332843,-0.704327713418932,-0.3503160715019591,-0.4840435839042826},
{-0.4515567266669862,-0.2437132592682938,-0.6073107630049522,-0.2151140941408375,-0.4052957876676273,-0.07781795457008123,-0.5941010777850552,-0.44086048372084874,-0.9442584404794202,-0.07862239780564273,-0.3613222426257158,-0.901213875396626,-0.6999142153154914,-0.11644703469837414,-0.006172273025518926,-0.6134262640910104,-0.9992574747972889,-0.9814158878357734,-0.8882066373165065,-0.48482734836797425},
{-0.978946725723157,-0.3014274717033485,-0.2817678127721248,-0.556594364547998,-0.6045008325471992,-0.4294135187422051,-0.82100756330041,-0.3677315391300551,-0.5063754913988182,-0.4634916705293076,-0.7103174799368189,-0.9886272093511285,-0.7872681270566724,-0.09360571300445764,-0.9924393731322831,-0.329689576401738,-0.4670226674828418,-0.41986529642181436,-0.08018259233115932,-0.025401174063364507},
{-0.8076135952623396,-0.9556624823448766,-0.9014792942763846,-0.04105110468169204,-0.6681602571681455,-0.5183415136984966,-0.105553269397339,-0.48284504296162206,-0.6662407118500188,-0.6049497125550773,-0.8514654476672856,-0.10008077904121904,-0.9054058575825998,-0.0014564347960299706,-0.9273761072287142,-0.7938426368816894,-0.13908821687994577,-0.7737006519076656,-0.7430326707996279,-0.5427351103103061},
{-0.6952005561653937,-0.4543074799045803,-0.3012614994466394,-0.3598312744793054,-0.023788484369762664,-0.4434677804049487,-0.781817543054125,-0.488568253129423,-0.8570747071167375,-0.010864351446278064,-0.4765318066939961,-0.9985104383762765,-0.8038453215115933,-0.684065090757155,-0.8787764895231398,-0.8508904837825103,-0.9931018872758365,-0.6156637739032146,-0.8556661058066752,-0.1634822920214709},
{-0.3832010222616917,-0.787868776196072,-0.321048624038637,-0.23002273187346678,-0.6542082604615065,-0.060751056479232846,-0.44762759975502897,-0.30123710368384016,-0.30260195718596816,-0.9377896789373664,-0.5395956329103166,-0.5432577290226575,-0.6718265249871385,-0.7274152210881701,-0.4634613161161997,-0.23528937761706847,-0.48843828341329565,-0.1767543411067749,-0.43459159373598755,-0.020701471072975708},
{-0.6366850820918296,-0.040115227683358956,-0.6286626564983441,-0.2695791087792956,-0.7289920224210288,-0.8069433912476741,-0.5914869951745786,-0.5912840010590518,-0.22171214184746657,-0.973439721306905,-0.5605054599627284,-0.3501974369940767,-0.2813367773182306,-0.03707891059060053,-0.45787256832400536,-0.9761632140310976,-0.2690155045421596,-0.10986437185281017,-0.842019248182584,-0.24717145125725126},
{-0.14207118811980915,-0.9968782958122901,-0.28973128419839367,-0.6700668118230725,-0.9591402839780175,-0.8430592740152328,-0.597388634623591,-0.8871393266990634,-0.3004986141138254,-0.5848756720603864,-0.1061111844322008,-0.4613252382490346,-0.48965856641437144,-0.6515566601364302,-0.7248016468876874,-0.8826170177296143,-0.5343295385328897,-0.9895759279125012,-0.841213232636984,-0.40587199085836323},
{-0.4317698678261639,-0.4840225203826962,-0.08033280755804129,-0.8076653977152933,-0.7875996542158173,-0.008808943135707792,-0.31326166143328515,-0.8902422802218681,-0.15001376925954935,-0.49118086715109865,-0.348090772352603,-0.20769871978690346,-0.2577265250779902,-0.760576945533337,-0.7656340197575628,-0.7690645634580715,-0.20752738502282675,-0.33251105656381097,-0.5384279772300169,-0.5496502014306435},
{-0.006538874985084431,-0.38971547464958334,-0.9636147823402119,-0.06637975089683312,-0.8424952077302865,-0.37377554561753057,-0.701269418294586,-0.745593727518909,-0.07268886703667554,-0.7393292016684493,-0.23634127040658623,-0.4096816046653675,-0.6380382882913344,-0.24125012306267024,-0.5616943588712825,-0.38439213568094244,-0.2517117374058344,-0.9777497245168157,-0.5910940004915125,-0.12347137876185177},
{-0.39595880829148167,-0.023141591598692224,-0.23307984857949848,-0.22722097657879148,-0.805608341599497,-0.8051687841465017,-0.3552713376608637,-0.45340804292519443,-0.23882359347993865,-0.3255139215096484,-0.4966819416846239,-0.9955420504941535,-0.2465612787432595,-0.4758221921843512,-0.4886302901299574,-0.35676414647902077,-0.1879847955858902,-0.644007006710149,-0.09071221777589811,-0.9664834314313702},
{-0.20170735907006687,-0.9473280652978162,-0.7006622020715167,-0.12400760299798841,-0.8537477720907026,-0.9892350306486498,-0.9681584587654652,-0.08595754770028208,-0.2344465261171288,-0.9870824915136265,-0.7772452487092831,-0.5051809484936344,-0.5964317581465488,-0.8956730910215138,-0.8560473626522426,-0.41264488363276774,-0.9609992741511644,-0.5532911421319855,-0.802590475490331,-0.7964470639698467}};

static param_t xstream_shift[20][20] = {{6411.164345414203,1076.5006409826674,938.637553149985,7.7874271224783085,2230.9115257775625,1438.0344689804274,1865.2550821650461,1086.0778089161622,28.990499636110176,0.5972295256760483,18.40266559578833,155.21091933839602,0.7428935454049537,2618.6530191386805,27.639262830575362,1040.5266861690516,286.68984205497725,1521.4333022212775,70.42590410008171,77.27614071826032},
{6821.850924985162,4962.701692741878,481.3221991533444,66.00030932161229,5245.533797008691,229.40200489108827,669.4524495597108,207.9672636482103,106.300917492218,0.9373661643311969,20.548301354105405,1515.3487796643672,0.5104266246317736,6704.489396316572,15.34915251121811,1158.1085196826732,162.48042199014054,815.3300805416884,30.445385222503567,1210.1107111412887},
{7186.9965197275305,595.4414627475055,136.71095552440968,29.86162565311196,6352.315333470352,555.4766155632943,1452.1640834426337,95.86344106344728,45.12900176856945,0.3335533721409589,18.561653615113066,1431.2781052606472,0.49685533168824747,3612.575254115018,17.983865705813304,1412.351168753833,692.9899361256747,63.41538387600192,60.846101137902735,1074.1567307695302},
{3235.345350503563,6208.754746388374,632.6290120579761,100.5314783678747,75.84751190812624,934.6842004600591,1149.2833230063054,1088.062493189188,106.56665316290466,0.12073034139599248,9.396872465343959,1547.6770478593007,0.5576907142502905,3616.310238364142,32.46598912502044,1266.2203503803992,141.81790212293157,1356.2516988155517,123.92834257958599,33.091902093944384},
{4306.1372601881485,165.60022810281967,553.6884428180796,42.35379679417501,6802.668344559247,1402.5955479650324,101.55054357366907,758.9621704961489,89.18425385950087,0.7884345557898713,14.883846768477548,1304.424435591237,0.7859719045065136,3955.845885494412,37.23709022430897,239.33162358945694,1272.1680333905877,992.4517972596014,69.24373183553178,349.3391068467819},
{6321.873613284596,544.296362939773,1635.101702315505,31.602615640441623,871.3041277417827,595.9921167450863,855.5895777621195,79.18191295804989,85.9757869313399,0.4675491660139717,22.044261492349985,1579.2691941508936,0.7162481052647857,3695.586330996681,13.379948897375149,1683.0415399530145,1133.227391718461,404.1309780184306,48.81240116790468,1702.199787842366},
{3105.8863635721464,7623.473159496887,426.25935049773705,16.532909321332856,347.98553350286,1049.6313975866833,21.34275640159407,598.043286168694,21.485162619158306,0.7511631300591146,11.36504639256524,1561.2103742762222,0.21192567628193415,2195.743764375053,30.963019462592317,1225.5472828541779,627.5198834110903,598.8854915136958,3.602611137344066,112.82827098737125},
{4499.564213715376,6752.180475298648,393.53469720534395,50.46327948118103,5444.161096101324,576.8747294370033,515.7010215251308,303.41905212834826,41.60493274958265,0.02985894692842317,5.326722902498057,893.446023069911,0.2417509647880728,7386.165640093016,3.078279386569728,1164.8389406862927,1037.9576624655335,609.4681606456635,121.05036915594525,1601.7524918397398},
{7592.604628486553,7218.686109504066,36.92067271453011,40.43182259838708,89.55931644723879,1070.3565882159019,1790.8092822918413,1362.1961156951627,89.41327513672726,0.6543804523811707,8.329606670833682,1086.2340871047174,0.9435947708052758,5300.612304732746,24.724320753301466,642.0667195904904,1467.8895397132042,1361.7424725684616,44.70551584204271,919.3493193526409},
{3527.998844601255,1992.095450872826,1174.2881571920316,25.993759089229087,3315.6069274320275,117.55624979558574,1138.621930674537,644.0483714796163,113.91857823144392,0.07862239780564273,8.956128181143761,1727.0431564710218,0.6999142153154914,937.2177511826497,0.23307482870178065,1185.9942207113972,1915.122725305503,1897.4628887342249,113.34831349676888,920.8379318457883},
{7648.48071862415,2463.8474613615626,544.8225616470916,67.25723798000364,4945.245445471015,648.696604193042,1573.4986044945797,537.2150774764586,61.0908767753391,0.4634916705293076,17.60670573001805,1894.5578877816097,0.7872681270566724,753.380591159967,37.47608635155314,637.4196136199968,895.0703360118738,811.7647453055099,10.232485584654796,48.2447301491966},
{6309.860229523432,7811.519526532115,1743.0885861213637,4.96049563699905,5466.024678051245,783.0363159813761,202.2976760760742,705.3831656033537,80.37756550560948,0.6049497125550773,21.105353591593214,191.79001706044184,0.9054058575825998,11.722037815862294,35.01919413493287,1534.8100246263605,266.56893912456457,1495.8676461022744,94.82196661194946,1030.822782998045},
{5431.580605655444,3713.478153517733,582.5152995274968,43.48096064529171,194.60666991726924,669.9277751206986,1498.3891354420027,713.7441422032473,103.40043349074824,0.010864351446278064,11.811838408089464,1913.4976350687957,0.8038453215115933,5505.661416648572,33.18399541237693,1645.1059488295082,1903.3252598401266,1190.3202071606268,109.19566003532724,310.50372093325706},
{2993.937824308596,6439.985291145475,620.7754251315552,27.795275345606203,5351.8874520064055,91.77401809484466,857.8988002453699,440.07406701404614,36.50693841314841,0.9377896789373664,13.375007359666604,1041.0731222881502,0.6718265249871385,5854.56262969832,17.50103509956177,454.9069030523668,936.1143449677705,341.73565644262095,55.460319862813165,39.3185324078215},
{4974.401002891878,327.89911726047586,1215.5738995010497,32.575152442174655,5963.671651983732,1219.0148070131888,1133.6119216033862,863.8004811634808,26.748113538797732,0.973439721306905,13.893301196121438,671.1016147062046,0.2813367773182306,298.4276352767476,17.28999511008988,1887.3074044644752,515.5805377515236,212.41103895771434,107.45411901183897,469.4554644106045},
{1109.9978318060994,8148.4147564386285,560.2206259589016,80.96891721475622,7846.447623444293,1273.5735236958237,1144.9226839548573,1296.0123661204314,36.253183887862086,0.5848756720603864,2.6301878409744472,884.0616166442367,0.48965856641437144,5244.019045765097,27.36966090007229,1706.4458165644292,1024.0670376310463,1913.2394554355435,107.35125949817673,770.8771502148945},
{3373.4047238493094,3956.366854512828,155.3304671938198,97.5959286013708,6443.123637155962,13.307292968794036,600.3803242998474,1300.545437776735,18.098175855871744,0.49118086715109865,8.628158491456693,398.0238902312699,0.2577265250779902,6121.463001101868,28.91155612615609,1486.9042638185488,397.735739991403,642.8746444231349,68.71137930570485,1043.9566918569649},
{51.088029543147385,3185.5075366643355,1863.2329540783403,8.021135296163543,6892.208189860598,564.6467020477214,1344.0149645217107,1089.2299122414202,8.769434331842778,0.7393292016684493,5.858213147559758,785.0942278912437,0.6380382882913344,1941.6887548489049,21.21047075127951,743.1811744807715,482.4170753687242,1890.3747531864083,75.43234339724529,234.51055193965198},
{3093.614014950226,189.15778110768167,450.68015016355827,27.456719415797718,6590.44746942893,1216.3339840999295,680.8937932058299,662.3789666905946,28.81249777713997,0.3255139215096484,12.311301686441674,1907.8091585400518,0.2465612787432595,3829.6295485491023,18.451455517226776,689.7654056403056,360.2814721115607,1245.118823185184,11.576221643101412,1835.6526445100837},
{1575.9334048667022,7743.394573729082,1354.791280190045,14.98471669388647,6984.26214521867,1494.3949762229688,1855.5200364697077,125.57446325310114,28.284433351746657,0.9870824915136265,19.26565058668733,968.1046016868032,0.5964317581465488,7208.777126324852,32.32570749638993,797.8048476939374,1841.7991312022375,1069.7293796373651,102.4224240208886,1512.7006957825508}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
