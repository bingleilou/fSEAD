#define ENSEMBLE 140
#define DIM_MAX 3
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.964051379979506;
const static param_t delta_xstream = 0.1435945752604345;

static param_t xstream_fs[20][2] = {{17,15},
{7,5},
{10,2},
{13,5},
{3,17},
{4,9},
{4,16},
{3,7},
{17,5},
{7,0},
{7,14},
{11,0},
{12,6},
{16,18},
{17,0},
{19,17},
{14,13},
{11,2},
{16,0},
{7,5}};

static param_t xstream_R_T[3][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.2779276393653878,1.0,0.2774557911045441,0.4964907665775345,1.0,1.0,0.2774557911045441,0.2779276393653878,1.0,1.0,0.2779276393653878,0.20501063765127978,1.0,0.2981485530810293,0.4964907665775345,0.20501063765127978,0.2774557911045441,0.39093570056855725,1.0,0.20501063765127978};

static param_t xstream_shift_deltamax[20][20] = {{-0.5731568438363703,-0.5204272727338343,-0.018781864537424253,-0.5005761769211217,-0.26346285069721564,-0.25031002221488863,-0.9649263855994458,-0.05294907269915605,-0.08229929399087366,-0.07584860340146249,-0.6013521780952572,-0.5517803441228484,-0.2458388695616457,-0.12610249224818848,-0.13054419611442936,-0.8547455905435224,-0.6496482088503224,-0.44827952895824785,-0.2605597797621326,-0.22556341703272675},
{-0.43847003316569133,-0.35858020896948506,-0.6013982922378103,-0.5775696976203983,-0.6783923883868371,-0.865168838952895,-0.23917934919216444,-0.5122494199378019,-0.3169674032788963,-0.3677828036695917,-0.203831575818035,-0.7660700469304015,-0.2727827980894405,-0.0008202299269067792,-0.7705551501389832,-0.5121236702425611,-0.5989566961307303,-0.09573069013692315,-0.752202562222831,-0.05764150221129549},
{-0.8284010102881845,-0.8301770830594349,-0.035725653327369766,-0.9558889765137972,-0.7684420098158273,-0.367174605161,-0.18095077606422139,-0.9975349614685664,-0.41598220037920175,-0.2742067449179949,-0.739381029389499,-0.2607242119702249,-0.7322984700714065,-0.8877896665379704,-0.5687230973983394,-0.7892952376471112,-0.582108919616363,-0.5829287461149277,-0.9999189497421453,-0.048320208897111416},
{-0.5645746977255428,-0.3588373007541429,-0.4114375298953873,-0.9227928085009313,-0.4422170606769612,-0.3320930624963637,-0.6693213476454097,-0.5812127895307503,-0.45886415224195953,-0.5536735504736461,-0.005821433383917385,-0.7834728589916998,-0.11108952498760516,-0.6326406271643159,-0.04430660685407506,-0.49309122806807526,-0.7343302148965792,-0.35750164524595063,-0.4618252282300256,-0.24203495736656447},
{-0.5539498015591064,-0.7166343014661148,-0.4267535677244977,-0.09364717894598396,-0.3497711704696711,-0.5300834191984504,-0.9483184309657361,-0.6471542998332749,-0.3332397068179658,-0.8700116068193485,-0.5201392396714277,-0.5077621058053782,-0.963570787176721,-0.004766696980974982,-0.2667528239953182,-0.08890684850894648,-0.920574480257215,-0.07146895212391591,-0.2617738832592261,-0.7291531513197679},
{-0.7922573793348275,-0.8016469559650755,-0.7038947750038468,-0.3351393547172269,-0.19898221348109668,-0.04140191981608188,-0.4652839578943033,-0.0762580166445167,-0.8966568708883397,-0.2814896934060199,-0.5112654874646756,-0.3719764710331539,-0.6831162701097666,-0.8914056854112318,-0.793484654280918,-0.9740721914585706,-0.9914286760253582,-0.32381140549230836,-0.32076659141679686,-0.5172737123134915},
{-0.48617426566680044,-0.9176664910866181,-0.6605370933385238,-0.10629483703293474,-0.334288633597688,-0.9865163046135836,-0.0888272967487479,-0.8156634802240009,-0.16002428014817005,-0.7738389134862717,-0.8126592855123382,-0.7522396780371232,-0.6004297163231219,-0.3940067097428057,-0.15714462471735458,-0.8287844527306963,-0.14330804683417986,-0.34584771771495926,-0.4018439890231187,-0.02667408122998316},
{-0.4135082692272941,-0.3937035402851662,-0.610205826813811,-0.09293098464559768,-0.45403362085843,-0.8004565801650848,-0.9938104953158031,-0.5339195936376516,-0.9635969895340265,-0.2532248965911723,-0.1536922505905215,-0.9896464068876737,-0.27316064765606807,-0.17464319785195714,-0.38102283204889176,-0.338528671730131,-0.6972570540208561,-0.4127635467019153,-0.6434397539006783,-0.18067002818089073},
{-0.847068111093284,-0.7726079257610723,-0.18057569129252105,-0.6208637857677719,-0.6997898003163476,-0.8613335997804021,-0.33540974400238033,-0.023867362435273987,-0.6544828381159714,-0.6873604585643381,-0.5172085445751492,-0.2796380504154179,-0.9664037549219924,-0.9515182686730163,-0.20174261050858555,-0.20956824074011168,-0.10956707386128162,-0.2906205649900606,-0.5974895632716684,-0.0045001753112129395},
{-0.31224001057325623,-0.2945390809767582,-0.4715359250642648,-0.2831633411411625,-0.16892448896877932,-0.8713684518566135,-0.07567926694566385,-0.34807468994583535,-0.984770249147137,-0.5957905808639294,-0.10282765949232331,-0.3448874658108363,-0.8491588280233282,-0.5513480250551354,-0.3935625998272142,-0.2783776291839074,-0.13448687572026752,-0.6821460160882666,-0.2082920496217472,-0.9910611039696244},
{-0.7089519856465363,-0.3817746216348288,-0.06704367094973196,-0.5160044910795496,-0.3295024905730669,-0.18340840148122906,-0.5204887783967836,-0.5251870784084609,-0.8180505216321688,-0.7695539385612707,-0.4276386637084004,-0.10240618142171021,-0.966061955503988,-0.5897584011904043,-0.48737671177876163,-0.2899332577460405,-0.8603670808148975,-0.45319438860059524,-0.44074262412510656,-0.3803735018526164},
{-0.47576397007795457,-0.13920041175297737,-0.23994286298749357,-0.321979194074934,-0.005171957156433482,-0.28671773964147607,-0.21842091772863495,-0.49587157174513563,-0.16349814601407786,-0.6493884866829466,-0.8189904521983339,-0.5459745147029749,-0.8214304414043733,-0.5982036281318751,-0.9821836638235443,-0.6497808140627878,-0.5068443686932524,-0.952277925102993,-0.6448776446698754,-0.8562345143501322},
{-0.5745255084765789,-0.13212491291961725,-0.6401154392885858,-0.412011909946715,-0.7391261880717469,-0.43881209536132615,-0.4690155346550887,-0.33800703679967814,-0.4131494245942581,-0.2616683968440915,-0.9681365631035983,-0.950089111319901,-0.4077334245536063,-0.26069476790507773,-0.38460091599658097,-0.20627477577128617,-0.2600480034543221,-0.4527037841099433,-0.4463651862456429,-0.42972876461630705},
{-0.950340505764987,-0.058243162056590636,-0.8499303115507331,-0.20594549814511043,-0.41179958346794565,-0.5359024774778017,-0.1745336630853821,-0.3695409014047627,-0.6270162784439249,-0.16397161682611938,-0.44978475658679784,-0.7504917349589156,-0.7944080786895776,-0.044531209236984504,-0.22953446719757342,-0.7035144561578264,-0.03236292866942092,-0.33186157256257964,-0.19895456503770081,-0.8667861346646587},
{-0.5371096136369561,-0.7990149735022601,-0.25360514960927105,-0.8656822963546927,-0.6090993709384985,-0.7878803907966059,-0.5789401001070473,-0.37951795865515825,-0.3895427966672984,-0.7955497949858235,-0.234922809564574,-0.4315847788752097,-0.9266354660043621,-0.9830667298857272,-0.3094769770072283,-0.6280607910636078,-0.9766415635158219,-0.4447709919561944,-0.026943976778074474,-0.8837331467609738},
{-0.1702522696756108,-0.1168915390723887,-0.8370320014158551,-0.12669456302735127,-0.8335758837863172,-0.28880169522430377,-0.5654783298890067,-0.6993190818491908,-0.4939444366906983,-0.30585751136052874,-0.7896905894835828,-0.7462824510042053,-0.6798018462342479,-0.2702151782642017,-0.8191204392992397,-0.7534821513583381,-0.7109141675473002,-0.8247139010028032,-0.7011040395506789,-0.7941530943387798},
{-0.7579590949108126,-0.8757633572313827,-0.32771541054369835,-0.48496546766628,-0.9963430141486529,-0.3200043817251479,-0.9372011284612783,-0.11863638539982857,-0.33833471770479284,-0.689035196985347,-0.3068496182285364,-0.7076286766377512,-0.5473792025718076,-0.044597420425992795,-0.878426729524688,-0.38478037530497267,-0.34122805073074836,-0.06308310981152576,-0.03303581223409069,-0.24451884559446377},
{-0.7641343481204648,-0.06332472688049395,-0.22150599800901993,-0.8069934264494546,-0.8787496668924991,-0.24947583290853892,-0.459344641180361,-0.7025828925822795,-0.5008471873507179,-0.6327583314387609,-0.11348579510631895,-0.27956871096828373,-0.16471622695695798,-0.23113480088341298,-0.9947218856388673,-0.3623392459877387,-0.051903609156142116,-0.0867881267146916,-0.6628111359647035,-0.6516445686624905},
{-0.40240843864311915,-0.47427490611537715,-0.6893540502778477,-0.7962847985052749,-0.23468493924269784,-0.18658459398615568,-0.2916567287224273,-0.8978357357319119,-0.46570605516697516,-0.5392468156099319,-0.2019130240691236,-0.2286330134251576,-0.9778907521480489,-0.42897353723689136,-0.5616722435641535,-0.09254947484068343,-0.8251062785603751,-0.09374059044502114,-0.7328386136985751,-0.40980445189578385},
{-0.7818980677429301,-0.9091294059848808,-0.15090598264370103,-0.07156364824588668,-0.8709688560600626,-0.6289296036507025,-0.22126598997742408,-0.8494727143033068,-0.20107077259763495,-0.38721643189965693,-0.3901707480298875,-0.3153475307689969,-0.45157747551884186,-0.1470659393627669,-0.878793719289868,-0.47788939116774404,-0.2821782615681955,-0.8316917349743316,-0.06313126301571204,-0.31461703136088914}};

static param_t xstream_shift[20][20] = {{2.062252049292761,0.5204272727338343,0.06769317902017526,1.0082285726515101,0.26346285069721564,0.25031002221488863,3.477766247942058,0.19051387915235235,0.08229929399087366,0.07584860340146249,2.1637005210002433,2.6914717716327434,0.2458388695616457,0.42295188403586514,0.26293378427621356,4.169274337839155,2.3414476456378517,1.1466835295581668,0.2605597797621326,1.100252258209191},
{1.5776409793818333,0.35858020896948506,2.1675463678147056,1.1633040058363344,0.6783923883868371,0.865168838952895,0.8620448981799869,1.8431035542469183,0.3169674032788963,0.3677828036695917,0.7333980034639892,3.7367331554447234,0.2727827980894405,0.00275107800601622,1.552002981748603,2.49803461961655,2.1587464213534693,0.2448757941464472,0.752202562222831,0.2811634697187903},
{2.9806355790296073,0.8301770830594349,0.12876160625498892,1.9252905408554477,0.7684420098158273,0.367174605161,0.6521787681700971,3.5891894874015047,0.41598220037920175,0.2742067449179949,2.66033644972404,1.2717594313994238,0.7322984700714065,2.977675582737749,1.145485748544177,3.850020890085183,2.09802403942986,1.4911115696702693,0.9999189497421453,0.23569610558113288},
{2.0313729826032305,0.3588373007541429,1.4828940072127001,1.8586303525079217,0.4422170606769612,0.3320930624963637,2.412353135542276,2.09123781592171,0.45886415224195953,0.5536735504736461,0.020945859854780487,3.821620516708875,0.11108952498760516,2.12189735830239,0.08923953845001852,2.4051982556476728,2.6466566510406224,0.914476842933552,0.4618252282300256,1.1805970662764462},
{1.9931439810159939,0.7166343014661148,1.5380957305868552,0.18861816825219757,0.3497711704696711,0.5300834191984504,3.4179082267142658,2.328499250060084,0.3332397068179658,0.8700116068193485,1.8714915898940427,2.4767597995040354,0.963570787176721,0.015987657601274737,0.5372765053298544,0.43366944041301786,3.3179140957643467,0.18281510749715377,0.2617738832592261,3.5566600820004624},
{2.8505886681290353,0.8016469559650755,2.536961914551001,0.6750162888777305,0.19898221348109668,0.04140191981608188,1.6769661070760868,0.2743808309912686,0.8966568708883397,0.2814896934060199,1.8395633073129574,1.814425218587343,0.6831162701097666,2.9898038283250368,1.598186124891415,4.75132511472626,3.5732852144786995,0.8282983749536645,0.32076659141679686,2.523155472514391},
{1.7492836148895345,0.9176664910866181,2.380693121267872,0.2140922735898155,0.334288633597688,0.9865163046135836,0.3201493700856947,2.9348051963686093,0.16002428014817005,0.7738389134862717,2.923995927025976,3.6692714419857193,0.6004297163231219,1.3215113931333573,0.3165106690716555,4.042641212308442,0.5165076795249951,0.884666499406362,0.4018439890231187,0.13011071784165365},
{1.487827083954253,0.3937035402851662,2.199290288317998,0.18717565542295964,0.45403362085843,0.8004565801650848,3.581869714665064,1.92107411431547,0.9635969895340265,0.2532248965911723,0.5529937610431913,4.827292955261416,0.27316064765606807,0.5857589984831941,0.7674318591570208,1.6512736880803403,2.5130383880080296,1.055834875406909,0.6434397539006783,0.8812714805960845},
{3.047800906118786,0.7726079257610723,0.6508268959665755,1.2505041937588877,0.6997898003163476,0.8613335997804021,1.2088763498758597,0.08587617442357319,0.6544828381159714,0.6873604585643381,1.8609467764923588,1.3640172706114806,0.9664037549219924,3.1914233989739254,0.4063370843716998,1.0222310565980695,0.39489921412379975,0.7433973529851499,0.5974895632716684,0.021950935633241016},
{1.1234579305829977,0.2945390809767582,1.6994993082937386,0.5703295211169698,0.16892448896877932,0.8713684518566135,0.2727615330874396,1.2523932155168855,0.984770249147137,0.5957905808639294,0.36997996934424054,1.6822905862937954,0.8491588280233282,1.8492393116034773,0.7926886587240358,1.3578691933899734,0.48471461051462955,1.7449059144411414,0.2082920496217472,4.834193558557705},
{2.550850959858967,0.3817746216348288,0.2416373097956719,1.0393032978972183,0.3295024905730669,0.18340840148122906,1.8759340950308936,1.8896540106901871,0.8180505216321688,0.7695539385612707,1.5386690747449898,0.4995164280006859,0.966061955503988,1.9780689696324734,0.9816430527769955,1.414235188318437,3.1009159239019635,1.15925557052347,0.44074262412510656,1.8553842191331866},
{1.7118267588077989,0.13920041175297737,0.8647967376434545,0.6485099336175714,0.005171957156433482,0.28671773964147607,0.7872278205443364,1.7841750927593778,0.16349814601407786,0.6493884866829466,2.946775837294894,2.663152122045832,0.8214304414043733,2.0063945370524685,1.9782516210604322,3.169498039258118,1.826757216620055,2.4358939941224294,0.6448776446698754,4.176537003931353},
{2.067176585201941,0.13212491291961725,2.3070898493064544,0.8298480811372212,0.7391261880717469,0.43881209536132615,1.6904153731589107,1.2161692071053962,0.4131494245942581,0.2616683968440915,3.483412320250747,4.634340550347389,0.4077334245536063,0.8743787793403359,0.7746386073758327,1.0061662074441067,0.9372592383784023,1.158000621205875,0.4463651862456429,2.0961291059797085},
{3.4193810588071343,0.058243162056590636,3.063299951920928,0.41480227228545835,0.41179958346794565,0.5359024774778017,0.6290503520959798,1.3296299074412394,0.6270162784439249,0.16397161682611938,1.618352020021556,3.6607453328128834,0.7944080786895776,0.14935913247542087,0.4623136675427541,3.4315997658350517,0.11664174872899558,0.8488904238726135,0.19895456503770081,4.228005651780127},
{1.9325519939771993,0.7990149735022601,0.9140380476459897,1.7436020055762778,0.6090993709384985,0.7878803907966059,2.086603050533933,1.3655279464890178,0.3895427966672984,0.7955497949858235,0.8452660919259064,2.105182364289454,0.9266354660043621,3.2972379698872945,0.6233287662941841,3.063552205188154,3.519989831993911,1.1377088132635158,0.026943976778074474,4.310669713950119},
{0.6125776841208024,0.1168915390723887,3.0168121490045423,0.2551800991198615,0.8335758837863172,0.28880169522430377,2.0380844373002724,2.516191205185625,0.4939444366906983,0.30585751136052874,2.841353207211562,3.640213305777924,0.6798018462342479,0.9063105471142905,1.6498200861733885,3.675331972968157,2.5622610532552583,2.1095896327794588,0.7011040395506789,3.873716522406135},
{2.7271814226232243,0.8757633572313827,1.1811446041153872,0.9767864788489382,0.9963430141486529,0.3200043817251479,3.3778394919432233,0.42686069536199994,0.33833471770479284,0.689035196985347,1.1040629817501717,3.4516680926646237,0.5473792025718076,0.1495812069692397,1.7692710291068594,1.8768800473635845,1.2298465617615282,0.1613644129195181,0.03303581223409069,1.1927129655115112},
{2.7494003470301402,0.06332472688049395,0.7983469983712016,1.6253946312281125,0.8787496668924991,0.24947583290853892,1.655559753688046,2.527934588249437,0.5008471873507179,0.6327583314387609,0.40832856841964066,1.3636790469567057,0.16471622695695798,0.775233682990896,2.003505306847487,1.7674168040200562,0.18706983534030855,0.22200102622623444,0.6628111359647035,3.1785890533686785},
{1.447889240386337,0.47427490611537715,2.484554557443359,1.6038259965926738,0.23468493924269784,0.18658459398615568,1.0511827039592494,3.2304658067905914,0.46570605516697516,0.5392468156099319,0.726494941381743,1.1152251221912648,0.9778907521480489,1.438791276375261,1.13128436896407,0.4514374273500324,2.9738297235593785,0.23978518797001538,0.7328386136985751,1.998942379725951},
{2.813315255468274,0.9091294059848808,0.543891991019356,0.14413893079864748,0.8709688560600626,0.6289296036507025,0.7974819667543073,3.0564528099579054,0.20107077259763495,0.38721643189965693,1.4038573094809588,1.538200819146754,0.45157747551884186,0.4932639714095748,1.7700101964587718,2.3310468014866,1.0170206231589232,2.1274386907226965,0.06313126301571204,1.5346375922992264}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
