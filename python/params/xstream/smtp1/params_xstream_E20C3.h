#define ENSEMBLE 140
#define DIM_MAX 3
#define BATCH_SIZE 128
#define K_NUM 20
#define HASH_NUM 2
#define MATRIX_COL 128
const static param_t bottom_xstream = -7.908198388578782;
const static param_t delta_xstream = 0.1447555417130586;

static param_t xstream_fs[20][2] = {{2,12},
{18,13},
{7,10},
{15,9},
{6,15},
{3,13},
{2,6},
{10,17},
{2,15},
{10,13},
{12,18},
{8,1},
{9,5},
{14,2},
{17,14},
{1,2},
{11,16},
{4,5},
{17,17},
{6,19}};

static param_t xstream_R_T[3][20] = {{0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.38729833462074165,0.0,-0.38729833462074165,0.0,0.0,0.0},
{0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,-0.38729833462074165,0.0,-0.38729833462074165,-0.38729833462074165,0.38729833462074165,0.0,0.38729833462074165},
{-0.38729833462074165,0.0,0.0,0.0,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.38729833462074165,-0.38729833462074165,0.0,0.0,0.0,0.38729833462074165,0.0,0.0,0.0,-0.38729833462074165}};

static param_t xstream_deltamax[20] = {0.39105317842609216,1.0,0.24811202011695074,0.5663290447231158,1.0,1.0,0.24811202011695074,0.39105317842609216,1.0,1.0,0.39105317842609216,0.28774244127026105,1.0,0.27401342464691647,0.5663290447231158,0.28774244127026105,0.24811202011695074,0.35045884862783616,1.0,0.28774244127026105};

static param_t xstream_shift_deltamax[20][20] = {{-0.34854157488216764,-0.9233213218136703,-0.29335280883177417,-0.6938043847604368,-0.1992305990460812,-0.052676138055447574,-0.9819806050806493,-0.7661483645803573,-0.5807439826779344,-0.46556434903760846,-0.2676510527994659,-0.49520250037016667,-0.49185360618515184,-0.9743386884868466,-0.56474335330312,-0.9300427991517358,-0.7403820158773389,-0.648144842791539,-0.7299848858620749,-0.1935544218269447},
{-0.8547129501471935,-0.05328665909325725,-0.824999914959783,-0.9344771522709632,-0.17995366589986206,-0.9664944288038271,-0.3983404574356484,-0.682099162137269,-0.27831415548890936,-0.17617939427520557,-0.23513316570052353,-0.2589073384248465,-0.6862627624948353,-0.7483831260743297,-0.8817261270168842,-0.9551248886084701,-0.16463461204032526,-0.9799380703885581,-0.5233541115239421,-0.18353350613250785},
{-0.9051780209312967,-0.3441554299959044,-0.3872989950890885,-0.6241979591735327,-0.8844999953974724,-0.13595847650597181,-0.48699396437426856,-0.7943660714876148,-0.3708081752959641,-0.9704217631667404,-0.8907912703098461,-0.4973821039307733,-0.9676480049893126,-0.6299540768818656,-0.3133656066721229,-0.37626159789626734,-0.29459562648659887,-0.011978411443129168,-0.5493331887357417,-0.9861093328918283},
{-0.7356143450355613,-0.29373044594034103,-0.014410280455439128,-0.337810311776269,-0.8110890920884862,-0.8685546682120416,-0.4526830334307189,-0.6015783534939254,-0.7753220490529966,-0.3094925774153128,-0.3274185006286048,-0.4584096446412975,-0.4436769134046664,-0.4552209689813962,-0.09723557235517122,-0.5703622597098204,-0.7553032825335634,-0.13625496954145744,-0.43819447661728905,-0.73105417648824},
{-0.8119011462642867,-0.5690878183398426,-0.41964885402411256,-0.5036405447992849,-0.11027002156880195,-0.3943229402957372,-0.6541124333411312,-0.8961246485038543,-0.30945309110907604,-0.7001374701335218,-0.42454313160931645,-0.48825996092511925,-0.48183453738283244,-0.11509389438172035,-0.03006467470721874,-0.6740821675373968,-0.5573065849234828,-0.8713832414860069,-0.24360421340165583,-0.9039902373611746},
{-0.26029464818130554,-0.3119471464385237,-0.17650152040633738,-0.8904499292896613,-0.1150959577051911,-0.1403777217023534,-0.9168700456546409,-0.8166579476119175,-0.9606924738915981,-0.9653760316742686,-0.052154909243083414,-0.5682225907183108,-0.4118251047446343,-0.41306361306852846,-0.2759243356355774,-0.7705871003206602,-0.4877097129370981,-0.26679469593299054,-0.8068147071001618,-0.817590265657919},
{-0.5019025252153426,-0.780285766573795,-0.8752747987765014,-0.9601318962787874,-0.9592551025129925,-0.10898691844579078,-0.5184538891696675,-0.2954054331504711,-0.2919092523866035,-0.9818077861013345,-0.007772620441287903,-0.600963667614323,-0.45900597157241474,-0.07422941654447479,-0.6769502075077888,-0.8986663095478669,-0.22629635515253788,-0.23168964242822077,-0.7633669242820209,-0.49602210722642404},
{-0.5207376468773521,-0.3671387841353554,-0.5344131759311881,-0.3171471713343593,-0.000559292197107597,-0.13849081315264034,-0.4745472576557894,-0.8087396241961431,-0.3552224412449284,-0.45400330103904774,-0.566053760981611,-0.6172853787408373,-0.5800062300251568,-0.048411114322510884,-0.039527696925654277,-0.26567345590292846,-0.339713756727163,-0.5442567363473607,-0.8845023778301634,-0.7136662861952655},
{-0.8029066477768132,-0.45031720895393923,-0.5148435326530192,-0.6307918657323204,-0.9268347495232613,-0.6465833326300323,-0.5826440500467738,-0.36288721302499505,-0.19681276134122294,-0.5362448511959788,-0.4053680916647532,-0.6562652844235662,-0.726581498798301,-0.4764105834133656,-0.614464025437855,-0.9523477774782372,-0.2822900546636242,-0.5118466265487883,-0.9802555602895595,-0.04308014622794187},
{-0.5360981676170946,-0.5729841254226158,-0.6826291454013473,-0.30341777857641417,-0.726529848248614,-0.44156121641540347,-0.27722705528168945,-0.5197320377578276,-0.1333833970134165,-0.8464972770049095,-0.03617428455912586,-0.1031011711434846,-0.18644470774073663,-0.7201828435766933,-0.37310284279835043,-0.5470368263606158,-0.4830428066768312,-0.1395961600452027,-0.13973521819218981,-0.9577839837987497},
{-0.4648993395301771,-0.9775839542475675,-0.6938594976901946,-0.24710963137491626,-0.522634868081956,-0.030962002563396873,-0.8977133341078212,-0.7328643446660407,-0.3889254247113838,-0.9018831006979763,-0.13596830744841992,-0.2360211975448545,-0.8802391948662766,-0.917546074347679,-0.41506129102956835,-0.5985503938680964,-0.2644954391719543,-0.4091418806906903,-0.8133135702377368,-0.534504076897842},
{-0.5935607784741224,-0.78807220973213,-0.9550538107549882,-0.06154407631499337,-0.5567854174394299,-0.6318706675989776,-0.8553939809639285,-0.41252360369118396,-0.3964420253515819,-0.7959206328215271,-0.8559320021428587,-0.9064960518394823,-0.28729270236668913,-0.7927289789813494,-0.6340500973978902,-0.4812322220318137,-0.4375011837077699,-0.7421757034981317,-0.34695086685363197,-0.8081094223365978},
{-0.677612373688262,-0.4767376186142033,-0.8728241234333386,-0.7779597691262478,-0.6806813535256983,-0.16038077774405213,-0.1405719321403246,-0.6653140536391167,-0.7077578428776568,-0.4739880867930727,-0.8884845192339066,-0.6863145367391202,-0.9794836543658627,-0.5324002695037473,-0.7755056421379645,-0.2837919155177341,-0.9227073689769782,-0.2858979171728293,-0.8546399214518889,-0.9518307069932604},
{-0.5800871064217558,-0.29558664247508004,-0.8865098369224823,-0.5585836978758446,-0.566731696029582,-0.8849154763875275,-0.7466395443749742,-0.9169657935931631,-0.39025142112454436,-0.2666893282255982,-0.5896553033766346,-0.11180017220736815,-0.8267038972260582,-0.14993852156257584,-0.11705219305513126,-0.5257779104208594,-0.32018651089233996,-0.7154404064477644,-0.7904622773203756,-0.6024326823385402},
{-0.07128965437991042,-0.1981532611233705,-0.8128740836948432,-0.32418256381872124,-0.03327753599361649,-0.17918876061119715,-0.8480370767335965,-0.13483972615645012,-0.9110182999757426,-0.05032036238387083,-0.3344356240124683,-0.7581632905103988,-0.7664086269298277,-0.3448812173098833,-0.9114109599331868,-0.5934196989799041,-0.9389852119466537,-0.04560505468591014,-0.2950797792061113,-0.9830228927559209},
{-0.5788855492061858,-0.20893963284312844,-0.3691398196362621,-0.999524881096236,-0.08994503135688281,-0.1704094247523743,-0.9804176926203138,-0.9010749363149247,-0.7271917494110616,-0.46989672635703583,-0.09058239131608237,-0.5445448770071714,-0.2937148642289553,-0.4877985311454285,-0.4885260978637025,-0.8570451046120418,-0.40662525663580684,-0.6246918433963558,-0.46875423157572393,-0.4297120818703851},
{-0.15255291395607107,-0.7214121261648372,-0.596774859929624,-0.9501077409418363,-0.8597634179791291,-0.8958939854299658,-0.35688054119856893,-0.4707947187542232,-0.3209361671092189,-0.6337853019619939,-0.16820168196967844,-0.8363754780254817,-0.45852592262728187,-0.41840418144913016,-0.28561254249179324,-0.8737514223164338,-0.8869505922962829,-0.32929134894217005,-0.27841366965865544,-0.5133446610584061},
{-0.022026196716396385,-0.12384593996566473,-0.7313207037770425,-0.35123398484487445,-0.3355373670631203,-0.7436781443701604,-0.9645852629769737,-0.16268863196424643,-0.22002883199542078,-0.9727184316650239,-0.4966719998551753,-0.9345537055505647,-0.29621992345805737,-0.8536865646883534,-0.9341324956400062,-0.2943721099811015,-0.9987737185037197,-0.12296159647090887,-0.2690013678364993,-0.4912024988112079},
{-0.23318662847140637,-0.4167292268141395,-0.549724349249578,-0.45176014700819045,-0.10412470316092781,-0.7218379849170099,-0.5547714578817791,-0.5890771085975052,-0.09039865696173555,-0.9573085777469592,-0.2374516496265966,-0.3430178561347378,-0.6844977323623367,-0.8394430717276801,-0.8010839827030143,-0.9939058900587082,-0.4580896245128532,-0.2369697184938655,-0.040064815064047465,-0.6853922894598303},
{-0.38945653033725525,-0.4237981862375715,-0.9969861295285124,-0.3789354292108239,-0.5198148712054043,-0.6480885508875541,-0.16308351599580084,-0.7602879766845069,-0.8404655042897947,-0.5464194661419755,-0.10114475271694989,-0.5588352827285629,-0.9641654543917936,-0.009796921369146783,-0.2581971572283921,-0.5696964520105967,-0.42192266418779545,-0.7457286628946378,-0.10955230567353236,-0.21894058032762886}};

static param_t xstream_shift[20][20] = {{0.8912894565516003,0.9233213218136703,1.182340173174595,1.2250905921656288,0.1992305990460812,0.052676138055447574,3.957811494250784,1.9591922706368106,0.5807439826779344,0.46556434903760846,0.6844364591964341,1.7209922115905365,0.49185360618515184,3.5558063979614984,0.9972000528053949,3.2322058402159604,2.9840634707191955,1.8494178284533072,0.7299848858620749,0.6726655302307295},
{2.185669359822712,0.05328665909325725,3.325110627735443,1.6500604392060427,0.17995366589986206,0.9664944288038271,1.6054863333420346,1.7442619054589366,0.27831415548890936,0.17617939427520557,0.6012818170840235,0.8997884958571984,0.6862627624948353,2.7311914627492007,1.5569148982072238,3.319374383535491,0.6635495207476149,2.79615730698581,0.5233541115239421,0.63783953914579},
{2.3147184855380805,0.3441554299959044,1.5609844090041676,1.1021824944166683,0.8844999953974724,0.13595847650597181,1.9627987557584585,2.031350505025361,0.3708081752959641,0.9704217631667404,2.2779287305503972,1.72856705369928,0.9676480049893126,2.298989831223054,0.5533278040248326,1.3076332995411857,1.1873492721059524,0.03417922386616478,0.5493331887357417,3.427055558917805},
{1.881110768607626,0.29373044594034103,0.05807973530926337,0.5964912358352166,0.8110890920884862,0.8685546682120416,1.8245106916518636,1.538354338187848,0.7753220490529966,0.3094925774153128,0.8372735952342755,1.5931248884162272,0.4436769134046664,1.6613090018052108,0.17169448267077791,1.9821971941014764,3.0442027039945168,0.38879021053382246,0.43819447661728905,2.5406546676289574},
{2.076191144979361,0.5690878183398426,1.691368494868994,0.8893072843288834,0.11027002156880195,0.3943229402957372,2.636359306706733,2.2915672290673355,0.30945309110907604,0.7001374701335218,1.0856404065503684,1.6968645944951959,0.48183453738283244,0.42003013002018447,0.05308693768640751,2.3426581235691524,2.2461893811544855,2.486406734764336,0.24360421340165583,3.141664585072818},
{0.6656246836528409,0.3119471464385237,0.7113783537095105,1.5723190212238038,0.1150959577051911,0.1403777217023534,3.695387451291004,2.0883552229361646,0.9606924738915981,0.9653760316742686,0.13337037548958455,1.9747611378072996,0.4118251047446343,1.5074575765796399,0.4872155828957698,2.6780446322719875,1.9656835356352744,0.7612725345003591,0.8068147071001618,2.841396152922746},
{1.2834636128912085,0.780285766573795,3.5277404067885527,1.695360506802553,0.9592551025129925,0.10898691844579078,2.089596017658829,0.7554098763227463,0.2919092523866035,0.9818077861013345,0.01987612138218921,2.088547191583288,0.45900597157241474,0.2708970067438267,1.1953301950790054,3.1231621778860132,0.9120733249677715,0.6611037025755331,0.7633669242820209,1.7238406160616988},
{1.331628728791345,0.3671387841353554,2.153918926133791,0.5600051318035717,0.000559292197107597,0.13849081315264034,1.9126330817511605,2.068106510350209,0.3552224412449284,0.45400330103904774,1.4475109581255927,2.145270527405633,0.5800062300251568,0.17667424282183125,0.06979634418181709,0.9233029883603288,1.3691950779612958,1.552983291699748,0.8845023778301634,2.480226007135864},
{2.053190440769068,0.45031720895393923,2.0750447012214126,1.1138257371926263,0.9268347495232613,0.6465833326300323,2.348310451755369,0.9279740788338321,0.19681276134122294,0.5362448511959788,1.0366060526506282,2.2807385713641435,0.726581498798301,1.7386395722299028,1.0849947237621778,3.3097230053169246,1.137752433479697,1.4605042176930028,0.9802555602895595,0.14971773381000475},
{1.37090860576758,0.5729841254226158,2.7512941335110708,0.5357623477085804,0.726529848248614,0.44156121641540347,1.117346330705844,1.329057188205556,0.1333833970134165,0.8464972770049095,0.09250477059084354,0.3583106151749341,0.18644470774073663,2.628275766067645,0.6588093022507159,1.9011336108280716,1.94687386144832,0.3983239703941517,0.13973521819218981,3.328615617392203},
{1.1888391788587436,0.9775839542475675,2.7965573669632575,0.4363357904338647,0.522634868081956,0.030962002563396873,3.6181775219301047,1.8740784760161457,0.3889254247113838,0.9018831006979763,0.34769774278696347,0.8202515989748361,0.8802391948662766,3.348544238407278,0.7328977648188539,2.080160268418346,1.0660323471925341,1.1674462844713949,0.8133135702377368,1.857578167955456},
{1.517851819701559,0.78807220973213,3.8492847315692784,0.10867194061198629,0.5567854174394299,0.6318706675989776,3.447612012351226,1.054904106268886,0.3964420253515819,0.7959206328215271,2.188786715883009,3.150373117839989,0.28729270236668913,2.8930297119669612,1.1195789855840501,1.6724408811831064,1.7633211946021325,2.1177256799307487,0.34695086685363197,2.808447091673848},
{1.732788303666297,0.4767376186142033,3.5178631128871625,1.3736886292077786,0.6806813535256983,0.16038077774405213,0.5665663923660943,1.7013390769942534,0.7077578428776568,0.4739880867930727,2.2720299137060396,2.385169645844847,0.9794836543658627,1.9429714810133063,1.369355235024397,0.9862706184910119,3.718914418342362,0.8157817053049609,0.8546399214518889,3.307926014637711},
{1.4833969864571512,0.29558664247508004,3.573022526295238,0.9863235924072056,0.566731696029582,0.8849154763875275,3.0092840484835683,2.3448621419822238,0.39025142112454436,0.2666893282255982,1.507864750645615,0.3885425164039678,0.8267038972260582,0.5471940718079088,0.20668583775772845,1.8272518579455033,1.290491733296178,2.0414391282998086,0.7904622773203756,2.093652502839188},
{0.18230168762938195,0.1981532611233705,3.2762382222017483,0.5724279318522635,0.03327753599361649,0.17918876061119715,3.4179604693632477,0.3448117381353401,0.9110182999757426,0.05032036238387083,0.8552177618361325,2.634867790665252,0.7664086269298277,1.2586289075226311,1.6093311272403221,2.062329409454536,3.7845212477172656,0.13012955690652186,0.2950797792061113,3.4163291602597483},
{1.4803243679953708,0.20893963284312844,1.4877949865639857,1.7649189820114457,0.08994503135688281,0.1704094247523743,3.9515122731989423,2.3042260900207086,0.7271917494110616,0.46989672635703583,0.2316370159185451,1.8924732639482595,0.2937148642289553,1.7801993890408383,0.8626188298404296,2.978514746828971,1.638877699049562,1.7824969917073963,0.46875423157572393,1.4933913814499806},
{0.3901078481705861,0.7214121261648372,2.4052637983775496,1.6776602750550325,0.8597634179791291,0.8958939854299658,1.4383847305356217,1.2039148247025486,0.3209361671092189,0.6337853019619939,0.4301248301999623,2.9066809690403614,0.45852592262728187,1.5269477471341788,0.5043226109503746,3.0365747175119218,3.5747989632997528,0.9396006128293123,0.27841366965865544,1.7840422107778289},
{0.05632532333593925,0.12384593996566473,2.9475424182686725,0.6201941929653217,0.3355373670631203,0.7436781443701604,3.8877006544153088,0.416026875472626,0.22002883199542078,0.9727184316650239,1.2700881293285404,3.247882729516389,0.29621992345805737,3.115491752962039,1.6494518590278437,1.0230402879796712,4.025495089004293,0.3508588724534841,0.2690013678364993,1.7070908853165936},
{0.5963041379945667,0.4167292268141395,2.2156296538573925,0.7976990606742776,0.10412470316092781,0.7218379849170099,2.2359717099569805,1.5063861927127615,0.09039865696173555,0.9573085777469592,0.6072106371371029,1.1921003193705424,0.6844977323623367,3.0635107488231834,1.4145203926361796,3.4541511696051317,1.8463016193126267,0.676169882488861,0.040064815064047465,2.3819645320103406},
{0.9959170563572375,0.4237981862375715,4.018290323292561,0.6691082379433486,0.5198148712054043,0.6480885508875541,0.6572979250216469,1.9442061045111771,0.8404655042897947,0.5464194661419755,0.25864705440839664,1.9421371427222958,0.9641654543917936,0.035753435736846584,0.4559136771002578,1.9798832924876428,1.700532944711493,2.127863701585551,0.10955230567353236,0.7608908138858449}};

const static score_t log_LUT_xstream_d0[128] = {1.0,2.0,2.584962500721156,3.0,3.321928094887362,3.584962500721156,3.807354922057604,4.0,4.169925001442312,4.321928094887362,4.459431618637297,4.584962500721156,4.700439718141093,4.807354922057604,4.906890595608519,5.0,5.087462841250339,5.169925001442312,5.247927513443585,5.321928094887363,5.392317422778761,5.459431618637297,5.523561956057013,5.584962500721156,5.643856189774724,5.700439718141092,5.754887502163468,5.807354922057604,5.857980995127572,5.906890595608519,5.954196310386875,6.0,6.044394119358453,6.087462841250339,6.129283016944966,6.169925001442312,6.20945336562895,6.247927513443585,6.285402218862249,6.321928094887363,6.357552004618084,6.392317422778761,6.426264754702098,6.459431618637297,6.491853096329675,6.523561956057013,6.554588851677638,6.584962500721156,6.614709844115208,6.643856189774724,6.672425341971495,6.700439718141092,6.727920454563199,6.754887502163468,6.78135971352466,6.807354922057604,6.832890014164741,6.857980995127572,6.882643049361842,6.906890595608519,6.930737337562887,6.954196310386875,6.977279923499917,7.0,7.022367813028454,7.044394119358453,7.066089190457772,7.087462841250339,7.108524456778169,7.129283016944966,7.149747119504682,7.169925001442312,7.189824558880018,7.20945336562895,7.22881869049588,7.247927513443585,7.266786540694901,7.285402218862249,7.303780748177103,7.321928094887363,7.339850002884624,7.357552004618084,7.3750394313469245,7.392317422778761,7.409390936137702,7.426264754702098,7.442943495848728,7.459431618637297,7.475733430966398,7.491853096329675,7.507794640198696,7.523561956057013,7.539158811108031,7.554588851677638,7.569855608330948,7.584962500721156,7.599912842187128,7.614709844115208,7.6293566200796095,7.643856189774724,7.658211482751795,7.672425341971495,7.6865005271832185,7.700439718141092,7.714245517666122,7.727920454563199,7.7414669864011465,7.754887502163468,7.768184324776926,7.78135971352466,7.794415866350106,7.807354922057604,7.820178962415188,7.832890014164741,7.845490050944375,7.857980995127572,7.870364719583405,7.882643049361842,7.894817763307944,7.906890595608519,7.918863237274595,7.930737337562887,7.94251450533924,7.954196310386875,7.965784284662087,7.977279923499917,7.9886846867721655,8.0};
